function serializeData(data){if(!angular.isObject(data))return null==data?"":data.toString();var buffer=[];for(var name in data)if(data.hasOwnProperty(name)){var value=data[name];buffer.push(encodeURIComponent(name)+"="+encodeURIComponent(null==value?"":value))}return buffer.join("&").replace(/%20/g,"+")}function resizeContainer(){setTimeout(function(){var element=document.getElementById("consult"),container=angular.element(document.querySelector("#top")),containerHeight=container[0].clientHeight,windowHeight=window.innerHeight;if(windowHeight>window.innerWidth){var result=windowHeight-containerHeight;element.style.marginTop=result+40+"px"}else element.style.marginTop="40px"},300)}function halfwayBetweenTwoNumbers(number1,number2){var numbers=[],min=number1,max=number2;number2<number1&&(max=number1,min=number2);for(var i=min;i<=max;i++)numbers.push(i);return numbers}function arrayDiffByFirstKey(a1,a2){var diff=[];for(var key in a2)void 0===a1[a2[key]]&&diff.push(a2[key]);return diff}function getLastSmallerValue(array,value){var lastSmallerValue=0;for(var i in array){var arrayValue=array[i];arrayValue<value&&arrayValue>lastSmallerValue&&(lastSmallerValue=arrayValue)}return lastSmallerValue}function getLastBiggerValue(array,value){var lastBiggerValue=0;for(var i in array){var arrayValue=array[i];arrayValue>value&&(arrayValue<lastBiggerValue||0==lastBiggerValue)&&(lastBiggerValue=arrayValue)}return lastBiggerValue}function getMinValue(array){var minValue;for(var i in array){var arrayValue=array[i];(void 0===minValue||arrayValue<minValue)&&(minValue=arrayValue)}return minValue}function getObjectArrayLength(soruce){var size=0;for(i in soruce)size++;return size}function setBatchParamsAfterLogin(params){if(nativeBatchUser.setIdentifier(params["user-id"]),void 0!==params["user-age"]&&null!=params["user-age"]&&nativeBatchUser.setAttributeInteger("user_age",params["user-age"]),void 0!==params["user-city"]&&null!=params["user-city"]&&nativeBatchUser.setAttributeString("user_city",params["user-city"]),void 0!==params["user-gender"]&&null!=params["user-gender"]&&nativeBatchUser.setAttributeString("user_gender",params["user-gender"]),nativeBatchUser.setAttributeBoolean("vip_enabled",params["vip-enabled"]),nativeBatchUser.setAttributeBoolean("push_notify_campaign",params["push-notify-campaign"]),nativeBatchUser.setAttributeBoolean("push_notify_transaction",params["push-notify-transaction"]),nativeBatchUser.setAttributeBoolean("registered",params.registered),void 0!==params["last-transaction"]&&null!=params["last-transaction"]){var m=moment(params["last-transaction"]),formattedDate=m.format("YYYY-MM-DDTHH:mm:ss"),lastTransaction=new Date(formattedDate),transactionKey="last_transaction";configData.isIOS&&(transactionKey="ios_"+transactionKey),nativeBatchUser.setAttributeDate(transactionKey,lastTransaction.toString())}if(void 0!==params["user-birthday"]&&null!=params["user-birthday"]){var m=moment(params["user-birthday"]),formattedDate=m.format("YYYY-MM-DDTHH:mm:ss"),birthDay=new Date(formattedDate),birthdayKey="user_birthday";configData.isIOS&&(birthdayKey="ios_"+birthdayKey),nativeBatchUser.setAttributeDate(birthdayKey,birthDay.toString())}void 0!==params["last-order-value"]&&null!=params["last-order-value"]&&nativeBatchUser.setAttributeFloat("last_order_value",parseFloat(params["last-order-value"])),void 0!==params["pigu-eurai"]&&null!=params["pigu-eurai"]&&nativeBatchUser.setAttributeFloat("pigu_eurai",parseFloat(params["pigu-eurai"]))}function trackBachEvent(name,label,data){"undefined"!=typeof nativeBatch&&void 0!==nativeBatch.trackEvent&&(void 0!==name&&void 0!==label&&void 0!==data?nativeBatch.trackEvent(name,label,data):void 0!==name&&void 0!==label?nativeBatch.trackEvent(name,label):void 0!==name&&nativeBatch.trackEvent(name))}function onNativeReady(func){document.addEventListener("nativeReady",function(e){func()},!1)}function nativeLogout(){onNativeReady(function(){nativeBatchUser.setIdentifier(null),native.goHome()})}function setNativeBacthUserAttribute(method,key,value){"undefined"!=typeof nativeBatchUser&&void 0!==nativeBatchUser[method]&&nativeBatchUser[method](key,value)}function setNativeBacthUserParam(method,value){"undefined"!=typeof nativeBatchUser&&void 0!==nativeBatchUser[method]&&nativeBatchUser[method](value)}function callNativeFbMethod(method,param){return"undefined"!=typeof nativeFacebook&&void 0!==nativeFacebook[method]&&(void 0!==param?nativeFacebook[method](param):nativeFacebook[method]())}function facebookLogin(accessToken){window.location.href=configData.baseUrl+"users/fb_account/login?fat="+accessToken}function createFbLoginButton(buttonText,appendToId){var fbButton=$('<span class="btn btn-block btn-lg btn-social btn-facebook"></span>');fbButton.html('<i class="fa fa-facebook"></i>'+buttonText),fbButton.click(function(){nativeFacebook.login()}),fbButton.appendTo("#"+appendToId)}function logNativeFacebookEvent(eventName){"undefined"!=typeof nativeFacebook&&nativeFacebook.logEvent(eventName)}function logNativeAdWordsEvent(id,label,value,repeatable){"undefined"!=typeof nativeAdWords&&void 0!==nativeAdWords.reportWithConversionId&&nativeAdWords.reportWithConversionId(id,label,value,repeatable)}function logAdWordsPurchase(id,value){logNativeAdWordsEvent(id,"purchase",value,!0)}function logFbPurchase(value,currency){"undefined"!=typeof nativeFacebook&&void 0!==nativeFacebook.logPurchase&&(void 0===currency&&(currency="EUR"),nativeFacebook.logPurchase(value,currency))}function setWishlistCount(count){var countElement=document.getElementById("wishesCount");"undefined"!=count&&countElement&&(countElement.innerText=parseInt(count))}function setNativeWishlistCount(count){"undefined"!=typeof native&&void 0!==native.setWishlistCount&&native.setWishlistCount(parseInt(count))}function windowHistoryBack(){window.history.back()}function sendDataToExacaster(url,user,pass,content){var httpCl=new XMLHttpRequest;window.XMLHttpRequest&&"withCredentials"in httpCl&&(httpCl.open("POST",url,!0),httpCl.setRequestHeader("Content-type","application/json"),httpCl.setRequestHeader("Authorization","Basic "+window.btoa(user+":"+pass)),httpCl.withCredentials=!0,httpCl.send(content))}function numberFormat(number,decimals,dec_point,thousands_sep){var n=isFinite(+number)?+number:0,prec=isFinite(+decimals)?Math.abs(decimals):0,sep=void 0===thousands_sep?",":thousands_sep,dec=void 0===dec_point?".":dec_point,s="",toFixedFix=function(n,prec){var k=Math.pow(10,prec);return""+Math.round(n*k)/k};return s=(prec?toFixedFix(n,prec):""+Math.round(n)).split("."),s[0].length>3&&(s[0]=s[0].replace(/\B(?=(?:\d{3})+(?!\d))/g,sep)),(s[1]||"").length<prec&&(s[1]=s[1]||"",s[1]+=new Array(prec-s[1].length+1).join("0")),s.join(dec)}function currencyFormat(number,decimals,dec_point,thousands_sep){var number=numberFormat(number,decimals,dec_point,thousands_sep);return"€ "+number}function naturalSort(prop){return function(a,b){return isNaN(parseInt(a[prop].match(/(\d+)$/)))||isNaN(parseInt(b[prop].match(/(\d+)$/)))?a[prop].localeCompare(b[prop]):parseInt(a[prop].match(/(\d+)$/))-parseInt(b[prop].match(/(\d+)$/))}}!function($,window,document,undefined){"use strict";function Plugin(element,options){if(this.el=element,this.$el=$(element),this.s=$.extend({},defaults,options),this.s.dynamic&&"undefined"!==this.s.dynamicEl&&this.s.dynamicEl.constructor===Array&&!this.s.dynamicEl.length)throw"When using dynamic mode, you must also define dynamicEl as an Array.";return this.modules={},this.lGalleryOn=!1,this.lgBusy=!1,this.hideBartimeout=!1,this.isTouch="ontouchstart"in document.documentElement,this.s.slideEndAnimatoin&&(this.s.hideControlOnEnd=!1),this.s.dynamic?this.$items=this.s.dynamicEl:"this"===this.s.selector?this.$items=this.$el:""!==this.s.selector?this.s.selectWithin?this.$items=$(this.s.selectWithin).find(this.s.selector):this.$items=this.$el.find($(this.s.selector)):this.$items=this.$el.children(),this.$slide="",this.$outer="",this.init(),this}var defaults={mode:"lg-slide",cssEasing:"ease",easing:"linear",speed:600,height:"100%",width:"100%",addClass:"",startClass:"lg-start-zoom",backdropDuration:150,hideBarsDelay:6e3,useLeft:!1,closable:!0,loop:!0,escKey:!0,keyPress:!0,controls:!0,slideEndAnimatoin:!0,hideControlOnEnd:!1,mousewheel:!0,getCaptionFromTitleOrAlt:!0,appendSubHtmlTo:".lg-sub-html",subHtmlSelectorRelative:!1,preload:1,showAfterLoad:!0,selector:"",selectWithin:"",nextHtml:"",prevHtml:"",index:!1,iframeMaxWidth:"100%",download:!0,counter:!0,appendCounterTo:".lg-toolbar",swipeThreshold:50,enableSwipe:!0,enableDrag:!0,dynamic:!1,dynamicEl:[],galleryId:1};Plugin.prototype.init=function(){var _this=this;_this.s.preload>_this.$items.length&&(_this.s.preload=_this.$items.length);var _hash=window.location.hash;_hash.indexOf("lg="+this.s.galleryId)>0&&(_this.index=parseInt(_hash.split("&slide=")[1],10),$("body").addClass("lg-from-hash"),$("body").hasClass("lg-on")||setTimeout(function(){_this.build(_this.index),$("body").addClass("lg-on")})),_this.s.dynamic?(_this.$el.trigger("onBeforeOpen.lg"),_this.index=_this.s.index||0,$("body").hasClass("lg-on")||setTimeout(function(){_this.build(_this.index),$("body").addClass("lg-on")})):_this.$items.on("click.lgcustom",function(event){try{event.preventDefault(),event.preventDefault()}catch(er){event.returnValue=!1}_this.$el.trigger("onBeforeOpen.lg"),_this.index=_this.s.index||_this.$items.index(this),$("body").hasClass("lg-on")||(_this.build(_this.index),$("body").addClass("lg-on"))})},Plugin.prototype.build=function(index){var _this=this;_this.structure(),$.each($.fn.lightGallery.modules,function(key){_this.modules[key]=new $.fn.lightGallery.modules[key](_this.el)}),_this.slide(index,!1,!1),_this.s.keyPress&&_this.keyPress(),_this.$items.length>1&&(_this.arrow(),setTimeout(function(){_this.enableDrag(),_this.enableSwipe()},50),_this.s.mousewheel&&_this.mousewheel()),_this.counter(),_this.closeGallery(),_this.$el.trigger("onAfterOpen.lg"),_this.$outer.on("mousemove.lg click.lg touchstart.lg",function(){_this.$outer.removeClass("lg-hide-items"),clearTimeout(_this.hideBartimeout),_this.hideBartimeout=setTimeout(function(){_this.$outer.addClass("lg-hide-items")},_this.s.hideBarsDelay)})},Plugin.prototype.structure=function(){var template,list="",controls="",i=0,subHtmlCont="",_this=this;for($("body").append('<div class="lg-backdrop"></div>'),$(".lg-backdrop").css("transition-duration",this.s.backdropDuration+"ms"),i=0;i<this.$items.length;i++)list+='<div class="lg-item"></div>';if(this.s.controls&&this.$items.length>1&&(controls='<div class="lg-actions"><div class="lg-prev lg-icon">'+this.s.prevHtml+'</div><div class="lg-next lg-icon">'+this.s.nextHtml+"</div></div>"),".lg-sub-html"===this.s.appendSubHtmlTo&&(subHtmlCont='<div class="lg-sub-html"></div>'),template='<div class="lg-outer '+this.s.addClass+" "+this.s.startClass+'"><div class="lg" style="width:'+this.s.width+"; height:"+this.s.height+'"><div class="lg-inner">'+list+'</div><div class="lg-toolbar group"><span class="lg-close lg-icon"></span></div>'+controls+subHtmlCont+"</div></div>",$("body").append(template),this.$outer=$(".lg-outer"),this.$slide=this.$outer.find(".lg-item"),this.s.useLeft?(this.$outer.addClass("lg-use-left"),this.s.mode="lg-slide"):this.$outer.addClass("lg-use-css3"),_this.setTop(),$(window).on("resize.lg orientationchange.lg",function(){setTimeout(function(){_this.setTop()},100)}),this.$slide.eq(this.index).addClass("lg-current"),this.doCss()?this.$outer.addClass("lg-css3"):(this.$outer.addClass("lg-css"),this.s.speed=0),this.$outer.addClass(this.s.mode),this.s.enableDrag&&this.$items.length>1&&this.$outer.addClass("lg-grab"),this.s.showAfterLoad&&this.$outer.addClass("lg-show-after-load"),this.doCss()){var $inner=this.$outer.find(".lg-inner");$inner.css("transition-timing-function",this.s.cssEasing),$inner.css("transition-duration",this.s.speed+"ms")}$(".lg-backdrop").addClass("in"),setTimeout(function(){_this.$outer.addClass("lg-visible")},this.s.backdropDuration),this.s.download&&this.$outer.find(".lg-toolbar").append('<a id="lg-download" target="_blank" download class="lg-download lg-icon"></a>'),this.prevScrollTop=$(window).scrollTop()},Plugin.prototype.setTop=function(){if("100%"!==this.s.height){var wH=$(window).height(),top=(wH-parseInt(this.s.height,10))/2,$lGallery=this.$outer.find(".lg");wH>=parseInt(this.s.height,10)?$lGallery.css("top",top+"px"):$lGallery.css("top","0px")}},Plugin.prototype.doCss=function(){return!!function(){var transition=["transition","MozTransition","WebkitTransition","OTransition","msTransition","KhtmlTransition"],root=document.documentElement,i=0;for(i=0;i<transition.length;i++)if(transition[i]in root.style)return!0}()},Plugin.prototype.isVideo=function(src,index){var html;if(html=this.s.dynamic?this.s.dynamicEl[index].html:this.$items.eq(index).attr("data-html"),!src&&html)return{html5:!0};var youtube=src.match(/\/\/(?:www\.)?youtu(?:\.be|be\.com)\/(?:watch\?v=|embed\/)?([a-z0-9\-\_\%]+)/i),vimeo=src.match(/\/\/(?:www\.)?vimeo.com\/([0-9a-z\-_]+)/i),dailymotion=src.match(/\/\/(?:www\.)?dai.ly\/([0-9a-z\-_]+)/i),vk=src.match(/\/\/(?:www\.)?(?:vk\.com|vkontakte\.ru)\/(?:video_ext\.php\?)(.*)/i);return youtube?{youtube:youtube}:vimeo?{vimeo:vimeo}:dailymotion?{dailymotion:dailymotion}:vk?{vk:vk}:void 0},Plugin.prototype.counter=function(){this.s.counter&&$(this.s.appendCounterTo).append('<div id="lg-counter"><span id="lg-counter-current">'+(parseInt(this.index,10)+1)+'</span> / <span id="lg-counter-all">'+this.$items.length+"</span></div>")},Plugin.prototype.addHtml=function(index){var subHtmlUrl,$currentEle,subHtml=null;if(this.s.dynamic?this.s.dynamicEl[index].subHtmlUrl?subHtmlUrl=this.s.dynamicEl[index].subHtmlUrl:subHtml=this.s.dynamicEl[index].subHtml:($currentEle=this.$items.eq(index),$currentEle.attr("data-sub-html-url")?subHtmlUrl=$currentEle.attr("data-sub-html-url"):(subHtml=$currentEle.attr("data-sub-html"),this.s.getCaptionFromTitleOrAlt&&!subHtml&&(subHtml=$currentEle.attr("title")||$currentEle.find("img").first().attr("alt")))),!subHtmlUrl)if(void 0!==subHtml&&null!==subHtml){var fL=subHtml.substring(0,1);"."!==fL&&"#"!==fL||(subHtml=this.s.subHtmlSelectorRelative&&!this.s.dynamic?$currentEle.find(subHtml).html():$(subHtml).html())}else subHtml="";".lg-sub-html"===this.s.appendSubHtmlTo?subHtmlUrl?this.$outer.find(this.s.appendSubHtmlTo).load(subHtmlUrl):this.$outer.find(this.s.appendSubHtmlTo).html(subHtml):subHtmlUrl?this.$slide.eq(index).load(subHtmlUrl):this.$slide.eq(index).append(subHtml),void 0!==subHtml&&null!==subHtml&&(""===subHtml?this.$outer.find(this.s.appendSubHtmlTo).addClass("lg-empty-html"):this.$outer.find(this.s.appendSubHtmlTo).removeClass("lg-empty-html")),this.$el.trigger("onAfterAppendSubHtml.lg",[index])},Plugin.prototype.preload=function(index){var i=1,j=1;for(i=1;i<=this.s.preload&&!(i>=this.$items.length-index);i++)this.loadContent(index+i,!1,0);for(j=1;j<=this.s.preload&&!(index-j<0);j++)this.loadContent(index-j,!1,0)},Plugin.prototype.loadContent=function(index,rec,delay){var _$img,_src,_poster,_srcset,_sizes,_html,_this=this,_hasPoster=!1,getResponsiveSrc=function(srcItms){for(var rsWidth=[],rsSrc=[],i=0;i<srcItms.length;i++){var __src=srcItms[i].split(" ");""===__src[0]&&__src.splice(0,1),rsSrc.push(__src[0]),rsWidth.push(__src[1])}for(var wWidth=$(window).width(),j=0;j<rsWidth.length;j++)if(parseInt(rsWidth[j],10)>wWidth){_src=rsSrc[j];break}};if(_this.s.dynamic){if(_this.s.dynamicEl[index].poster&&(_hasPoster=!0,_poster=_this.s.dynamicEl[index].poster),_html=_this.s.dynamicEl[index].html,_src=_this.s.dynamicEl[index].src,_this.s.dynamicEl[index].responsive){getResponsiveSrc(_this.s.dynamicEl[index].responsive.split(","))}_srcset=_this.s.dynamicEl[index].srcset,_sizes=_this.s.dynamicEl[index].sizes}else{if(_this.$items.eq(index).attr("data-poster")&&(_hasPoster=!0,_poster=_this.$items.eq(index).attr("data-poster")),_html=_this.$items.eq(index).attr("data-html"),_src=_this.$items.eq(index).attr("href")||_this.$items.eq(index).attr("data-src"),_this.$items.eq(index).attr("data-responsive")){getResponsiveSrc(_this.$items.eq(index).attr("data-responsive").split(","))}_srcset=_this.$items.eq(index).attr("data-srcset"),_sizes=_this.$items.eq(index).attr("data-sizes")}var iframe=!1;_this.s.dynamic?_this.s.dynamicEl[index].iframe&&(iframe=!0):"true"===_this.$items.eq(index).attr("data-iframe")&&(iframe=!0);var _isVideo=_this.isVideo(_src,index);if(!_this.$slide.eq(index).hasClass("lg-loaded")){if(iframe)_this.$slide.eq(index).prepend('<div class="lg-video-cont" style="max-width:'+_this.s.iframeMaxWidth+'"><div class="lg-video"><iframe class="lg-object" frameborder="0" src="'+_src+'"  allowfullscreen="true"></iframe></div></div>');else if(_hasPoster){var videoClass="";videoClass=_isVideo&&_isVideo.youtube?"lg-has-youtube":_isVideo&&_isVideo.vimeo?"lg-has-vimeo":"lg-has-html5",_this.$slide.eq(index).prepend('<div class="lg-video-cont '+videoClass+' "><div class="lg-video"><span class="lg-video-play"></span><img class="lg-object lg-has-poster" src="'+_poster+'" /></div></div>')}else _isVideo?(_this.$slide.eq(index).prepend('<div class="lg-video-cont "><div class="lg-video"></div></div>'),_this.$el.trigger("hasVideo.lg",[index,_src,_html])):_this.$slide.eq(index).prepend('<div class="lg-img-wrap"><img class="lg-object lg-image" src="'+_src+'" /></div>');if(_this.$el.trigger("onAferAppendSlide.lg",[index]),_$img=_this.$slide.eq(index).find(".lg-object"),_sizes&&_$img.attr("sizes",_sizes),_srcset){_$img.attr("srcset",_srcset);try{picturefill({elements:[_$img[0]]})}catch(e){console.error("Make sure you have included Picturefill version 2")}}".lg-sub-html"!==this.s.appendSubHtmlTo&&_this.addHtml(index),_this.$slide.eq(index).addClass("lg-loaded")}_this.$slide.eq(index).find(".lg-object").on("load.lg error.lg",function(){var _speed=0;delay&&!$("body").hasClass("lg-from-hash")&&(_speed=delay),setTimeout(function(){_this.$slide.eq(index).addClass("lg-complete"),_this.$el.trigger("onSlideItemLoad.lg",[index,delay||0])},_speed)}),_isVideo&&_isVideo.html5&&!_hasPoster&&_this.$slide.eq(index).addClass("lg-complete"),!0===rec&&(_this.$slide.eq(index).hasClass("lg-complete")?_this.preload(index):_this.$slide.eq(index).find(".lg-object").on("load.lg error.lg",function(){_this.preload(index)}))},Plugin.prototype.slide=function(index,fromTouch,fromThumb){var _prevIndex=this.$outer.find(".lg-current").index(),_this=this;if(!_this.lGalleryOn||_prevIndex!==index){var _length=this.$slide.length,_time=_this.lGalleryOn?this.s.speed:0,_next=!1,_prev=!1;if(!_this.lgBusy){if(this.s.download){var _src;_src=_this.s.dynamic?!1!==_this.s.dynamicEl[index].downloadUrl&&(_this.s.dynamicEl[index].downloadUrl||_this.s.dynamicEl[index].src):"false"!==_this.$items.eq(index).attr("data-download-url")&&(_this.$items.eq(index).attr("data-download-url")||_this.$items.eq(index).attr("href")||_this.$items.eq(index).attr("data-src")),_src?($("#lg-download").attr("href",_src),_this.$outer.removeClass("lg-hide-download")):_this.$outer.addClass("lg-hide-download")}if(this.$el.trigger("onBeforeSlide.lg",[_prevIndex,index,fromTouch,fromThumb]),_this.lgBusy=!0,clearTimeout(_this.hideBartimeout),".lg-sub-html"===this.s.appendSubHtmlTo&&setTimeout(function(){_this.addHtml(index)},_time),this.arrowDisable(index),fromTouch){var touchPrev=index-1,touchNext=index+1;0===index&&_prevIndex===_length-1?(touchNext=0,touchPrev=_length-1):index===_length-1&&0===_prevIndex&&(touchNext=0,touchPrev=_length-1),this.$slide.removeClass("lg-prev-slide lg-current lg-next-slide"),_this.$slide.eq(touchPrev).addClass("lg-prev-slide"),_this.$slide.eq(touchNext).addClass("lg-next-slide"),_this.$slide.eq(index).addClass("lg-current")}else _this.$outer.addClass("lg-no-trans"),this.$slide.removeClass("lg-prev-slide lg-next-slide"),index<_prevIndex?(_prev=!0,0!==index||_prevIndex!==_length-1||fromThumb||(_prev=!1,_next=!0)):index>_prevIndex&&(_next=!0,index!==_length-1||0!==_prevIndex||fromThumb||(_prev=!0,_next=!1)),_prev?(this.$slide.eq(index).addClass("lg-prev-slide"),this.$slide.eq(_prevIndex).addClass("lg-next-slide")):_next&&(this.$slide.eq(index).addClass("lg-next-slide"),this.$slide.eq(_prevIndex).addClass("lg-prev-slide")),setTimeout(function(){_this.$slide.removeClass("lg-current"),_this.$slide.eq(index).addClass("lg-current"),_this.$outer.removeClass("lg-no-trans")},50);_this.lGalleryOn?(setTimeout(function(){_this.loadContent(index,!0,0)},this.s.speed+50),setTimeout(function(){_this.lgBusy=!1,_this.$el.trigger("onAfterSlide.lg",[_prevIndex,index,fromTouch,fromThumb])},this.s.speed)):(_this.loadContent(index,!0,_this.s.backdropDuration),_this.lgBusy=!1,_this.$el.trigger("onAfterSlide.lg",[_prevIndex,index,fromTouch,fromThumb])),_this.lGalleryOn=!0,this.s.counter&&$("#lg-counter-current").text(index+1)}}},Plugin.prototype.goToNextSlide=function(fromTouch){var _this=this;_this.lgBusy||(_this.index+1<_this.$slide.length?(_this.index++,_this.$el.trigger("onBeforeNextSlide.lg",[_this.index]),_this.slide(_this.index,fromTouch,!1)):_this.s.loop?(_this.index=0,_this.$el.trigger("onBeforeNextSlide.lg",[_this.index]),_this.slide(_this.index,fromTouch,!1)):_this.s.slideEndAnimatoin&&(_this.$outer.addClass("lg-right-end"),setTimeout(function(){_this.$outer.removeClass("lg-right-end")},400)))},Plugin.prototype.goToPrevSlide=function(fromTouch){var _this=this;_this.lgBusy||(_this.index>0?(_this.index--,_this.$el.trigger("onBeforePrevSlide.lg",[_this.index,fromTouch]),_this.slide(_this.index,fromTouch,!1)):_this.s.loop?(_this.index=_this.$items.length-1,_this.$el.trigger("onBeforePrevSlide.lg",[_this.index,fromTouch]),_this.slide(_this.index,fromTouch,!1)):_this.s.slideEndAnimatoin&&(_this.$outer.addClass("lg-left-end"),setTimeout(function(){_this.$outer.removeClass("lg-left-end")},400)))},Plugin.prototype.keyPress=function(){var _this=this;this.$items.length>1&&$(window).on("keyup.lg",function(e){_this.$items.length>1&&(37===e.keyCode&&(e.preventDefault(),_this.goToPrevSlide()),39===e.keyCode&&(e.preventDefault(),_this.goToNextSlide()))}),$(window).on("keydown.lg",function(e){!0===_this.s.escKey&&27===e.keyCode&&(e.preventDefault(),_this.$outer.hasClass("lg-thumb-open")?_this.$outer.removeClass("lg-thumb-open"):_this.destroy())})},Plugin.prototype.arrow=function(){var _this=this;this.$outer.find(".lg-prev").on("click.lg",function(){_this.goToPrevSlide()}),this.$outer.find(".lg-next").on("click.lg",function(){_this.goToNextSlide()})},Plugin.prototype.arrowDisable=function(index){!this.s.loop&&this.s.hideControlOnEnd&&(index+1<this.$slide.length?this.$outer.find(".lg-next").removeAttr("disabled").removeClass("disabled"):this.$outer.find(".lg-next").attr("disabled","disabled").addClass("disabled"),index>0?this.$outer.find(".lg-prev").removeAttr("disabled").removeClass("disabled"):this.$outer.find(".lg-prev").attr("disabled","disabled").addClass("disabled"))},Plugin.prototype.setTranslate=function($el,xValue,yValue){this.s.useLeft?$el.css("left",xValue):$el.css({transform:"translate3d("+xValue+"px, "+yValue+"px, 0px)"})},Plugin.prototype.touchMove=function(startCoords,endCoords){var distance=endCoords-startCoords;Math.abs(distance)>15&&(this.$outer.addClass("lg-dragging"),this.setTranslate(this.$slide.eq(this.index),distance,0),this.setTranslate($(".lg-prev-slide"),-this.$slide.eq(this.index).width()+distance,0),this.setTranslate($(".lg-next-slide"),this.$slide.eq(this.index).width()+distance,0))},Plugin.prototype.touchEnd=function(distance){var _this=this;"lg-slide"!==_this.s.mode&&_this.$outer.addClass("lg-slide"),this.$slide.not(".lg-current, .lg-prev-slide, .lg-next-slide").css("opacity","0"),setTimeout(function(){_this.$outer.removeClass("lg-dragging"),distance<0&&Math.abs(distance)>_this.s.swipeThreshold?_this.goToNextSlide(!0):distance>0&&Math.abs(distance)>_this.s.swipeThreshold?_this.goToPrevSlide(!0):Math.abs(distance)<5&&_this.$el.trigger("onSlideClick.lg"),_this.$slide.removeAttr("style")}),setTimeout(function(){_this.$outer.hasClass("lg-dragging")||"lg-slide"===_this.s.mode||_this.$outer.removeClass("lg-slide")},_this.s.speed+100)},Plugin.prototype.enableSwipe=function(){var _this=this,startCoords=0,endCoords=0,isMoved=!1;_this.s.enableSwipe&&_this.isTouch&&_this.doCss()&&(_this.$slide.on("touchstart.lg",function(e){_this.$outer.hasClass("lg-zoomed")||_this.lgBusy||(e.preventDefault(),_this.manageSwipeClass(),startCoords=e.originalEvent.targetTouches[0].pageX)}),_this.$slide.on("touchmove.lg",function(e){_this.$outer.hasClass("lg-zoomed")||(e.preventDefault(),endCoords=e.originalEvent.targetTouches[0].pageX,_this.touchMove(startCoords,endCoords),isMoved=!0)}),_this.$slide.on("touchend.lg",function(){_this.$outer.hasClass("lg-zoomed")||(isMoved?(isMoved=!1,_this.touchEnd(endCoords-startCoords)):_this.$el.trigger("onSlideClick.lg"))}))},Plugin.prototype.enableDrag=function(){var _this=this,startCoords=0,endCoords=0,isDraging=!1,isMoved=!1;_this.s.enableDrag&&!_this.isTouch&&_this.doCss()&&(_this.$slide.on("mousedown.lg",function(e){_this.$outer.hasClass("lg-zoomed")||($(e.target).hasClass("lg-object")||$(e.target).hasClass("lg-video-play"))&&(e.preventDefault(),_this.lgBusy||(_this.manageSwipeClass(),startCoords=e.pageX,isDraging=!0,_this.$outer.scrollLeft+=1,_this.$outer.scrollLeft-=1,_this.$outer.removeClass("lg-grab").addClass("lg-grabbing"),_this.$el.trigger("onDragstart.lg")))}),$(window).on("mousemove.lg",function(e){isDraging&&(isMoved=!0,endCoords=e.pageX,_this.touchMove(startCoords,endCoords),_this.$el.trigger("onDragmove.lg"))}),$(window).on("mouseup.lg",function(e){isMoved?(isMoved=!1,_this.touchEnd(endCoords-startCoords),_this.$el.trigger("onDragend.lg")):($(e.target).hasClass("lg-object")||$(e.target).hasClass("lg-video-play"))&&_this.$el.trigger("onSlideClick.lg"),isDraging&&(isDraging=!1,_this.$outer.removeClass("lg-grabbing").addClass("lg-grab"))}))},Plugin.prototype.manageSwipeClass=function(){var touchNext=this.index+1,touchPrev=this.index-1,length=this.$slide.length;this.s.loop&&(0===this.index?touchPrev=length-1:this.index===length-1&&(touchNext=0)),this.$slide.removeClass("lg-next-slide lg-prev-slide"),touchPrev>-1&&this.$slide.eq(touchPrev).addClass("lg-prev-slide"),this.$slide.eq(touchNext).addClass("lg-next-slide")},Plugin.prototype.mousewheel=function(){var _this=this;_this.$outer.on("mousewheel.lg",function(e){e.deltaY&&(e.deltaY>0?_this.goToPrevSlide():_this.goToNextSlide(),e.preventDefault())})},Plugin.prototype.closeGallery=function(){var _this=this,mousedown=!1;this.$outer.find(".lg-close").on("click.lg",function(){_this.destroy()}),_this.s.closable&&(_this.$outer.on("mousedown.lg",function(e){mousedown=!!($(e.target).is(".lg-outer")||$(e.target).is(".lg-item ")||$(e.target).is(".lg-img-wrap"))}),_this.$outer.on("mouseup.lg",function(e){($(e.target).is(".lg-outer")||$(e.target).is(".lg-item ")||$(e.target).is(".lg-img-wrap")&&mousedown)&&(_this.$outer.hasClass("lg-dragging")||_this.destroy())}))},Plugin.prototype.destroy=function(d){var _this=this;d||_this.$el.trigger("onBeforeClose.lg"),$(window).scrollTop(_this.prevScrollTop),d&&(_this.s.dynamic||this.$items.off("click.lg click.lgcustom"),$.removeData(_this.el,"lightGallery")),this.$el.off(".lg.tm"),$.each($.fn.lightGallery.modules,function(key){_this.modules[key]&&_this.modules[key].destroy()}),this.lGalleryOn=!1,clearTimeout(_this.hideBartimeout),this.hideBartimeout=!1,$(window).off(".lg"),$("body").removeClass("lg-on lg-from-hash"),_this.$outer&&_this.$outer.removeClass("lg-visible"),$(".lg-backdrop").removeClass("in"),setTimeout(function(){_this.$outer&&_this.$outer.remove(),$(".lg-backdrop").remove(),d||_this.$el.trigger("onCloseAfter.lg")},_this.s.backdropDuration+50)},$.fn.lightGallery=function(options){return this.each(function(){if($.data(this,"lightGallery"))try{$(this).data("lightGallery").init()}catch(err){console.error("lightGallery has not initiated properly")}else $.data(this,"lightGallery",new Plugin(this,options))})},$.fn.lightGallery.modules={}}(jQuery,window,document),function($,window,document,undefined){"use strict";var defaults={scale:1,zoom:!0,actualSize:!0,enableZoomAfter:300},Zoom=function(element){return this.core=$(element).data("lightGallery"),this.core.s=$.extend({},defaults,this.core.s),this.core.s.zoom&&this.core.doCss()&&(this.init(),this.zoomabletimeout=!1,this.pageX=$(window).width()/2,this.pageY=$(window).height()/2+$(window).scrollTop()),this};Zoom.prototype.init=function(){var _this=this,zoomIcons='<span id="lg-zoom-in" class="lg-icon"></span><span id="lg-zoom-out" class="lg-icon"></span>';_this.core.s.actualSize&&(zoomIcons+='<span id="lg-actual-size" class="lg-icon"></span>'),this.core.$outer.find(".lg-toolbar").append(zoomIcons),_this.core.$el.on("onSlideItemLoad.lg.tm.zoom",function(event,index,delay){var _speed=_this.core.s.enableZoomAfter+delay;$("body").hasClass("lg-from-hash")&&delay?_speed=0:$("body").removeClass("lg-from-hash"),_this.zoomabletimeout=setTimeout(function(){_this.core.$slide.eq(index).addClass("lg-zoomable")},_speed+30)});var scale=1,zoom=function(scaleVal){var _x,_y,$image=_this.core.$outer.find(".lg-current .lg-image"),offsetX=($(window).width()-$image.width())/2,offsetY=($(window).height()-$image.height())/2+$(window).scrollTop();_x=_this.pageX-offsetX,_y=_this.pageY-offsetY;var x=(scaleVal-1)*_x,y=(scaleVal-1)*_y;$image.css("transform","scale3d("+scaleVal+", "+scaleVal+", 1)").attr("data-scale",scaleVal),$image.parent().css({left:-x+"px",top:-y+"px"}).attr("data-x",x).attr("data-y",y)},callScale=function(){scale>1?_this.core.$outer.addClass("lg-zoomed"):_this.resetZoom(),scale<1&&(scale=1),zoom(scale)},actualSize=function(event,$image,index,fromIcon){var nw,w=$image.width();nw=_this.core.s.dynamic?_this.core.s.dynamicEl[index].width||$image[0].naturalWidth||w:_this.core.$items.eq(index).attr("data-width")||$image[0].naturalWidth||w;var _scale;_this.core.$outer.hasClass("lg-zoomed")?scale=1:nw>w&&(_scale=nw/w,scale=_scale||2),fromIcon?(_this.pageX=$(window).width()/2,_this.pageY=$(window).height()/2+$(window).scrollTop()):(_this.pageX=event.pageX||event.originalEvent.targetTouches[0].pageX,_this.pageY=event.pageY||event.originalEvent.targetTouches[0].pageY),callScale(),setTimeout(function(){_this.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")},10)},tapped=!1;_this.core.$el.on("onAferAppendSlide.lg.tm.zoom",function(event,index){var $image=_this.core.$slide.eq(index).find(".lg-image");$image.on("dblclick",function(event){actualSize(event,$image,index)}),$image.on("touchstart",function(event){tapped?(clearTimeout(tapped),tapped=null,actualSize(event,$image,index)):tapped=setTimeout(function(){tapped=null},300),event.preventDefault()})}),$(window).on("resize.lg.zoom scroll.lg.zoom orientationchange.lg.zoom",function(){_this.pageX=$(window).width()/2,_this.pageY=$(window).height()/2+$(window).scrollTop(),zoom(scale)}),$("#lg-zoom-out").on("click.lg",function(){_this.core.$outer.find(".lg-current .lg-image").length&&(scale-=_this.core.s.scale,callScale())}),$("#lg-zoom-in").on("click.lg",function(){_this.core.$outer.find(".lg-current .lg-image").length&&(scale+=_this.core.s.scale,callScale())}),$("#lg-actual-size").on("click.lg",function(event){actualSize(event,_this.core.$slide.eq(_this.core.index).find(".lg-image"),_this.core.index,!0)}),_this.core.$el.on("onBeforeSlide.lg.tm",function(){scale=1,_this.resetZoom()}),_this.core.isTouch||_this.zoomDrag(),_this.core.isTouch&&_this.zoomSwipe()},Zoom.prototype.resetZoom=function(){this.core.$outer.removeClass("lg-zoomed"),this.core.$slide.find(".lg-img-wrap").removeAttr("style data-x data-y"),this.core.$slide.find(".lg-image").removeAttr("style data-scale"),this.pageX=$(window).width()/2,this.pageY=$(window).height()/2+$(window).scrollTop()},Zoom.prototype.zoomSwipe=function(){var _this=this,startCoords={},endCoords={},isMoved=!1,allowX=!1,allowY=!1;_this.core.$slide.on("touchstart.lg",function(e){if(_this.core.$outer.hasClass("lg-zoomed")){var $image=_this.core.$slide.eq(_this.core.index).find(".lg-object");allowY=$image.outerHeight()*$image.attr("data-scale")>_this.core.$outer.find(".lg").height(),allowX=$image.outerWidth()*$image.attr("data-scale")>_this.core.$outer.find(".lg").width(),(allowX||allowY)&&(e.preventDefault(),startCoords={x:e.originalEvent.targetTouches[0].pageX,y:e.originalEvent.targetTouches[0].pageY})}}),_this.core.$slide.on("touchmove.lg",function(e){if(_this.core.$outer.hasClass("lg-zoomed")){var distanceX,distanceY,_$el=_this.core.$slide.eq(_this.core.index).find(".lg-img-wrap");e.preventDefault(),isMoved=!0,endCoords={x:e.originalEvent.targetTouches[0].pageX,y:e.originalEvent.targetTouches[0].pageY},_this.core.$outer.addClass("lg-zoom-dragging"),distanceY=allowY?-Math.abs(_$el.attr("data-y"))+(endCoords.y-startCoords.y):-Math.abs(_$el.attr("data-y")),distanceX=allowX?-Math.abs(_$el.attr("data-x"))+(endCoords.x-startCoords.x):-Math.abs(_$el.attr("data-x")),(Math.abs(endCoords.x-startCoords.x)>15||Math.abs(endCoords.y-startCoords.y)>15)&&_$el.css({left:distanceX+"px",top:distanceY+"px"})}}),_this.core.$slide.on("touchend.lg",function(){_this.core.$outer.hasClass("lg-zoomed")&&isMoved&&(isMoved=!1,_this.core.$outer.removeClass("lg-zoom-dragging"),_this.touchendZoom(startCoords,endCoords,allowX,allowY))})},Zoom.prototype.zoomDrag=function(){var _this=this,startCoords={},endCoords={},isDraging=!1,isMoved=!1,allowX=!1,allowY=!1;_this.core.$slide.on("mousedown.lg.zoom",function(e){var $image=_this.core.$slide.eq(_this.core.index).find(".lg-object");allowY=$image.outerHeight()*$image.attr("data-scale")>_this.core.$outer.find(".lg").height(),allowX=$image.outerWidth()*$image.attr("data-scale")>_this.core.$outer.find(".lg").width(),_this.core.$outer.hasClass("lg-zoomed")&&$(e.target).hasClass("lg-object")&&(allowX||allowY)&&(e.preventDefault(),startCoords={x:e.pageX,y:e.pageY},isDraging=!0,_this.core.$outer.scrollLeft+=1,_this.core.$outer.scrollLeft-=1,_this.core.$outer.removeClass("lg-grab").addClass("lg-grabbing"))}),$(window).on("mousemove.lg.zoom",function(e){if(isDraging){var distanceX,distanceY,_$el=_this.core.$slide.eq(_this.core.index).find(".lg-img-wrap");isMoved=!0,endCoords={x:e.pageX,y:e.pageY},_this.core.$outer.addClass("lg-zoom-dragging"),distanceY=allowY?-Math.abs(_$el.attr("data-y"))+(endCoords.y-startCoords.y):-Math.abs(_$el.attr("data-y")),distanceX=allowX?-Math.abs(_$el.attr("data-x"))+(endCoords.x-startCoords.x):-Math.abs(_$el.attr("data-x")),_$el.css({left:distanceX+"px",top:distanceY+"px"})}}),$(window).on("mouseup.lg.zoom",function(e){isDraging&&(isDraging=!1,_this.core.$outer.removeClass("lg-zoom-dragging"),!isMoved||startCoords.x===endCoords.x&&startCoords.y===endCoords.y||(endCoords={x:e.pageX,y:e.pageY},_this.touchendZoom(startCoords,endCoords,allowX,allowY)),isMoved=!1),_this.core.$outer.removeClass("lg-grabbing").addClass("lg-grab")})},Zoom.prototype.touchendZoom=function(startCoords,endCoords,allowX,allowY){var _this=this,_$el=_this.core.$slide.eq(_this.core.index).find(".lg-img-wrap"),$image=_this.core.$slide.eq(_this.core.index).find(".lg-object"),distanceX=-Math.abs(_$el.attr("data-x"))+(endCoords.x-startCoords.x),distanceY=-Math.abs(_$el.attr("data-y"))+(endCoords.y-startCoords.y),minY=(_this.core.$outer.find(".lg").height()-$image.outerHeight())/2,maxY=Math.abs($image.outerHeight()*Math.abs($image.attr("data-scale"))-_this.core.$outer.find(".lg").height()+minY),minX=(_this.core.$outer.find(".lg").width()-$image.outerWidth())/2,maxX=Math.abs($image.outerWidth()*Math.abs($image.attr("data-scale"))-_this.core.$outer.find(".lg").width()+minX);(Math.abs(endCoords.x-startCoords.x)>15||Math.abs(endCoords.y-startCoords.y)>15)&&(allowY&&(distanceY<=-maxY?distanceY=-maxY:distanceY>=-minY&&(distanceY=-minY)),allowX&&(distanceX<=-maxX?distanceX=-maxX:distanceX>=-minX&&(distanceX=-minX)),allowY?_$el.attr("data-y",Math.abs(distanceY)):distanceY=-Math.abs(_$el.attr("data-y")),allowX?_$el.attr("data-x",Math.abs(distanceX)):distanceX=-Math.abs(_$el.attr("data-x")),_$el.css({left:distanceX+"px",top:distanceY+"px"}))},Zoom.prototype.destroy=function(){var _this=this;_this.core.$el.off(".lg.zoom"),$(window).off(".lg.zoom"),_this.core.$slide.off(".lg.zoom"),_this.core.$el.off(".lg.tm.zoom"),_this.resetZoom(),clearTimeout(_this.zoomabletimeout),_this.zoomabletimeout=!1},$.fn.lightGallery.modules.zoom=Zoom}(jQuery,window,document),function($,window,document,undefined){"use strict";var defaults={thumbnail:!0,animateThumb:!0,currentPagerPosition:"middle",thumbWidth:100,thumbContHeight:100,thumbMargin:5,exThumbImage:!1,showThumbByDefault:!0,toogleThumb:!0,pullCaptionUp:!0,enableThumbDrag:!0,enableThumbSwipe:!0,swipeThreshold:50,loadYoutubeThumbnail:!0,youtubeThumbSize:1,loadVimeoThumbnail:!0,vimeoThumbSize:"thumbnail_small",loadDailymotionThumbnail:!0},Thumbnail=function(element){return this.core=$(element).data("lightGallery"),this.core.s=$.extend({},defaults,this.core.s),this.$el=$(element),this.$thumbOuter=null,this.thumbOuterWidth=0,this.thumbTotalWidth=this.core.$items.length*(this.core.s.thumbWidth+this.core.s.thumbMargin),this.thumbIndex=this.core.index,this.left=0,this.init(),this};Thumbnail.prototype.init=function(){var _this=this;this.core.s.thumbnail&&this.core.$items.length>1&&(this.core.s.showThumbByDefault&&setTimeout(function(){_this.core.$outer.addClass("lg-thumb-open")},700),this.core.s.pullCaptionUp&&this.core.$outer.addClass("lg-pull-caption-up"),this.build(),this.core.s.animateThumb?(this.core.s.enableThumbDrag&&!this.core.isTouch&&this.core.doCss()&&this.enableThumbDrag(),this.core.s.enableThumbSwipe&&this.core.isTouch&&this.core.doCss()&&this.enableThumbSwipe(),this.thumbClickable=!1):this.thumbClickable=!0,this.toogle(),this.thumbkeyPress())},Thumbnail.prototype.build=function(){function getThumb(src,thumb,index){var thumbImg,isVideo=_this.core.isVideo(src,index)||{},vimeoId="";isVideo.youtube||isVideo.vimeo||isVideo.dailymotion?isVideo.youtube?thumbImg=_this.core.s.loadYoutubeThumbnail?"//img.youtube.com/vi/"+isVideo.youtube[1]+"/"+_this.core.s.youtubeThumbSize+".jpg":thumb:isVideo.vimeo?_this.core.s.loadVimeoThumbnail?(thumbImg="//i.vimeocdn.com/video/error_"+vimeoErrorThumbSize+".jpg",vimeoId=isVideo.vimeo[1]):thumbImg=thumb:isVideo.dailymotion&&(thumbImg=_this.core.s.loadDailymotionThumbnail?"//www.dailymotion.com/thumbnail/video/"+isVideo.dailymotion[1]:thumb):thumbImg=thumb,thumbList+='<div data-vimeo-id="'+vimeoId+'" class="lg-thumb-item" style="width:'+_this.core.s.thumbWidth+"px; margin-right: "+_this.core.s.thumbMargin+'px"><img src="'+thumbImg+'" /></div>',vimeoId=""}var $thumb,_this=this,thumbList="",vimeoErrorThumbSize="",html='<div class="lg-thumb-outer"><div class="lg-thumb group"></div></div>';switch(this.core.s.vimeoThumbSize){case"thumbnail_large":vimeoErrorThumbSize="640";break;case"thumbnail_medium":vimeoErrorThumbSize="200x150";break;case"thumbnail_small":vimeoErrorThumbSize="100x75"}if(_this.core.$outer.addClass("lg-has-thumb"),_this.core.$outer.find(".lg").append(html),_this.$thumbOuter=_this.core.$outer.find(".lg-thumb-outer"),_this.thumbOuterWidth=_this.$thumbOuter.width(),_this.core.s.animateThumb&&_this.core.$outer.find(".lg-thumb").css({width:_this.thumbTotalWidth+"px",position:"relative"}),this.core.s.animateThumb&&_this.$thumbOuter.css("height",_this.core.s.thumbContHeight+"px"),_this.core.s.dynamic)for(var i=0;i<_this.core.s.dynamicEl.length;i++)getThumb(_this.core.s.dynamicEl[i].src,_this.core.s.dynamicEl[i].thumb,i);else _this.core.$items.each(function(i){_this.core.s.exThumbImage?getThumb($(this).attr("href")||$(this).attr("data-src"),$(this).attr(_this.core.s.exThumbImage),i):getThumb($(this).attr("href")||$(this).attr("data-src"),$(this).find("img").attr("src"),i)});_this.core.$outer.find(".lg-thumb").html(thumbList),$thumb=_this.core.$outer.find(".lg-thumb-item"),$thumb.each(function(){var $this=$(this),vimeoVideoId=$this.attr("data-vimeo-id");vimeoVideoId&&$.getJSON("//www.vimeo.com/api/v2/video/"+vimeoVideoId+".json?callback=?",{format:"json"},function(data){$this.find("img").attr("src",data[0][_this.core.s.vimeoThumbSize])})}),$thumb.eq(_this.core.index).addClass("active"),_this.core.$el.on("onBeforeSlide.lg.tm",function(){$thumb.removeClass("active"),$thumb.eq(_this.core.index).addClass("active")}),$thumb.on("click.lg touchend.lg",function(){var _$this=$(this);setTimeout(function(){(_this.thumbClickable&&!_this.core.lgBusy||!_this.core.doCss())&&(_this.core.index=_$this.index(),_this.core.slide(_this.core.index,!1,!0))},50)}),_this.core.$el.on("onBeforeSlide.lg.tm",function(){_this.animateThumb(_this.core.index)}),$(window).on("resize.lg.thumb orientationchange.lg.thumb",function(){setTimeout(function(){_this.animateThumb(_this.core.index),_this.thumbOuterWidth=_this.$thumbOuter.width()},200)})},Thumbnail.prototype.setTranslate=function(value){this.core.$outer.find(".lg-thumb").css({transform:"translate3d(-"+value+"px, 0px, 0px)"})},Thumbnail.prototype.animateThumb=function(index){var $thumb=this.core.$outer.find(".lg-thumb");if(this.core.s.animateThumb){var position;switch(this.core.s.currentPagerPosition){case"left":position=0;break;case"middle":position=this.thumbOuterWidth/2-this.core.s.thumbWidth/2;break;case"right":position=this.thumbOuterWidth-this.core.s.thumbWidth}this.left=(this.core.s.thumbWidth+this.core.s.thumbMargin)*index-1-position,this.left>this.thumbTotalWidth-this.thumbOuterWidth&&(this.left=this.thumbTotalWidth-this.thumbOuterWidth),this.left<0&&(this.left=0),this.core.lGalleryOn?($thumb.hasClass("on")||this.core.$outer.find(".lg-thumb").css("transition-duration",this.core.s.speed+"ms"),this.core.doCss()||$thumb.animate({left:-this.left+"px"},this.core.s.speed)):this.core.doCss()||$thumb.css("left",-this.left+"px"),this.setTranslate(this.left)}},Thumbnail.prototype.enableThumbDrag=function(){var _this=this,startCoords=0,endCoords=0,isDraging=!1,isMoved=!1,tempLeft=0;_this.$thumbOuter.addClass("lg-grab"),_this.core.$outer.find(".lg-thumb").on("mousedown.lg.thumb",function(e){_this.thumbTotalWidth>_this.thumbOuterWidth&&(e.preventDefault(),startCoords=e.pageX,isDraging=!0,_this.core.$outer.scrollLeft+=1,_this.core.$outer.scrollLeft-=1,_this.thumbClickable=!1,_this.$thumbOuter.removeClass("lg-grab").addClass("lg-grabbing"))}),$(window).on("mousemove.lg.thumb",function(e){isDraging&&(tempLeft=_this.left,isMoved=!0,endCoords=e.pageX,_this.$thumbOuter.addClass("lg-dragging"),tempLeft-=endCoords-startCoords,tempLeft>_this.thumbTotalWidth-_this.thumbOuterWidth&&(tempLeft=_this.thumbTotalWidth-_this.thumbOuterWidth),tempLeft<0&&(tempLeft=0),_this.setTranslate(tempLeft))}),$(window).on("mouseup.lg.thumb",function(){isMoved?(isMoved=!1,_this.$thumbOuter.removeClass("lg-dragging"),_this.left=tempLeft,Math.abs(endCoords-startCoords)<_this.core.s.swipeThreshold&&(_this.thumbClickable=!0)):_this.thumbClickable=!0,isDraging&&(isDraging=!1,_this.$thumbOuter.removeClass("lg-grabbing").addClass("lg-grab"))})},Thumbnail.prototype.enableThumbSwipe=function(){var _this=this,startCoords=0,endCoords=0,isMoved=!1,tempLeft=0;_this.core.$outer.find(".lg-thumb").on("touchstart.lg",function(e){_this.thumbTotalWidth>_this.thumbOuterWidth&&(e.preventDefault(),startCoords=e.originalEvent.targetTouches[0].pageX,_this.thumbClickable=!1)}),_this.core.$outer.find(".lg-thumb").on("touchmove.lg",function(e){_this.thumbTotalWidth>_this.thumbOuterWidth&&(e.preventDefault(),endCoords=e.originalEvent.targetTouches[0].pageX,isMoved=!0,_this.$thumbOuter.addClass("lg-dragging"),tempLeft=_this.left,tempLeft-=endCoords-startCoords,tempLeft>_this.thumbTotalWidth-_this.thumbOuterWidth&&(tempLeft=_this.thumbTotalWidth-_this.thumbOuterWidth),tempLeft<0&&(tempLeft=0),_this.setTranslate(tempLeft))}),_this.core.$outer.find(".lg-thumb").on("touchend.lg",function(){_this.thumbTotalWidth>_this.thumbOuterWidth&&isMoved?(isMoved=!1,_this.$thumbOuter.removeClass("lg-dragging"),Math.abs(endCoords-startCoords)<_this.core.s.swipeThreshold&&(_this.thumbClickable=!0),_this.left=tempLeft):_this.thumbClickable=!0})},Thumbnail.prototype.toogle=function(){var _this=this;_this.core.s.toogleThumb&&(_this.core.$outer.addClass("lg-can-toggle"),_this.$thumbOuter.append('<span class="lg-toogle-thumb lg-icon"></span>'),_this.core.$outer.find(".lg-toogle-thumb").on("click.lg",function(){_this.core.$outer.toggleClass("lg-thumb-open")}))},Thumbnail.prototype.thumbkeyPress=function(){var _this=this;$(window).on("keydown.lg.thumb",function(e){38===e.keyCode?(e.preventDefault(),_this.core.$outer.addClass("lg-thumb-open")):40===e.keyCode&&(e.preventDefault(),_this.core.$outer.removeClass("lg-thumb-open"))})},Thumbnail.prototype.destroy=function(){this.core.s.thumbnail&&this.core.$items.length>1&&($(window).off("resize.lg.thumb orientationchange.lg.thumb keydown.lg.thumb"),this.$thumbOuter.remove(),this.core.$outer.removeClass("lg-has-thumb"))},$.fn.lightGallery.modules.Thumbnail=Thumbnail}(jQuery,window,document),function($,window,document,undefined){"use strict";var defaults={videoMaxWidth:"855px",youtubePlayerParams:!1,vimeoPlayerParams:!1,dailymotionPlayerParams:!1,vkPlayerParams:!1,videojs:!1,videojsOptions:{}},Video=function(element){return this.core=$(element).data("lightGallery"),this.$el=$(element),this.core.s=$.extend({},defaults,this.core.s),this.videoLoaded=!1,this.init(),this};Video.prototype.init=function(){var _this=this;_this.core.$el.on("hasVideo.lg.tm",function(event,index,src,html){if(_this.core.$slide.eq(index).find(".lg-video").append(_this.loadVideo(src,"lg-object",!0,index,html)),html)if(_this.core.s.videojs)try{videojs(_this.core.$slide.eq(index).find(".lg-html5").get(0),_this.core.s.videojsOptions,function(){_this.videoLoaded||this.play()})}catch(e){console.error("Make sure you have included videojs")}else _this.core.$slide.eq(index).find(".lg-html5").get(0).play()}),_this.core.$el.on("onAferAppendSlide.lg.tm",function(event,index){_this.core.$slide.eq(index).find(".lg-video-cont").css("max-width",_this.core.s.videoMaxWidth),_this.videoLoaded=!0});var loadOnClick=function($el){if($el.find(".lg-object").hasClass("lg-has-poster")&&$el.find(".lg-object").is(":visible"))if($el.hasClass("lg-has-video")){var youtubePlayer=$el.find(".lg-youtube").get(0),vimeoPlayer=$el.find(".lg-vimeo").get(0),dailymotionPlayer=$el.find(".lg-dailymotion").get(0),html5Player=$el.find(".lg-html5").get(0);if(youtubePlayer)youtubePlayer.contentWindow.postMessage('{"event":"command","func":"playVideo","args":""}',"*");else if(vimeoPlayer)try{$f(vimeoPlayer).api("play")}catch(e){console.error("Make sure you have included froogaloop2 js")}else if(dailymotionPlayer)dailymotionPlayer.contentWindow.postMessage("play","*");else if(html5Player)if(_this.core.s.videojs)try{videojs(html5Player).play()}catch(e){console.error("Make sure you have included videojs")}else html5Player.play();$el.addClass("lg-video-playing")}else{$el.addClass("lg-video-playing lg-has-video");var _src,_html,_loadVideo=function(_src,_html){if($el.find(".lg-video").append(_this.loadVideo(_src,"",!1,_this.core.index,_html)),_html)if(_this.core.s.videojs)try{videojs(_this.core.$slide.eq(_this.core.index).find(".lg-html5").get(0),_this.core.s.videojsOptions,function(){this.play()})}catch(e){console.error("Make sure you have included videojs")}else _this.core.$slide.eq(_this.core.index).find(".lg-html5").get(0).play()};_this.core.s.dynamic?(_src=_this.core.s.dynamicEl[_this.core.index].src,_html=_this.core.s.dynamicEl[_this.core.index].html,_loadVideo(_src,_html)):(_src=_this.core.$items.eq(_this.core.index).attr("href")||_this.core.$items.eq(_this.core.index).attr("data-src"),_html=_this.core.$items.eq(_this.core.index).attr("data-html"),_loadVideo(_src,_html));var $tempImg=$el.find(".lg-object");$el.find(".lg-video").append($tempImg),$el.find(".lg-video-object").hasClass("lg-html5")||($el.removeClass("lg-complete"),$el.find(".lg-video-object").on("load.lg error.lg",function(){$el.addClass("lg-complete")}))}};_this.core.doCss()&&_this.core.$items.length>1&&(_this.core.s.enableSwipe&&_this.core.isTouch||_this.core.s.enableDrag&&!_this.core.isTouch)?_this.core.$el.on("onSlideClick.lg.tm",function(){var $el=_this.core.$slide.eq(_this.core.index);loadOnClick($el)}):_this.core.$slide.on("click.lg",function(){loadOnClick($(this))}),_this.core.$el.on("onBeforeSlide.lg.tm",function(event,prevIndex,index){var $videoSlide=_this.core.$slide.eq(prevIndex),youtubePlayer=$videoSlide.find(".lg-youtube").get(0),vimeoPlayer=$videoSlide.find(".lg-vimeo").get(0),dailymotionPlayer=$videoSlide.find(".lg-dailymotion").get(0),vkPlayer=$videoSlide.find(".lg-vk").get(0),html5Player=$videoSlide.find(".lg-html5").get(0);if(youtubePlayer)youtubePlayer.contentWindow.postMessage('{"event":"command","func":"pauseVideo","args":""}',"*");else if(vimeoPlayer)try{$f(vimeoPlayer).api("pause")}catch(e){console.error("Make sure you have included froogaloop2 js")}else if(dailymotionPlayer)dailymotionPlayer.contentWindow.postMessage("pause","*");else if(html5Player)if(_this.core.s.videojs)try{videojs(html5Player).pause()}catch(e){console.error("Make sure you have included videojs")}else html5Player.pause();vkPlayer&&$(vkPlayer).attr("src",$(vkPlayer).attr("src").replace("&autoplay","&noplay"));var _src;_src=_this.core.s.dynamic?_this.core.s.dynamicEl[index].src:_this.core.$items.eq(index).attr("href")||_this.core.$items.eq(index).attr("data-src");var _isVideo=_this.core.isVideo(_src,index)||{};(_isVideo.youtube||_isVideo.vimeo||_isVideo.dailymotion||_isVideo.vk)&&_this.core.$outer.addClass("lg-hide-download")}),_this.core.$el.on("onAfterSlide.lg.tm",function(event,prevIndex){_this.core.$slide.eq(prevIndex).removeClass("lg-video-playing")})},Video.prototype.loadVideo=function(src,addClass,noposter,index,html){var video="",autoplay=1,a="",isVideo=this.core.isVideo(src,index)||{};if(noposter&&(autoplay=this.videoLoaded?0:1),isVideo.youtube)a="?wmode=opaque&autoplay="+autoplay+"&enablejsapi=1",this.core.s.youtubePlayerParams&&(a=a+"&"+$.param(this.core.s.youtubePlayerParams)),video='<iframe class="lg-video-object lg-youtube '+addClass+'" width="560" height="315" src="//www.youtube.com/embed/'+isVideo.youtube[1]+a+'" frameborder="0" allowfullscreen></iframe>';else if(isVideo.vimeo)a="?autoplay="+autoplay+"&api=1",this.core.s.vimeoPlayerParams&&(a=a+"&"+$.param(this.core.s.vimeoPlayerParams)),video='<iframe class="lg-video-object lg-vimeo '+addClass+'" width="560" height="315"  src="//player.vimeo.com/video/'+isVideo.vimeo[1]+a+'" frameborder="0" webkitAllowFullScreen mozallowfullscreen allowFullScreen></iframe>';else if(isVideo.dailymotion)a="?wmode=opaque&autoplay="+autoplay+"&api=postMessage",this.core.s.dailymotionPlayerParams&&(a=a+"&"+$.param(this.core.s.dailymotionPlayerParams)),video='<iframe class="lg-video-object lg-dailymotion '+addClass+'" width="560" height="315" src="//www.dailymotion.com/embed/video/'+isVideo.dailymotion[1]+a+'" frameborder="0" allowfullscreen></iframe>';else if(isVideo.html5){var fL=html.substring(0,1);"."!==fL&&"#"!==fL||(html=$(html).html()),video=html}else isVideo.vk&&(a="&autoplay="+autoplay,this.core.s.vkPlayerParams&&(a=a+"&"+$.param(this.core.s.vkPlayerParams)),video='<iframe class="lg-video-object lg-vk '+addClass+'" width="560" height="315" src="http://vk.com/video_ext.php?'+isVideo.vk[1]+a+'" frameborder="0" allowfullscreen></iframe>');return video},Video.prototype.destroy=function(){this.videoLoaded=!1},$.fn.lightGallery.modules.video=Video}(jQuery,window,document),function($){var div=document.createElement("div"),all=div.getElementsByTagName("i"),$doc=$(document.documentElement);div.innerHTML="\x3c!--[if lte IE 8]><i></i><![endif]--\x3e",all[0]&&$doc.addClass("ie-lte8"),"querySelector"in document&&(!window.blackberry||window.WebKitPoint)&&!window.operamini&&($doc.addClass("tablesaw-enhanced"),$(function(){$(document).trigger("enhance.tablesaw")}))}(jQuery),"undefined"==typeof Tablesaw&&(Tablesaw={i18n:{modes:["Stack","Swipe","Toggle"],columns:'Col<span class="a11y-sm">umn</span>s',columnBtnText:"Columns",columnsDialogError:"No eligible columns.",sort:"Sort"}}),Tablesaw.config||(Tablesaw.config={}),function($){var pluginName="table",classes={toolbar:"tablesaw-bar"},events={create:"tablesawcreate",destroy:"tablesawdestroy",refresh:"tablesawrefresh"},defaultMode="stack",Table=function(element){if(!element)throw new Error("Tablesaw requires an element.");this.table=element,this.$table=$(element),this.mode=this.$table.attr("data-tablesaw-mode")||defaultMode,this.init()};Table.prototype.init=function(){this.$table.attr("id")||this.$table.attr("id",pluginName+"-"+Math.round(1e4*Math.random())),this.createToolbar();var colstart=this._initCells();this.$table.trigger(events.create,[this,colstart])},Table.prototype._initCells=function(){var colstart,thrs=this.table.querySelectorAll("thead tr"),self=this;return $(thrs).each(function(){var coltally=0;$(this).children().each(function(){var span=parseInt(this.getAttribute("colspan"),10),sel=":nth-child("+(coltally+1)+")";if(colstart=coltally+1,span)for(var k=0;k<span-1;k++)coltally++,sel+=", :nth-child("+(coltally+1)+")";this.cells=self.$table.find("tr").not($(thrs).eq(0)).not(this).children(sel),coltally++})}),colstart},Table.prototype.refresh=function(){this._initCells(),this.$table.trigger(events.refresh)},Table.prototype.createToolbar=function(){var $toolbar=this.$table.prev("."+classes.toolbar);$toolbar.length||($toolbar=$("<div>").addClass(classes.toolbar).insertBefore(this.$table)),this.$toolbar=$toolbar,this.mode&&this.$toolbar.addClass("mode-"+this.mode)},Table.prototype.destroy=function(){this.$table.prev("."+classes.toolbar).each(function(){this.className=this.className.replace(/\bmode\-\w*\b/gi,"")});var tableId=this.$table.attr("id");$(document).unbind("."+tableId),$(window).unbind("."+tableId),this.$table.trigger(events.destroy,[this]),this.$table.removeAttr("data-tablesaw-mode"),this.$table.removeData(pluginName)},$.fn[pluginName]=function(){return this.each(function(){var $t=$(this);if(!$t.data(pluginName)){var table=new Table(this);$t.data(pluginName,table)}})},$(document).on("enhance.tablesaw",function(e){$(e.target).find("table[data-tablesaw-mode],table[data-tablesaw-sortable]")[pluginName]()})}(jQuery),function(win,$,undefined){var classes={stackTable:"tablesaw-stack",cellLabels:"tablesaw-cell-label",cellContentLabels:"tablesaw-cell-content"},data={obj:"tablesaw-stack"},attrs={labelless:"data-tablesaw-no-labels",hideempty:"data-tablesaw-hide-empty"},Stack=function(element){this.$table=$(element),this.labelless=this.$table.is("["+attrs.labelless+"]"),this.hideempty=this.$table.is("["+attrs.hideempty+"]"),this.labelless||(this.allHeaders=this.$table.find("th")),this.$table.data(data.obj,this)};Stack.prototype.init=function(colstart){if(this.$table.addClass(classes.stackTable),!this.labelless){var reverseHeaders=$(this.allHeaders),hideempty=this.hideempty;reverseHeaders.each(function(){var $t=$(this),$cells=$(this.cells).filter(function(){return!($(this).parent().is("["+attrs.labelless+"]")||hideempty&&$(this).is(":empty"))}),hierarchyClass=$cells.not(this).filter("thead th").length&&" tablesaw-cell-label-top",$sortableButton=$t.find(".tablesaw-sortable-btn"),html=$sortableButton.length?$sortableButton.html():$t.html();if(""!==html)if(hierarchyClass){var iteration=parseInt($(this).attr("colspan"),10),filter="";iteration&&(filter="td:nth-child("+iteration+"n + "+colstart+")"),$cells.filter(filter).prepend("<b class='"+classes.cellLabels+hierarchyClass+"'>"+html+"</b>")}else $cells.wrapInner("<span class='"+classes.cellContentLabels+"'></span>"),$cells.prepend("<b class='"+classes.cellLabels+"'>"+html+"</b>")})}},Stack.prototype.destroy=function(){this.$table.removeClass(classes.stackTable),this.$table.find("."+classes.cellLabels).remove(),this.$table.find("."+classes.cellContentLabels).each(function(){$(this).replaceWith(this.childNodes)})},$(document).on("tablesawcreate",function(e,Tablesaw,colstart){if("stack"===Tablesaw.mode){new Stack(Tablesaw.table).init(colstart)}}),$(document).on("tablesawdestroy",function(e,Tablesaw){"stack"===Tablesaw.mode&&$(Tablesaw.table).data(data.obj).destroy()})}(0,jQuery);var Base=function(){};Base.extend=function(_instance,_static){"use strict";var extend=Base.prototype.extend;Base._prototyping=!0;var proto=new this;extend.call(proto,_instance),proto.base=function(){},delete Base._prototyping;var constructor=proto.constructor,klass=proto.constructor=function(){if(!Base._prototyping)if(this._constructing||this.constructor==klass)this._constructing=!0,constructor.apply(this,arguments),delete this._constructing;else if(null!==arguments[0])return(arguments[0].extend||extend).call(arguments[0],proto)};return klass.ancestor=this,klass.extend=this.extend,klass.forEach=this.forEach,klass.implement=this.implement,klass.prototype=proto,klass.toString=this.toString,klass.valueOf=function(type){return"object"==type?klass:constructor.valueOf()},extend.call(klass,_static),"function"==typeof klass.init&&klass.init(),klass},Base.prototype={extend:function(source,value){if(arguments.length>1){var ancestor=this[source];if(ancestor&&"function"==typeof value&&(!ancestor.valueOf||ancestor.valueOf()!=value.valueOf())&&/\bbase\b/.test(value)){var method=value.valueOf();value=function(){var previous=this.base||Base.prototype.base;this.base=ancestor;var returnValue=method.apply(this,arguments);return this.base=previous,returnValue},value.valueOf=function(type){return"object"==type?value:method},value.toString=Base.toString}this[source]=value}else if(source){var extend=Base.prototype.extend;Base._prototyping||"function"==typeof this||(extend=this.extend||extend);for(var proto={toSource:null},hidden=["constructor","toString","valueOf"],i=Base._prototyping?0:1;key=hidden[i++];)source[key]!=proto[key]&&extend.call(this,key,source[key]);for(var key in source)proto[key]||extend.call(this,key,source[key])}return this}},Base=Base.extend({constructor:function(){this.extend(arguments[0])}},{ancestor:Object,version:"1.1",forEach:function(object,block,context){for(var key in object)void 0===this.prototype[key]&&block.call(context,object[key],key,object)},implement:function(){for(var i=0;i<arguments.length;i++)"function"==typeof arguments[i]?arguments[i](this.prototype):this.prototype.extend(arguments[i]);return this},toString:function(){return String(this.valueOf())}});var FlipClock;!function($){"use strict";FlipClock=function(obj,digit,options){return digit instanceof Object&&digit instanceof Date==!1&&(options=digit,digit=0),new FlipClock.Factory(obj,digit,options)},FlipClock.Lang={},FlipClock.Base=Base.extend({buildDate:"2014-12-12",version:"0.7.7",constructor:function(_default,options){"object"!=typeof _default&&(_default={}),"object"!=typeof options&&(options={}),this.setOptions($.extend(!0,{},_default,options))},callback:function(method){if("function"==typeof method){for(var args=[],x=1;x<=arguments.length;x++)arguments[x]&&args.push(arguments[x]);method.apply(this,args)}},log:function(str){window.console&&console.log&&console.log(str)},getOption:function(index){return!!this[index]&&this[index]},getOptions:function(){return this},setOption:function(index,value){this[index]=value},setOptions:function(options){for(var key in options)void 0!==options[key]&&this.setOption(key,options[key])}})}(jQuery),function($){"use strict";FlipClock.Face=FlipClock.Base.extend({autoStart:!0,dividers:[],factory:!1,lists:[],constructor:function(factory,options){this.dividers=[],this.lists=[],this.base(options),this.factory=factory},build:function(){this.autoStart&&this.start()},createDivider:function(label,css,excludeDots){"boolean"!=typeof css&&css||(excludeDots=css,css=label);var dots=['<span class="'+this.factory.classes.dot+' top"></span>','<span class="'+this.factory.classes.dot+' bottom"></span>'].join("");excludeDots&&(dots=""),label="";var html=['<span class="'+this.factory.classes.divider+" "+(css||"").toLowerCase()+'">','<span class="'+this.factory.classes.label+'">'+(label||"")+"</span>",dots,"</span>"],$html=$(html.join(""));return this.dividers.push($html),$html},createList:function(digit,options){"object"==typeof digit&&(options=digit,digit=0);var obj=new FlipClock.List(this.factory,digit,options);return this.lists.push(obj),obj},reset:function(){this.factory.time=new FlipClock.Time(this.factory,this.factory.original?Math.round(this.factory.original):0,{minimumDigits:this.factory.minimumDigits}),this.flip(this.factory.original,!1)},appendDigitToClock:function(obj){obj.$el.append(!1)},addDigit:function(digit){var obj=this.createList(digit,{classes:{active:this.factory.classes.active,before:this.factory.classes.before,flip:this.factory.classes.flip}});this.appendDigitToClock(obj)},start:function(){},stop:function(){},autoIncrement:function(){this.factory.countdown?this.decrement():this.increment()},increment:function(){this.factory.time.addSecond()},decrement:function(){0==this.factory.time.getTimeSeconds()?this.factory.stop():this.factory.time.subSecond()},flip:function(time,doNotAddPlayClass){var t=this;$.each(time,function(i,digit){var list=t.lists[i];list?(doNotAddPlayClass||digit==list.digit||list.play(),list.select(digit)):t.addDigit(digit)})}})}(jQuery),function($){"use strict";FlipClock.Factory=FlipClock.Base.extend({animationRate:1e3,autoStart:!0,callbacks:{destroy:!1,create:!1,init:!1,interval:!1,start:!1,stop:!1,reset:!1},classes:{active:"flip-clock-active",before:"flip-clock-before",divider:"flip-clock-divider",dot:"flip-clock-dot",label:"flip-clock-label",flip:"flip",play:"play",wrapper:"flip-clock-wrapper"},clockFace:"HourlyCounter",countdown:!1,defaultClockFace:"HourlyCounter",defaultLanguage:"english",$el:!1,face:!0,lang:!1,language:"english",minimumDigits:0,original:!1,running:!1,time:!1,timer:!1,$wrapper:!1,constructor:function(obj,digit,options){options||(options={}),this.lists=[],this.running=!1,this.base(options),this.$el=$(obj).addClass(this.classes.wrapper),this.$wrapper=this.$el,this.original=digit instanceof Date?digit:digit?Math.round(digit):0,this.time=new FlipClock.Time(this,this.original,{minimumDigits:this.minimumDigits,animationRate:this.animationRate}),this.timer=new FlipClock.Timer(this,options),this.loadLanguage(this.language),this.loadClockFace(this.clockFace,options),this.autoStart&&this.start()},loadClockFace:function(name,options){var face,suffix="Face",hasStopped=!1;return name=name.ucfirst()+suffix,this.face.stop&&(this.stop(),hasStopped=!0),this.$el.html(""),this.time.minimumDigits=this.minimumDigits,face=FlipClock[name]?new FlipClock[name](this,options):new FlipClock[this.defaultClockFace+suffix](this,options),face.build(),this.face=face,hasStopped&&this.start(),this.face},loadLanguage:function(name){var lang;return lang=FlipClock.Lang[name.ucfirst()]?FlipClock.Lang[name.ucfirst()]:FlipClock.Lang[name]?FlipClock.Lang[name]:FlipClock.Lang[this.defaultLanguage],this.lang=lang},localize:function(index,obj){var lang=this.lang;if(!index)return null;var lindex=index.toLowerCase();return"object"==typeof obj&&(lang=obj),lang&&lang[lindex]?lang[lindex]:index},start:function(callback){var t=this;t.running||t.countdown&&!(t.countdown&&t.time.time>0)?t.log("Trying to start timer when countdown already at 0"):(t.face.start(t.time),t.timer.start(function(){t.flip(),"function"==typeof callback&&callback()}))},stop:function(callback){this.face.stop(),this.timer.stop(callback);for(var x in this.lists)this.lists.hasOwnProperty(x)&&this.lists[x].stop()},reset:function(callback){this.timer.reset(callback),this.face.reset()},setTime:function(time){this.time.time=time,this.flip(!0)},getTime:function(time){return this.time},setCountdown:function(value){var running=this.running;this.countdown=!!value,running&&(this.stop(),this.start())},flip:function(doNotAddPlayClass){this.face.flip(!1,doNotAddPlayClass)}})}(jQuery),function($){"use strict";FlipClock.List=FlipClock.Base.extend({digit:0,classes:{active:"flip-clock-active",before:"flip-clock-before",flip:"flip"},factory:!1,$el:!1,$obj:!1,items:[],lastDigit:0,constructor:function(factory,digit,options){this.factory=factory,this.digit=digit,this.lastDigit=digit,this.$el=this.createList(),this.$obj=this.$el,digit>0&&this.select(digit),this.factory.$el.append(this.$el)},select:function(digit){if(void 0===digit?digit=this.digit:this.digit=digit,this.digit!=this.lastDigit){var $delete=this.$el.find("."+this.classes.before).removeClass(this.classes.before);this.$el.find("."+this.classes.active).removeClass(this.classes.active).addClass(this.classes.before),this.appendListItem(this.classes.active,this.digit),$delete.remove(),this.lastDigit=this.digit}},play:function(){this.$el.addClass(this.factory.classes.play)},stop:function(){var t=this;setTimeout(function(){t.$el.removeClass(t.factory.classes.play)},this.factory.timer.interval)},createListItem:function(css,value){return['<li class="'+(css||"")+'">','<a href="#">','<div class="up">','<div class="shadow"></div>','<div class="inn">'+(value||"")+"</div>","</div>",'<div class="down">','<div class="shadow"></div>','<div class="inn">'+(value||"")+"</div>","</div>","</a>","</li>"].join("")},appendListItem:function(css,value){var html=this.createListItem(css,value);this.$el.append(html)},createList:function(){var lastDigit=this.getPrevDigit()?this.getPrevDigit():this.digit;return $(['<ul class="'+this.classes.flip+" "+(this.factory.running?this.factory.classes.play:"")+'">',this.createListItem(this.classes.before,lastDigit),this.createListItem(this.classes.active,this.digit),"</ul>"].join(""))},getNextDigit:function(){return 9==this.digit?0:this.digit+1},getPrevDigit:function(){return 0==this.digit?9:this.digit-1}})}(jQuery),function($){"use strict";String.prototype.ucfirst=function(){return this.substr(0,1).toUpperCase()+this.substr(1)},$.fn.FlipClock=function(digit,options){return new FlipClock($(this),digit,options)},$.fn.flipClock=function(digit,options){return $.fn.FlipClock(digit,options)}}(jQuery),function($){"use strict";FlipClock.Time=FlipClock.Base.extend({time:0,factory:!1,minimumDigits:0,constructor:function(factory,time,options){"object"!=typeof options&&(options={}),options.minimumDigits||(options.minimumDigits=factory.minimumDigits),this.base(options),this.factory=factory,time&&(this.time=time)},convertDigitsToArray:function(str){var data=[];str=str.toString();for(var x=0;x<str.length;x++)str[x].match(/^\d*$/g)&&data.push(str[x]);return data},digit:function(i){var timeStr=this.toString(),length=timeStr.length;return!!timeStr[length-i]&&timeStr[length-i]},digitize:function(obj){var data=[];if($.each(obj,function(i,value){value=value.toString(),1==value.length&&(value="0"+value);for(var x=0;x<value.length;x++)data.push(value.charAt(x))}),data.length>this.minimumDigits&&(this.minimumDigits=data.length),this.minimumDigits>data.length)for(var x=data.length;x<this.minimumDigits;x++)data.unshift("0");return data},getDateObject:function(){return this.time instanceof Date?this.time:new Date((new Date).getTime()+1e3*this.getTimeSeconds())},getDayCounter:function(includeSeconds){var digits=[this.getDays(),this.getHours(!0),this.getMinutes(!0)];return includeSeconds&&digits.push(this.getSeconds(!0)),this.digitize(digits)},getDays:function(mod){var days=this.getTimeSeconds()/60/60/24;return mod&&(days%=7),Math.floor(days)},getHourCounter:function(){return this.digitize([this.getHours(),this.getMinutes(!0),this.getSeconds(!0)])},getHourly:function(){return this.getHourCounter()},getHours:function(mod){var hours=this.getTimeSeconds()/60/60;return mod&&(hours%=24),Math.floor(hours)},getMilitaryTime:function(date,showSeconds){void 0===showSeconds&&(showSeconds=!0),date||(date=this.getDateObject());var data=[date.getHours(),date.getMinutes()];return!0===showSeconds&&data.push(date.getSeconds()),this.digitize(data)},getMinutes:function(mod){var minutes=this.getTimeSeconds()/60;return mod&&(minutes%=60),Math.floor(minutes)},getMinuteCounter:function(){return this.digitize([this.getMinutes(),this.getSeconds(!0)])},getTimeSeconds:function(date){return date||(date=new Date),this.time instanceof Date?this.factory.countdown?Math.max(this.time.getTime()/1e3-date.getTime()/1e3,0):date.getTime()/1e3-this.time.getTime()/1e3:this.time},getTime:function(date,showSeconds){void 0===showSeconds&&(showSeconds=!0),date||(date=this.getDateObject()),console.log(date);var hours=date.getHours(),data=[hours>12?hours-12:0===hours?12:hours,date.getMinutes()];return!0===showSeconds&&data.push(date.getSeconds()),this.digitize(data)},getSeconds:function(mod){var seconds=this.getTimeSeconds();return mod&&(60==seconds?seconds=0:seconds%=60),Math.ceil(seconds)},getWeeks:function(mod){var weeks=this.getTimeSeconds()/60/60/24/7;return mod&&(weeks%=52),Math.floor(weeks)},removeLeadingZeros:function(totalDigits,digits){var total=0,newArray=[];return $.each(digits,function(i,digit){i<totalDigits?total+=parseInt(digits[i],10):newArray.push(digits[i])}),0===total?newArray:digits},addSeconds:function(x){this.time instanceof Date?this.time.setSeconds(this.time.getSeconds()+x):this.time+=x},addSecond:function(){this.addSeconds(1)},subSeconds:function(x){this.time instanceof Date?this.time.setSeconds(this.time.getSeconds()-x):this.time-=x},subSecond:function(){this.subSeconds(1)},toString:function(){return this.getTimeSeconds().toString()}})}(jQuery),function($){"use strict";FlipClock.Timer=FlipClock.Base.extend({callbacks:{destroy:!1,create:!1,init:!1,interval:!1,start:!1,stop:!1,reset:!1},count:0,factory:!1,interval:1e3,animationRate:1e3,constructor:function(factory,options){this.base(options),this.factory=factory,this.callback(this.callbacks.init),this.callback(this.callbacks.create)},getElapsed:function(){return this.count*this.interval},getElapsedTime:function(){return new Date(this.time+this.getElapsed())},reset:function(callback){clearInterval(this.timer),this.count=0,this._setInterval(callback),this.callback(this.callbacks.reset)},start:function(callback){this.factory.running=!0,this._createTimer(callback),this.callback(this.callbacks.start)},stop:function(callback){this.factory.running=!1,this._clearInterval(callback),this.callback(this.callbacks.stop),this.callback(callback)},_clearInterval:function(){clearInterval(this.timer)},_createTimer:function(callback){this._setInterval(callback)},_destroyTimer:function(callback){this._clearInterval(),this.timer=!1,this.callback(callback),this.callback(this.callbacks.destroy)},_interval:function(callback){this.callback(this.callbacks.interval),this.callback(callback),this.count++},_setInterval:function(callback){var t=this;t._interval(callback),t.timer=setInterval(function(){t._interval(callback)},this.interval)}})}(jQuery),function($){FlipClock.TwentyFourHourClockFace=FlipClock.Face.extend({constructor:function(factory,options){this.base(factory,options)},build:function(time){var t=this,children=this.factory.$el.find("ul");this.factory.time.time||(this.factory.original=new Date,this.factory.time=new FlipClock.Time(this.factory,this.factory.original));var time=time||this.factory.time.getMilitaryTime(!1,this.showSeconds);time.length>children.length&&$.each(time,function(i,digit){t.createList(digit)}),this.createDivider(),this.createDivider(),$(this.dividers[0]).insertBefore(this.lists[this.lists.length-2].$el),$(this.dividers[1]).insertBefore(this.lists[this.lists.length-4].$el),this.base()},flip:function(time,doNotAddPlayClass){this.autoIncrement(),time=time||this.factory.time.getMilitaryTime(!1,this.showSeconds),this.base(time,doNotAddPlayClass)}})}(jQuery),function($){FlipClock.CounterFace=FlipClock.Face.extend({shouldAutoIncrement:!1,constructor:function(factory,options){"object"!=typeof options&&(options={}),factory.autoStart=!!options.autoStart,options.autoStart&&(this.shouldAutoIncrement=!0),factory.increment=function(){factory.countdown=!1,factory.setTime(factory.getTime().getTimeSeconds()+1)},factory.decrement=function(){factory.countdown=!0;var time=factory.getTime().getTimeSeconds();time>0&&factory.setTime(time-1)},factory.setValue=function(digits){factory.setTime(digits)},factory.setCounter=function(digits){factory.setTime(digits)},this.base(factory,options)},build:function(){var t=this,children=this.factory.$el.find("ul"),time=this.factory.getTime().digitize([this.factory.getTime().time]);time.length>children.length&&$.each(time,function(i,digit){t.createList(digit).select(digit)}),$.each(this.lists,function(i,list){list.play()}),this.base()},flip:function(time,doNotAddPlayClass){this.shouldAutoIncrement&&this.autoIncrement(),time||(time=this.factory.getTime().digitize([this.factory.getTime().time])),this.base(time,doNotAddPlayClass)},reset:function(){this.factory.time=new FlipClock.Time(this.factory,this.factory.original?Math.round(this.factory.original):0),this.flip()}})}(jQuery),function($){FlipClock.DailyCounterFace=FlipClock.Face.extend({showSeconds:!0,constructor:function(factory,options){this.base(factory,options)},build:function(time){var t=this,children=this.factory.$el.find("ul"),offset=0;time=time||this.factory.time.getDayCounter(this.showSeconds),time.length>children.length&&$.each(time,function(i,digit){t.createList(digit)}),this.showSeconds?$(this.createDivider("Seconds")).insertBefore(this.lists[this.lists.length-2].$el):offset=2,$(this.createDivider("Minutes")).insertBefore(this.lists[this.lists.length-4+offset].$el),$(this.createDivider("Hours")).insertBefore(this.lists[this.lists.length-6+offset].$el),$(this.createDivider("Days",!0)).insertBefore(this.lists[0].$el),this.base()},flip:function(time,doNotAddPlayClass){time||(time=this.factory.time.getDayCounter(this.showSeconds)),this.autoIncrement(),this.base(time,doNotAddPlayClass)}})}(jQuery),function($){FlipClock.HourlyCounterFace=FlipClock.Face.extend({constructor:function(factory,options){this.base(factory,options)},build:function(excludeHours,time){var t=this,children=this.factory.$el.find("ul");time=time||this.factory.time.getHourCounter(),time.length>children.length&&$.each(time,function(i,digit){t.createList(digit)}),$(this.createDivider("Seconds")).insertBefore(this.lists[this.lists.length-2].$el),$(this.createDivider("Minutes")).insertBefore(this.lists[this.lists.length-4].$el),excludeHours||$(this.createDivider("Hours",!0)).insertBefore(this.lists[0].$el),this.base()},flip:function(time,doNotAddPlayClass){time||(time=this.factory.time.getHourCounter()),this.autoIncrement(),this.base(time,doNotAddPlayClass)},appendDigitToClock:function(obj){this.base(obj),this.dividers[0].insertAfter(this.dividers[0].next())}})}(jQuery),function($){FlipClock.MinuteCounterFace=FlipClock.HourlyCounterFace.extend({clearExcessDigits:!1,constructor:function(factory,options){this.base(factory,options)},build:function(){this.base(!0,this.factory.time.getMinuteCounter())},flip:function(time,doNotAddPlayClass){time||(time=this.factory.time.getMinuteCounter()),this.base(time,doNotAddPlayClass)}})}(jQuery),function($){FlipClock.TwelveHourClockFace=FlipClock.TwentyFourHourClockFace.extend({meridium:!1,meridiumText:"AM",build:function(){var time=this.factory.time.getTime(!1,this.showSeconds);this.base(time),this.meridiumText=this.getMeridium(),this.meridium=$(['<ul class="flip-clock-meridium">',"<li>",'<a href="#">'+this.meridiumText+"</a>","</li>","</ul>"].join("")),this.meridium.insertAfter(this.lists[this.lists.length-1].$el)},flip:function(time,doNotAddPlayClass){this.meridiumText!=this.getMeridium()&&(this.meridiumText=this.getMeridium(),this.meridium.find("a").html(this.meridiumText)),this.base(this.factory.time.getTime(!1,this.showSeconds),doNotAddPlayClass)},getMeridium:function(){return(new Date).getHours()>=12?"PM":"AM"},isPM:function(){return"PM"==this.getMeridium()},isAM:function(){return"AM"==this.getMeridium()}})}(jQuery),function($){FlipClock.Lang.Arabic={years:"سنوات",months:"شهور",days:"أيام",hours:"ساعات",minutes:"دقائق",seconds:"ثواني"},FlipClock.Lang.ar=FlipClock.Lang.Arabic,FlipClock.Lang["ar-ar"]=FlipClock.Lang.Arabic,FlipClock.Lang.arabic=FlipClock.Lang.Arabic}(jQuery),function($){FlipClock.Lang.Danish={years:"År",months:"Måneder",days:"Dage",hours:"Timer",minutes:"Minutter",seconds:"Sekunder"},FlipClock.Lang.da=FlipClock.Lang.Danish,FlipClock.Lang["da-dk"]=FlipClock.Lang.Danish,FlipClock.Lang.danish=FlipClock.Lang.Danish}(jQuery),function($){FlipClock.Lang.German={years:"Jahre",months:"Monate",days:"Tage",hours:"Stunden",minutes:"Minuten",seconds:"Sekunden"},FlipClock.Lang.de=FlipClock.Lang.German,FlipClock.Lang["de-de"]=FlipClock.Lang.German,FlipClock.Lang.german=FlipClock.Lang.German}(jQuery),function($){FlipClock.Lang.English={years:"Years",months:"Months",days:"Days",hours:"Hours",minutes:"Minutes",seconds:"Seconds"},FlipClock.Lang.en=FlipClock.Lang.English,FlipClock.Lang["en-us"]=FlipClock.Lang.English,FlipClock.Lang.english=FlipClock.Lang.English}(jQuery),function($){FlipClock.Lang.Spanish={years:"A&#241;os",months:"Meses",days:"D&#205;as",hours:"Horas",minutes:"Minutos",seconds:"Segundo"},FlipClock.Lang.es=FlipClock.Lang.Spanish,FlipClock.Lang["es-es"]=FlipClock.Lang.Spanish,FlipClock.Lang.spanish=FlipClock.Lang.Spanish}(jQuery),function($){FlipClock.Lang.Finnish={years:"Vuotta",months:"Kuukautta",days:"Päivää",hours:"Tuntia",minutes:"Minuuttia",seconds:"Sekuntia"},FlipClock.Lang.fi=FlipClock.Lang.Finnish,FlipClock.Lang["fi-fi"]=FlipClock.Lang.Finnish,FlipClock.Lang.finnish=FlipClock.Lang.Finnish}(jQuery),function($){FlipClock.Lang.French={years:"Ans",months:"Mois",days:"Jours",hours:"Heures",minutes:"Minutes",seconds:"Secondes"},FlipClock.Lang.fr=FlipClock.Lang.French,FlipClock.Lang["fr-ca"]=FlipClock.Lang.French,FlipClock.Lang.french=FlipClock.Lang.French}(jQuery),function($){FlipClock.Lang.Italian={years:"Anni",months:"Mesi",days:"Giorni",hours:"Ore",minutes:"Minuti",seconds:"Secondi"},FlipClock.Lang.it=FlipClock.Lang.Italian,FlipClock.Lang["it-it"]=FlipClock.Lang.Italian,FlipClock.Lang.italian=FlipClock.Lang.Italian}(jQuery),function($){FlipClock.Lang.Latvian={years:"Gadi",months:"Mēneši",days:"Dienas",hours:"Stundas",minutes:"Minūtes",seconds:"Sekundes"},FlipClock.Lang.lv=FlipClock.Lang.Latvian,FlipClock.Lang["lv-lv"]=FlipClock.Lang.Latvian,FlipClock.Lang.latvian=FlipClock.Lang.Latvian}(jQuery),function($){FlipClock.Lang.Dutch={years:"Jaren",months:"Maanden",days:"Dagen",hours:"Uren",minutes:"Minuten",seconds:"Seconden"},FlipClock.Lang.nl=FlipClock.Lang.Dutch,FlipClock.Lang["nl-be"]=FlipClock.Lang.Dutch,FlipClock.Lang.dutch=FlipClock.Lang.Dutch}(jQuery),function($){FlipClock.Lang.Norwegian={years:"År",months:"Måneder",days:"Dager",hours:"Timer",minutes:"Minutter",seconds:"Sekunder"},FlipClock.Lang.no=FlipClock.Lang.Norwegian,FlipClock.Lang.nb=FlipClock.Lang.Norwegian,FlipClock.Lang["no-nb"]=FlipClock.Lang.Norwegian,FlipClock.Lang.norwegian=FlipClock.Lang.Norwegian}(jQuery),function($){FlipClock.Lang.Portuguese={years:"Anos",months:"Meses",days:"Dias",hours:"Horas",minutes:"Minutos",seconds:"Segundos"},FlipClock.Lang.pt=FlipClock.Lang.Portuguese,FlipClock.Lang["pt-br"]=FlipClock.Lang.Portuguese,FlipClock.Lang.portuguese=FlipClock.Lang.Portuguese}(jQuery),function($){FlipClock.Lang.Russian={years:"лет",months:"месяцев",days:"дней",hours:"часов",minutes:"минут",seconds:"секунд"},FlipClock.Lang.ru=FlipClock.Lang.Russian,FlipClock.Lang["ru-ru"]=FlipClock.Lang.Russian,FlipClock.Lang.russian=FlipClock.Lang.Russian}(jQuery),function($){FlipClock.Lang.Swedish={years:"År",months:"Månader",days:"Dagar",hours:"Timmar",minutes:"Minuter",seconds:"Sekunder"},FlipClock.Lang.sv=FlipClock.Lang.Swedish,FlipClock.Lang["sv-se"]=FlipClock.Lang.Swedish,FlipClock.Lang.swedish=FlipClock.Lang.Swedish}(jQuery),function($){FlipClock.Lang.Chinese={years:"年",months:"月",days:"日",hours:"时",minutes:"分",seconds:"秒"},FlipClock.Lang.zh=FlipClock.Lang.Chinese,FlipClock.Lang["zh-cn"]=FlipClock.Lang.Chinese,FlipClock.Lang.chinese=FlipClock.Lang.Chinese}(jQuery);var piguApp=angular.module("piguApp",configData.modules);piguApp.constant("appConfig",configData),piguApp.run(function($rootScope,appConfig){angular.element(document).on("click",function(e){$rootScope.$broadcast("documentClicked",angular.element(e.target),e)}),appConfig.zIndex=90,$rootScope.appConfig=appConfig}),piguApp.config(function($httpProvider,$provide,$sceDelegateProvider,$compileProvider){$httpProvider.defaults.transformRequest=function(data){return void 0===data?data:serializeData(data)},$provide.decorator("$browser",["$delegate",function($delegate){return $delegate.onUrlChange=function(){},$delegate.url=function(){return""},$delegate}]),$httpProvider.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded; charset=UTF-8",$sceDelegateProvider.resourceUrlWhitelist(["self","http://lt*.pigugroup.eu/**"]),$compileProvider.debugInfoEnabled(!1)}),piguApp.filter("trustAsHTML",["$sce",function($sce){return function(text){return $sce.trustAsHtml(text)}}]),piguApp.filter("sortList",function(){return function(text){return text.sort(naturalSort("title"))}});var isRetina=window.devicePixelRatio>1||window.matchMedia&&window.matchMedia("(-webkit-min-device-pixel-ratio: 1.5),(-moz-min-device-pixel-ratio: 1.5),(min-device-pixel-ratio: 1.5)").matches;piguApp.controller("PiguAppController",["$scope","$rootScope","appConfig",function($scope,$rootScope,appConfig){$scope.init=function(){$scope.prevUrl="",$scope.changePrevUrl=function(url){$scope.prevUrl=url}},$scope.preventDefault=function(e){e=e||angular.element("body")[0].event,e.preventDefault&&e.preventDefault(),e.returnValue=!1},$scope.scrollEventListener=function(e){e.preventDefault()},$scope.disableScroll=function(){angular.element(document.querySelector("html")).css("overflow","hidden"),angular.element(document.querySelector("html")).css("position","fixed")},$scope.enableScroll=function(){angular.element(document.querySelector("html")).css("overflow","auto"),angular.element(document.querySelector("html")).css("position","static")},$scope.changeLanguage=function(lang){window.location.href=appConfig.languages[lang].url}}]),piguApp.controller("BodyController",function($scope,$window,$timeout,$anchorScroll,$location,AjaxFactory,appConfig,$compile,location){$scope.showSearch=appConfig.searchMode,$scope.showCategories=!1,$scope.showMenu=!1,$scope.showPopup=!1,$scope.cartCount=0,this.vis=!0,$scope.sOpts={maxPosition:200,minPosition:0},$scope.subMenuBar=!1,$scope.currentCategory={},$scope.currentCategory.title="",$scope.currentCategory.image="",$scope.currentCategory.url="",$scope.menuBar=!1;var _this=this;History.Adapter.bind(window,"statechange",function(){var State=History.getState(),url=State.url,states=History.savedStates,prevUrlIndex=states.length-2,prevUrl=states[prevUrlIndex].hash;-1==url.indexOf("search_type")&&prevUrl.indexOf("search_type")>-1&&(_this.hideSearchLayer(),_this.searchWidget.resetSearch())}),this.showSearchLayer=function(){if($("search-layer").length){angular.element(document.querySelector("html")).css("overflow","hidden"),angular.element(document.querySelector("html")).css("position","fixed"),this.searchLayer.show(),angular.isDefined(this.searchWidget)&&this.searchWidget.onShow();var _this=this;$timeout(function(){appConfig.isIOS?document.searchWidgetForm.q.focus():_this.searchWidget.input.focus()},500)}else{var template="<search-layer></search-layer>",compiled=$compile(template)($scope);$("body").prepend(compiled)}},$scope.showSearchLayer=function(){_this.showSearchLayer()},this.hideSearchLayer=function(){angular.element(document.querySelector("html")).css("overflow","auto"),angular.element(document.querySelector("html")).css("position","static"),this.searchLayer.hide()},$scope.showMenuBar=function(){if($("common").length)$scope.menuBar=!$scope.menuBar,$scope.menuBar?(angular.element(document.querySelector("#menuOverlay")).addClass("active"),angular.element(document.querySelector("app-menu")).addClass("active"),$scope.disableScroll()):(angular.element(document.querySelector("#menuOverlay")).removeClass("active"),angular.element(document.querySelector("app-menu")).removeClass("active"),$scope.subMenuBar=!1,$scope.enableScroll());else{$compile("<common></common>")($scope).insertAfter("#top")}},$scope.forceShowMenuBar=function(){$scope.menuBar=!0,angular.element(document.querySelector("#menuOverlay")).addClass("active"),angular.element(document.querySelector("app-menu")).addClass("active"),$scope.disableScroll()},this.forceHideMenuBar=function(){$scope.menuBar=!1,$scope.subMenuBar=!1,angular.element(document.querySelector("#menuOverlay")).removeClass("active"),angular.element(document.querySelector("app-menu")).removeClass("active"),$scope.enableScroll()},$scope.$on("initForceMenu",function(event){$scope.forceShowMenuBar()}),$scope.showBar=function(event){var target=event.target;if("undefined"==typeof jQuery||!angular.element(target).is(".slider-pigu")&&!angular.element(target).parents(".slider-pigu").length>0&&!angular.element(target).is("#lg-outer")&&!angular.element(target).parents("#lg-outer").length>0&&!angular.element(target).is(".product-list-slide")&&!angular.element(target).parents(".product-list-slide").length>0&&!angular.element(target).is(".price-slider")&&!angular.element(target).parents(".price-slider").length>0)if($("common").length)$scope.menuBar=!0,angular.element(document.querySelector("#menuOverlay")).addClass("active"),angular.element(document.querySelector("app-menu")).addClass("active"),$scope.disableScroll();else{var template="<common></common>",compiled=$compile(template)($scope);compiled.insertAfter("#top")}},$scope.hideBar=function(){$scope.menuBar=!1,$scope.subMenuBar=!1,angular.element(document.querySelector("#menuOverlay")).removeClass("active"),angular.element(document.querySelector("app-menu")).removeClass("active"),$scope.enableScroll()},$scope.showSubMenuBar=function(id){$scope.subMenuBar=!$scope.subMenuBar,$scope.subMenuBar?(angular.element(document.querySelector(".sub-menu-bar")).addClass("active"),$scope.setCurrentCategory($scope.menuCategories[id])):angular.element(document.querySelector(".sub-menu-bar")).removeClass("active")},$scope.createSubCategories=function(categories){angular.element(document.querySelector("#subCategoryList")).html("");for(i in categories){var category=categories[i];angular.element(document.querySelector("#subCategoryList")).append('<a href="'+category.url+$scope.urlParameters+'" class="list-group-item">'+category.title+"</a>")}},$scope.setCurrentCategory=function(category){$scope.currentCategory.title=category.title,$scope.currentCategory.image=category.image,$scope.currentCategory.url=category.url,$scope.createSubCategories(category.subcategories)},$scope.toggleCategories=function(){$scope.showCategories=!$scope.showCategories},$scope.init=function(categories){$scope.menuCategories=categories,appConfig.urlParameters&&($scope.urlParameters=appConfig.urlParameters)},this.construct=function(categories){$scope.menuCategories=categories,appConfig.urlParameters&&($scope.urlParameters=appConfig.urlParameters)},this.toggleSearch=function(){appConfig.isNative?native.search():($scope.showSearch=!$scope.showSearch,$scope.showSearch&&$timeout(function(){document.getElementById("searchInput").click();var input=angular.element(document.querySelector("#searchInput"))[0];input.focus(),setTimeout(function(){input.value=input.value||"",input.focus()},500)},1))},$scope.backStep=function(){appConfig.isNative?window.native.back():window.history.back()},$scope.changeTitle=function(title){$scope.appConfig.headline.title=title},$scope.gotoAnchor=function(id){var element=angular.element(document.querySelector("md-content"))[0];void 0!==element&&(element.scrollTop=angular.element(document.querySelector("#"+id)).prop("offsetTop"))},$scope.initCartCount=function(cartCount){if(angular.isUndefined(cartCount)){AjaxFactory.post(appConfig.baseUrl+"cart/getCartCount",[]).then(function(data){data.success&&($scope.cartCount=data.cartCount,"undefined"!=typeof native&&void 0!==native.setCartCount&&native.setCartCount(data.cartCount))})}else $scope.cartCount=cartCount,"undefined"!=typeof native&&void 0!==native.setCartCount&&native.setCartCount(cartCount)},$scope.goBackLayer=function(history){$scope.$broadcast("initBackSubMenu",{history:history})}}),piguApp.controller("HomeCategoriesController",["$scope","$timeout",function($scope,$timeout){$scope.init=function(categories){$scope.categories=categories}}]),piguApp.controller("CategoriesController",["$scope","$timeout",function($scope,$timeout){$scope.init=function(categories){$scope.categories=categories}}]),piguApp.controller("SlideBannersController",function($scope){$scope.bannersResponsive=[{breakpoint:768,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0}},{breakpoint:600,settings:{slidesToShow:2,slidesToScroll:1,infinite:!0}},{breakpoint:480,settings:{slidesToShow:1,slidesToScroll:1}}],$scope.data={infinite:!1,speed:300}}),piguApp.controller("SlideBrandPageProduct",function($scope){$scope.sliderValue="",$scope.productResponsive=[{breakpoint:2162,settings:{slidesToShow:3}},{breakpoint:600,settings:{slidesToShow:1}},{breakpoint:480,settings:{slidesToShow:1}}],$scope.addItem=function(filterId,itemId,itemValue,type){$scope.sliderValue=itemValue}}),piguApp.controller("HeaderController",["$scope","appConfig",function($scope,appConfig){$scope.init=function(){$scope.initCartCount()},$scope.focusMeBaby=function(){angular.element(document.querySelector("#searchInput")).focus()},$scope.goBack=function(){appConfig.isNative?native.back():document.referrer.match("customer")&&appConfig.loggedIn?window.history.go(-2):window.history.back()}}]),piguApp.controller("SuggestionsController",["$scope","$http","$timeout","appConfig",function($scope,$http,$timeout,appConfig){$scope.searchValue=angular.fromJson(appConfig.searchValue),(angular.isUndefined($scope.searchValue)||null==$scope.searchValue)&&($scope.searchValue=""),$scope.iOS=/(iPad|iPhone|iPod)/g.test(navigator.userAgent),$scope.buttonType=$scope.iOS?"button":"submit",$scope.showRemove=""!=$scope.searchValue,$scope.toggleKeyPress=function(event){if(appConfig.snSuggestionsEnabled)if(angular.isDefined($scope.$parent.$ctrl)&&"searchWidget"==$scope.$parent.$ctrl.id){if($scope.$parent.$ctrl.searchValue.length<2)return!1;$http.get(appConfig.baseUrl+"products/sphinx_search/suggestions_sn?q="+$scope.$parent.$ctrl.searchValue+"&limit=4&products=true").success(function(data,status,headers,config){$scope.suggestions=data}).error(function(data,status,headers,config){$scope.status=status})}else{if($scope.showRemove=""!=$scope.searchValue,13==event.keyCode)return document.getElementById("submitSearchButton").click(),!1;if($scope.searchValue.length<2)return!1;$http.get($scope.appConfig.baseUrl+"products/sphinx_search/suggestions_sn?q="+$scope.searchValue+"&limit=4&products=true").success(function(data,status,headers,config){$scope.suggestions=data}).error(function(data,status,headers,config){$scope.status=status})}},$scope.selectSuggestion=function(suggestion){angular.isDefined($scope.$parent.$ctrl)&&"searchWidget"==$scope.$parent.$ctrl.id?($scope.$parent.$ctrl.searchValue=suggestion,$scope.suggestions=!1):($scope.searchValue=suggestion,$scope.suggestions=!1,$timeout(function(){document.getElementById("submitSearchButton").click()},50))},$scope.selectProduct=function(product){$scope.suggestions=!1,window.location=product.url},$scope.removeSearchText=function(){$scope.searchValue="",$scope.suggestions=!1},this.closeSuggestions=function(){$scope.suggestions=!1}}]),piguApp.controller("BaseViewController",function($scope,appConfig,AjaxFactory,$compile){this.infoPages=[],this.categoryId=0,this.viewsHistory=[],this.currentHistoryKey=0,this.construct=function(infoPages,bController){bController.navigationCtrl=this,this.infoPages=infoPages},this.showSubCategoriesMenu=function(id,level,title){var historyLength=this.viewsHistory.length;if(0==historyLength)var viewLayer=this.subMenuMain;else var viewLayer=this.subMenu;if(historyLength>1){var elementCopy=angular.copy(this.viewsHistory[this.currentHistoryKey].htmlContent);this.subMenuMain.setTitle(this.viewsHistory[this.currentHistoryKey].title),this.subMenuMain.setContent($compile(elementCopy)($scope)),this.subMenuMain.incrementZindex()}viewLayer.incrementZindex(),viewLayer.show("right"),viewLayer.addLoader(),viewLayer.setTitle(title);var request=AjaxFactory.get(appConfig.baseUrl+"home/getCategories?parent_id="+id),container=$('<div ng-controller="SubCategoriesController as SubCtrl"></div>'),_this=this;request.then(function(data){if(data){for(var i in data.items){var item=data.items[i];if(parseInt(item.lft)+1!=parseInt(item.rgt)&&1!=item.forceRedirect)var textLabel=$('<menu-row ng-click="navigationCtrl.showSubCategoriesMenu('+item.id+", '"+item.level+"', '"+item.title+'\')"><span class="icon-arrow-right pull-right"></span><image-text-label title="'+item.title+'" image-path="'+item.img_src+'"></image-text-label></menu-row>');else var textLabel=$('<menu-row><image-link-label href="'+appConfig.baseUrl+item.url.substring(1)+'" title="'+item.title+'" image-path="'+item.img_src+'"></image-link-label></menu-row>');textLabel.appendTo(container)}_this.currentHistoryKey=_this.setViewsHistory(angular.copy(container),id,title),angular.isDefined(level)&&level>=1?_this.setHistoryCookie(function(){viewLayer.removeLoader(),viewLayer.setContent($compile(container)($scope))}):(viewLayer.removeLoader(),viewLayer.setContent($compile(container)($scope)))}})},this.previousLayer=function(){var historyLength=this.viewsHistory.length;if(0==historyLength)var viewLayer=this.subMenuMain;else var viewLayer=this.subMenu;this.viewsHistory.splice(this.currentHistoryKey,1),this.currentHistoryKey-=1;var previousLayer=this.viewsHistory[this.currentHistoryKey];historyLength>1?(this.subMenuMain.setContent($compile(angular.copy(previousLayer.htmlContent))($scope)),this.subMenuMain.setTitle(previousLayer.title)):($scope.forceShowMenuBar(),this.subMenuMain.hide("right")),viewLayer.hide("right")},this.setViewsHistory=function(htmlContent,id,title){return this.viewsHistory.push({htmlContent:htmlContent,id:id,title:title}),this.viewsHistory.length-1},this.showSubMenu=function(action){"getCategories"==action&&this.showSubCategoriesMenu(0,0),"information"==action&&this.showInformationMenu()},this.showInformationMenu=function(type){var historyLength=this.viewsHistory.length;if(historyLength)var viewLayer=this.subMenu;else var viewLayer=this.subMenuMain;if(historyLength>1){var elementCopy=angular.copy(this.viewsHistory[this.currentHistoryKey].htmlContent);this.subMenuMain.setContent(elementCopy)}angular.isDefined(type)||(type="right"),viewLayer.show(type),viewLayer.addLoader();var container=$('<div ng-controller="SubCategoriesController as SubCtrl"></div>');for(var i in this.infoPages){var item=this.infoPages[i];$('<menu-row><image-link-label title="'+item.title+'" href="'+item.url+'?navigation_source=information"></image-link-label></menu-row>').appendTo(container)}viewLayer.removeLoader(),this.currentHistoryKey=this.setViewsHistory(angular.copy(container)),viewLayer.setContent($compile(container)($scope)),viewLayer.setTitle(appConfig.translates.information)},this.setHistoryCookie=function(callback){var historyIds={};for(var i in this.viewsHistory)historyIds[i]={},historyIds[i]=this.viewsHistory[i].id;AjaxFactory.post(appConfig.baseUrl+"home/setHistory",historyIds).then(function(data){angular.isDefined(data)&&"success"==data.status&&callback()})},this.recreateHistory=function(history){var request=AjaxFactory.post(appConfig.baseUrl+"home/getHistoryByIds",history),_this=this;_this.subMenu.show(),_this.subMenu.addLoader(),request.then(function(data){if(data){var newHistory=data.history;for(var step in newHistory){var steps=newHistory[step],container=$('<div ng-controller="SubCategoriesController as SubCtrl"></div>');for(var i in steps.categories){var item=steps.categories[i];if(parseInt(item.lft)+1!=parseInt(item.rgt))var textLabel=$('<menu-row ng-click="navigationCtrl.showSubCategoriesMenu('+item.id+", '"+item.level+"', '"+item.title+'\')"><span class="icon-arrow-right pull-right"></span><image-text-label title="'+item.title+'" image-path="'+item.img_src+'"></image-text-label></menu-row>');else var textLabel=$('<menu-row><image-link-label href="'+appConfig.baseUrl+item.url.substring(1)+'" title="'+item.title+'" image-path="'+item.img_src+'"></image-link-label></menu-row>');textLabel.appendTo(container)}_this.currentHistoryKey=_this.setViewsHistory(angular.copy(container),item.parent_id,steps.title)}var currentLayer=_this.viewsHistory[_this.currentHistoryKey],previousLayer=_this.viewsHistory[_this.currentHistoryKey-1];_this.subMenu.removeLoader(),_this.subMenu.setTitle(currentLayer.title),_this.subMenu.setContent($compile(angular.copy(currentLayer.htmlContent))($scope)),_this.subMenuMain.setTitle(previousLayer.title),_this.subMenuMain.setContent($compile(angular.copy(previousLayer.htmlContent))($scope)),_this.subMenuMain.show()}})},this.backSubMenu=function(history){this.recreateHistory(history)};var _this=this;$scope.$on("initBackSubMenu",function(event,obj){_this.backSubMenu(obj.history)})}),piguApp.controller("SubCategoriesController",function($scope,appConfig,AjaxFactory,$compile){}),piguApp.controller("ProductsController",["$scope","$timeout","location","ProductsInfiniteLoader","FilterFactory","$compile","appConfig","$window",function($scope,$timeout,location,ProductsInfiniteLoader,FilterFactory,$compile,appConfig,$window){$scope.allProducts=[],$scope.infiniteProducts=[],$scope.infiniteIndex=0,$scope.howMany=6,$scope.currentPage=1,$scope.totalItems=0,$scope.pageSize=18,$scope.loadedPages=[],$scope.isLoading=!1,$scope.scrollingDirective="",$scope.lastScrollTop=0,$scope.totalPages=0,$scope.scrolledTimes=0,$scope.backButtonVisible=!1,$scope.moreButtonShow=!0,$scope.categoryId=0,$scope.pagesNotLoaded=[],$scope.startPage=0,$scope.alwaysLoad=0,$scope.requestUrl="",$scope.activeFilter=FilterFactory.activeFilter,$scope.showProducts=!0,$scope.showCategories=!1,$scope.scrollContainer=!1,$scope.showPromoClock=!1,$scope.showDiscountPromotion=!1,$scope.showDeliveryPromotion=!1,$scope.ShowCashbackPromotion=!1,$scope.init=function(data){angular.isDefined(data.scrollContainer)?$scope.scrollContainer=data.scrollContainer:$scope.scrollContainer=window,$scope.bindOnWindowScroll(),$scope.setDefaultVariables(data),ProductsInfiniteLoader.prototype.onPagesLoad=function(data){for(var page in data)$scope.loadedPages[parseInt(page)]=parseInt(page),$scope.parsePage(parseInt(page),data[parseInt(page)]);"undefined"!=typeof ga&&ga("send","pageview")},$scope.loader=new ProductsInfiniteLoader,$(document.body).on("appear",".page-container",function(e,$affected){$scope.appearOnWindow($(this).attr("page-number"))}),$scope.alwaysLoad?$("#moreButtonInfinite").css("display","none"):$scope.showHideMoreButton()},$scope.showHideBackPage=function(){var page=getLastSmallerValue($scope.loadedPages,$scope.currentPage),loadedPages=$scope.loadedPages;if($scope.backPage=$scope.currentPage-1,1==getMinValue(loadedPages))return $("#prevButtonInfinite").css("display","none"),!1;page<2&&1==$scope.currentPage?($("#prevButtonInfinite").css("display","none"),$scope.backButtonVisible=!1):($("#prevButtonInfinite").css("display","block"),$scope.backButtonVisible=!0)},$scope.parsePage=function(pageNumber,products){$("#lastPage").before('<span style="display: inline;" class="page-number" page-number="'+pageNumber+'" id="page'+pageNumber+'"></span>'),$("#lastPage").before('<span style="display: inline;" id="page'+pageNumber+'Container" page-number="'+pageNumber+'" class="page-container"></span>'),$("#lastPage").before('<span style="display: inline;"  id="page'+pageNumber+'End"></span>'),$scope["page"+pageNumber]=products,$compile('<product bindonce ng-repeat-start="product in page'+pageNumber+' track by $index" class="col-xs-6 box-grid product"></product><div ng-repeat-end="alertMyEnd()"></div>')($scope).appendTo("#page"+pageNumber+"Container"),$("#page"+pageNumber+"Container").appear()},$scope.onLastLoaded=function(){$scope.isLoading=!1},$scope.setTotalPages=function(){$scope.totalPages=parseInt($scope.totalItems/$scope.pageSize,10),0!=$scope.totalItems/$scope.pageSize-$scope.totalPages&&($scope.totalPages+=1)},$scope.appearOnWindow=function(page){$scope.currentPage=parseInt(page);var pageUrlParam="page";void 0!==location.getParameterByName("search_type")&&"layer"==location.getParameterByName("search_type")&&(pageUrlParam="search_page");var url=location.addParamToUrlString(window.location.href.toString(),pageUrlParam,$scope.currentPage);url=url.replace("http://",appConfig.proto+"://"),history.replaceState(null,null,url)},$scope.setDefaultVariables=function(data){$scope.loadedPages[data.currentPage]=data.currentPage,$scope.totalItems=data.totalItems,$scope.currentPage=data.currentPage,$scope.startPage=$scope.currentPage,$scope.alwaysLoad=data.alwaysLoad,$scope.pagesNotLoaded=halfwayBetweenTwoNumbers($scope.currentPage,1),$scope.requestUrl=data.requestUrl;var removeIndex=$scope.pagesNotLoaded.indexOf($scope.currentPage);$scope.pagesNotLoaded.splice(removeIndex,1),$scope.categoryId=data.categoryId,$scope.setTotalPages(),$("#page"+$scope.currentPage+"Container").appear()},$scope.getFirstNotLoadedPage=function(){var first=$scope.pagesNotLoaded[0];return $scope.pagesNotLoaded.splice(0,1),first},$scope.bindOnWindowScroll=function(){$($scope.scrollContainer).scroll(function(event){var st=$(this).scrollTop();st>$scope.lastScrollTop?$scope.scrollingDirective="down":$scope.scrollingDirective="up",$scope.lastScrollTop=st})},$scope.loadNextPage=function(){if(!$scope.isLoading){$scope.isLoading=!0;var page=$scope.currentPage+1;$scope.pagesNotLoaded.length&&(page=$scope.getFirstNotLoadedPage()),page>$scope.totalPages||($scope.scrolledTimes++,$scope.changePage(page))}},$scope.moreItems=function(){$scope.scrolledTimes=-1,$scope.loadNextPage()},$scope.showHideMoreButton=function(){getObjectArrayLength($scope.loadedPages)+1>=$scope.totalPages?($("#moreButtonInfinite").css("display","none"),$scope.moreButtonShow=!1):($("#moreButtonInfinite").css("display","block"),$scope.moreButtonShow=!0)},$scope.loadPreviousPage=function(){if(!$scope.isLoading){$scope.isLoading=!0;var page=this.currentPage-1;$scope.changePage(page)}},$scope.scrollCheck=function(){$scope.isLoading||"down"==$scope.scrollingDirective&&getObjectArrayLength($scope.loadedPages)<$scope.totalPages&&($scope.alwaysLoad||0==$scope.alwaysLoad&&$scope.scrolledTimes<3)&&$scope.loadNextPage()},$scope.changePage=function(page){$scope.isLoading=!0;var pages=[];void 0!==$scope.loadedPages[page]&&$scope.startPage==page&&(page+=1),pages.push(page),pages=arrayDiffByFirstKey($scope.loadedPages,pages),$scope.currentPage=page,$scope.alwaysLoad||$scope.showHideMoreButton();var pageUrlParam="page";void 0!==location.getParameterByName("search_type")&&"layer"==location.getParameterByName("search_type")&&(pageUrlParam="search_page");var url=location.addParamToUrlString(window.location.href.toString(),pageUrlParam,$scope.currentPage),locationSearch=window.location.search.toString();pageUrlParam&&(locationSearch=locationSearch.replace(/search_c/gi,"c"),locationSearch.replace(/search_filter/gi,"filter"));var xhrUrl=appConfig.baseUrl+$scope.requestUrl+locationSearch;$scope.loader.setUrl(xhrUrl),pages.length&&$scope.loader.loadPages(pages,$scope.pageSize),history.replaceState(null,null,url),pages.length||($scope.isLoading=!1)},$scope.changeOnClick=function(page){if(!$scope.isLoading){var url=location.addParamToUrlString(window.location.href.toString(),"page",page);url=url.replace("http://",appConfig.proto+"://"),window.location.href=url}},$scope.scrollToPage=function(page,px){void 0===px&&(px=0);var element=$("#page"+page);element.length&&$("body").animate({scrollTop:element.offset().top-parseInt($("#top").css("padding-top").replace("px",""))-px},"fast")},$scope.wrapOnChange=function(id){var url=location.addParamToUrlString(window.location.href.toString(),"w",id),pageUrlParam="page";void 0!==location.getParameterByName("search_type")&&"layer"==location.getParameterByName("search_type")&&(pageUrlParam="search_page"),url=location.removeParamFromUrlString(url,pageUrlParam),window.location=url},$scope.orderByOnChange=function(id){if(angular.isDefined($scope.$parent.$ctrl)&&"searchWidget"==$scope.$parent.$ctrl.id)$scope.$parent.$ctrl.changeOrderBy(id);else{var url=location.addParamToUrlString(window.location.href.toString(),"ob",id),pageUrlParam="page";void 0!==location.getParameterByName("search_type")&&"layer"==location.getParameterByName("search_type")&&(pageUrlParam="search_page"),url=location.removeParamFromUrlString(url,pageUrlParam),window.location=url}},$scope.clearParamsOnClick=function(){var url=window.location.protocol+"//"+window.location.host+window.location.pathname;window.location=url},$scope.toggleFilter=function(event){event.preventDefault(),event.stopPropagation();var newShowFilter=!FilterFactory.showFilter;if(FilterFactory.setShowFilter(newShowFilter),FilterFactory.showFilter){$("#searchContentPane").css("overflow","visible");var windowHeight=angular.element($window).height(),headerHeight=angular.element(document.querySelector("#filter-header")).outerHeight(),filterButtonHeight=44,contentHeight=windowHeight-headerHeight-filterButtonHeight;angular.element(document.querySelector("html")).css("overflow","hidden"),angular.element(document.querySelector("html")).css("position","fixed"),$timeout(function(){angular.element(document.querySelector(".filter-content-pane")).css("height",contentHeight+"px")},200)}else $("#searchContentPane").css("overflow","auto"),angular.element(document.querySelector("html")).css("overflow","auto"),angular.element(document.querySelector("html")).css("position","static")},$scope.openProducts=function(){$scope.showProducts=!0,$scope.showCategories=!1,$window.scrollTo(0,0)},$scope.openCategories=function(){$scope.showProducts=!1,$scope.showCategories=!0,$window.scrollTo(0,0)},$scope.$watch(function(){return FilterFactory.activeFilter},function(newVal){$scope.activeFilter=newVal},!0)}]),piguApp.controller("ProductController",["$scope","$http","ProductFactory","AjaxFactory","appConfig","$compile","location",function($scope,$http,ProductFactory,AjaxFactory,appConfig,$compile,location){$scope.init=function(product,modification,productObjectArray){if($scope.shareUrl=window.location.href,$scope.noCookie=!1,$scope.product=product,$scope.colors=productObjectArray,$scope.additionalPromoText="",$scope.showFoundCheaperPopup=!1,$scope.foundCheaper={url:"",email:"",phone:"",rules:""},$scope.foundCheaperErrors=[],$scope.foundCheaperShowSuccess=!1,$scope.countdownPromoBlock="",$scope.showSecondDrop=!1,"active"==product.status&&angular.isDefined(modification.id)){$scope.initModification(modification),$scope.dropdownColors=ProductFactory.createDropdownArray($scope.colors,"title"),$scope.showDropdownColors=0,1==Object.keys($scope.dropdownColors).length&&""!=$scope.dropdownColors[$scope.defaultColorId]?$scope.showDropdownColors=1:Object.keys($scope.dropdownColors).length>1&&""!=$scope.dropdownColors[$scope.defaultColorId]&&($scope.showDropdownColors=2),$scope.modifications=productObjectArray[modification.colour_id].modifications,$scope.dropdownModifications=ProductFactory.createDropdownArray($scope.modifications,"title"),$scope.showDropdownModifications=0,1==Object.keys($scope.dropdownModifications).length&&""!=$scope.modifications[$scope.currentModification.id].title?$scope.showDropdownModifications=1:Object.keys($scope.dropdownModifications).length>1&&($scope.showDropdownModifications=2),$scope.showSecondDrop=$scope.showDropdownModifications>0&&$scope.showDropdownColors>0;var defaultImgPath=$scope.colors[$scope.defaultColorId].images[0].photo_url+"_big.jpg"}else{var firstColor;for(firstColor in $scope.colors)break;var defaultImgPath=$scope.colors[firstColor].images[0].photo_url+"_big.jpg"}navigator.cookieEnabled||($scope.noCookie=!0),angular.element(document.querySelector("#defaultImage img")).attr("src",defaultImgPath)},$scope.changeColor=function(id){$scope.defaultColorId=id,$scope.modifications=$scope.colors[id].modifications,$scope.dropdownModifications=ProductFactory.createDropdownArray($scope.modifications,"title"),$scope.initModification($scope.modifications[ProductFactory.sortModifications($scope.modifications)[0]]),$scope.changeGallery($scope.colors[id].images,id)},$scope.changeModification=function(id){$scope.initModification($scope.modifications[id]),ProductFactory.changeModificationIdinUrl(id),$scope.shareUrl=window.location.href},$scope.initModification=function(modification){ProductFactory.initPrice(modification),$scope.changePrice(),$scope.currentModification=modification,$scope.defaultColorId=$scope.currentModification.colour_id,ProductFactory.changeModificationIdinUrl($scope.currentModification.id),$scope.isReadyGuarantee=$scope.currentModification.isReadyGuarantee,$scope.isChristmasReadyGuarantee=$scope.currentModification.isChristmasReadyGuarantee,$scope.isReadyGuaranteeEvening=$scope.currentModification.isReadyGuaranteeEvening,$scope.isFreeUnloadService=$scope.currentModification.isFreeUnloadService,$scope.hasBestPrize=$scope.currentModification.hasBestPrize,$scope.productWeight=$scope.currentModification.weight,$scope.additionalPromoInfo=$scope.currentModification.additionalPromoInfo,$scope.specialDelivery=$scope.currentModification.specialDelivery,$scope.showInOfficeLabel=modification.productLabels&&modification.productLabels.inVlnPac,$scope.setPromoSellTill(),$scope.setRating(modification),$scope.additionalServiceAvailable=$scope.currentModification.additional_services},$scope.setRating=function(modification){var block=document.getElementById("ratingsBlock");block&&(block.innerHTML="",modification.ratingBlock&&(block.innerHTML=modification.ratingBlock))},$scope.changeGallery=function(galleryImages,id){var url=location.addParamToUrlString(window.location.href.toString(),"color_id",id),aDom=$('<div id="photosSlideContainer"></div>'),slickSlider=$('<slick slide="a" autoplay="true" autoplay-speed="3000" lazy-load="ondemand" variableWidth="true" infinite="true" dots="true" class="slider-pigu product-photo-slick" speed="300" slides-to-show="1" arrows="false"></slick>').appendTo(aDom);for(var i in galleryImages){var image=galleryImages[i];url=url+"#photo_"+url+"'#photo_"+image.id;var imageContainer=$('<a href="'+url+'" class="img-margin product-photo-container-slick"></a>');$('<img ng-src="'+image.photo_url+'_xbig.jpg" alt="" class="img-responsive">').appendTo(imageContainer);imageContainer.appendTo(slickSlider)}var el=$compile(aDom)($scope);$("#photosSlideContainer").replaceWith(el)},$scope.changePrice=function(){var productInfo=ProductFactory.getProduct();$scope.holdingPrice=productInfo.holdingPrice,$scope.sellPrice=productInfo.sellPrice,$scope.normalPrice=productInfo.normalPrice,$scope.leftString=productInfo.leftString,$scope.showOldPriceInfo=productInfo.showOldPriceInfo,$scope.priceExplain=productInfo.priceExplain},$scope.setPromoSellTill=function(){$scope.countdownPromoBlock=$scope.currentModification.countdownPromoBlock},$scope.shareAction=function(message){"undefined"!=typeof native&&void 0!==native.share?native.share(window.location.href):prompt(message,window.location.href)},$scope.postProductToCart=function(tokenName,tokenValue){var subscribeForm=void 0!==angular.element(document.querySelector("#subscribeForm")).val()&&angular.element(document.querySelector("#subscribeForm")).val(),postData={a:1,h:$scope.currentModification.modificationHash,m:$scope.currentModification.id,s:subscribeForm,t:"product",v:$scope.currentModification.vendor_id,insurance:$scope.currentModification.insurance,iHash:$scope.currentModification.insuranceHash,warranty:$scope.currentModification.warranty,wHash:$scope.currentModification.warrantyHash,additionalServices:$scope.currentModification.additionalServices};postData[tokenName]=tokenValue,AjaxFactory.post(appConfig.baseUrl+"cart/push",postData).then(function(data){if(data.success){if($scope.initCartCount(parseInt(data.cartCount)),data.additionalPromoRules&&($scope.additionalPromoText=data.additionalPromoRulesTemplate),appConfig.isNative&&void 0!==data.batchInfo){0==appConfig.loggedIn&&setNativeBacthUserParam("setIdentifier","uc_"+data.batchInfo.uc_id),setNativeBacthUserAttribute("setAttributeInteger","items_in_cart",parseInt(data.batchInfo.uc_count)),setNativeBacthUserAttribute("setAttributeFloat","items_in_cart_value",parseFloat(data.batchInfo.uc_price));var createKey="cart_create_date",updateKey="cart_updated";if(appConfig.isIOS){var m=moment(data.batchInfo.uc_created),formattedCreatedDate=m.format("YYYY-MM-DDTHH:mm:ss"),createdAt=new Date(formattedCreatedDate),m=moment(data.batchInfo.uc_updated),formattedUpdatedDate=m.format("YYYY-MM-DDTHH:mm:ss"),updatedAt=new Date(formattedUpdatedDate);createKey="ios_"+createKey,updateKey="ios_"+updateKey}else var createdAt=new Date(data.batchInfo.uc_created),updatedAt=new Date(data.batchInfo.uc_updated);nativeBatchUser.setAttributeDate(createKey,createdAt.toString()),"0000-00-00 00:00:00"!=data.batchInfo.uc_updated&&null!=data.batchInfo.uc_updated&&nativeBatchUser.setAttributeDate(updateKey,updatedAt.toString())}}else angular.isUndefined(data.error)||($scope.showErrorDialog=!0)})},$scope.renewPromoText=function(message){$scope.additionalPromoText=message},$scope.postToCartUniversal=function(tokenName,tokenValue,modificationId,modificationHash,vendorId){var postData={a:1,h:modificationHash,m:modificationId,s:!1,t:"product",v:vendorId};postData[tokenName]=tokenValue,AjaxFactory.post(appConfig.baseUrl+"cart/push",postData).then(function(data){if(data.success){if($scope.initCartCount(parseInt(data.cartCount)),appConfig.isNative&&void 0!==data.batchInfo){0==appConfig.loggedIn&&setNativeBacthUserParam("setIdentifier","uc_"+data.batchInfo.uc_id),setNativeBacthUserAttribute("setAttributeInteger","items_in_cart",parseInt(data.batchInfo.uc_count)),setNativeBacthUserAttribute("setAttributeFloat","items_in_cart_value",parseFloat(data.batchInfo.uc_price));var createdAt=new Date(data.batchInfo.uc_created),updatedAt=new Date(data.batchInfo.uc_updated);setNativeBacthUserAttribute("setAttributeDate","cart_create_date",createdAt.toString()),setNativeBacthUserAttribute("setAttributeDate","cart_updated",updatedAt.toString())}}else angular.isUndefined(data.error)||($scope.showErrorPopup=!0)})},$scope.foundCheaperMessage=function(){var postData=$scope.foundCheaper;postData.productId=$scope.currentModification.product_id,AjaxFactory.post(appConfig.baseUrl+"misc/cheaper/validateForm/",postData).then(function(data){1==data?($scope.foundCheaper={url:"",email:"",phone:"",rules:""},$scope.foundCheaperShowSuccess=!0):$scope.foundCheaperErrors=data})}}]),piguApp.controller("BadgesController",["$scope",function($scope){$scope.init=function(badges){$scope.$watch("currentModification",function(){var currentBadges=badges[$scope.currentModification.id],newBadges=[],i=0;angular.forEach(currentBadges,function(value){newBadges[i]=[],newBadges[i].class=value.class,newBadges[i].label_class=value.label_class,angular.isDefined(value.content)||(value.content=""),newBadges[i].mobileText=value.mobileText,newBadges[i].color=value.color,newBadges[i].title=value.title,newBadges[i].priority=value.priority,i++},newBadges),$scope.badges=newBadges})}}]),piguApp.controller("PhotoGallery",function(ProductFactory){this.init=function(galleryImages,galleryVideos){ProductFactory.initGallery(galleryImages,galleryVideos)},this.openGallery=function(){ProductFactory.openGallery()}}),piguApp.controller("FilterController",["$scope","$window","location","FilterFactory",function($scope,$window,location,FilterFactory){$scope.init=function(activeItems){$scope.showFilter=FilterFactory.showFilter,$scope.style="",$scope.activeItems=[],$scope.url=window.location.href.toString(),$scope.setFilterHeight(),$scope.setContentHeight(),angular.element(document.querySelector("body")).addClass("isFilterBody"),angular.element($window).bind("resize",function(){$scope.setContentHeight()}),angular.forEach(activeItems,function(filter){angular.forEach(filter.items,function(item){$scope.addItem(filter.filter_id,item.id,item.value,item.type)})});var activeFilter=!!location.searchParameter($scope.url,"f");FilterFactory.setActiveFilter(activeFilter)},$scope.setFilterHeight=function(){var style=$window.innerHeight-94;$scope.style="height: "+style+"px;"},$scope.setContentHeight=function(){var windowHeight=angular.element($window).height(),headerHeight=angular.element(document.querySelector("#filter-header")).outerHeight(),filterButtonHeight=angular.element(document.querySelector("#filter-button")).outerHeight(),contentHeight=windowHeight-headerHeight-filterButtonHeight;angular.element(document.querySelector(".filter-content-pane")).css("height",contentHeight+"px")},$scope.toggleFilterItem=function(filterId,item){angular.isUndefined($scope.activeItems[filterId])||angular.isUndefined($scope.activeItems[filterId][item.id])?$scope.addItem(filterId,item.id,item.value,item.type):$scope.removeItem(filterId,item.id,item.type);var activeFilter=!!location.searchParameter($scope.url,"f");FilterFactory.setActiveFilter(activeFilter)},$scope.addItem=function(filterId,itemId,itemValue,type){angular.isUndefined($scope.activeItems[filterId])&&($scope.activeItems[filterId]=[]),$scope.url="bool"==type?location.addParamToUrlString($scope.url,"f[bool]["+filterId+"]["+itemId+"]",itemValue):location.addParamToUrlString($scope.url,"f["+filterId+"]["+itemId+"]",itemValue),$scope.url=location.removeParamFromUrlString($scope.url,"page"),$scope.activeItems[filterId][itemId]=itemValue},$scope.removeItem=function(filterId,itemId,type){$scope.url="bool"==type?location.removeParamFromUrlString($scope.url,"f[bool]["+filterId+"]["+itemId+"]"):location.removeParamFromUrlString($scope.url,"f["+filterId+"]["+itemId+"]"),angular.isDefined($scope.activeItems[filterId])&&delete $scope.activeItems[filterId][itemId]},$scope.resetFilter=function(){for(i in $scope.activeItems){var items=$scope.activeItems[i];for(n in items)$scope.url=location.removeParamFromUrlString($scope.url,"f["+i+"]["+n+"]"),$scope.url=location.removeParamFromUrlString($scope.url,"f[bool]["+i+"]["+n+"]")}window.location=$scope.url},$scope.submit=function(){window.location=$scope.url},$scope.isActiveFilterItem=function(filterId,itemId){var isActive=!1;return angular.isDefined($scope.activeItems[filterId])&&angular.isDefined($scope.activeItems[filterId][itemId])&&(isActive=!0),isActive},$scope.toggleFilter=function(){var newShowFilter=!FilterFactory.showFilter;FilterFactory.setShowFilter(newShowFilter),FilterFactory.showFilter?(angular.element(document.querySelector("html")).css("position","fixed"),angular.element(document.querySelector("body")).css("overflow","hidden")):(angular.element(document.querySelector("html")).css("overflow","auto"),angular.element(document.querySelector("html")).css("position","static"))},$scope.$watch(function(){return FilterFactory.showFilter},function(newVal){$scope.showFilter=newVal},!0)}]),piguApp.controller("CategoryFilterController",["$scope","$window","location","FilterFactory",function($scope,$window,location,FilterFactory){$scope.init=function(){$scope.showFilter=FilterFactory.showFilter,$scope.style="",$scope.url=window.location.href.toString(),$scope.setFilterHeight(),angular.element($window).bind("resize",function(){$scope.setFilterHeight(),$scope.$apply()}),angular.element(document.querySelector("body")).addClass("isFilterBody");var activeFilter=!!location.searchParameter($scope.url,"c");FilterFactory.setActiveFilter(activeFilter)},$scope.setFilterHeight=function(){var style=$window.innerHeight-50;$scope.style="height: "+style+"px;"},$scope.toggleFilter=function(){var newShowFilter=!FilterFactory.showFilter;FilterFactory.setShowFilter(newShowFilter),FilterFactory.showFilter?(angular.element(document.querySelector("html")).css("position","fixed"),angular.element(document.querySelector("body")).css("overflow","hidden")):(angular.element(document.querySelector("html")).css("overflow","auto"),angular.element(document.querySelector("html")).css("position","static"))},$scope.$watch(function(){return FilterFactory.showFilter},function(newVal){$scope.showFilter=newVal},!0),$scope.resetFilter=function(){$scope.url=location.removeParamFromUrlString($scope.url,"c"),$window.location=$scope.url;var activeFilter=!!location.searchParameter($scope.url,"c");FilterFactory.setActiveFilter(activeFilter)},$scope.changeCategory=function(id){$scope.url=location.removeParamFromUrlString($scope.url,"c"),$scope.url=location.addParamToUrlString($scope.url,"c",id),$window.location=$scope.url;var activeFilter=!!location.searchParameter($scope.url,"c");FilterFactory.setActiveFilter(activeFilter)}}]),piguApp.controller("SearchFilterController",["$scope","$window","location","FilterFactory",function($scope,$window,location,FilterFactory){$scope.init=function(){$scope.showFilter=FilterFactory.showFilter,$scope.style="",$scope.url=window.location.href.toString(),$scope.setFilterHeight(),$scope.activeItems=[],$scope.setContentHeight(),angular.element(document.querySelector("body")).addClass("isFilterBody"),angular.element($window).bind("resize",function(){$scope.setContentHeight()}),angular.element($window).bind("resize",function(){$scope.setFilterHeight(),$scope.$apply()});var activeFilter=!!location.searchParameter($scope.url,"filter");FilterFactory.setActiveFilter(activeFilter),0==activeFilter&&(activeFilter=!!location.searchParameter($scope.url,"c"),FilterFactory.setActiveFilter(activeFilter))},$scope.setContentHeight=function(){var windowHeight=angular.element($window).height(),headerHeight=angular.element(document.querySelector("#filter-header")).outerHeight(),contentHeight=windowHeight-headerHeight;$(".filter-content-pane").css("height",contentHeight+"px")},$scope.setFilterHeight=function(){var style=$window.innerHeight-48;$scope.style="height: "+style+"px;"},$scope.toggleFilter=function(){var newShowFilter=!FilterFactory.showFilter;FilterFactory.setShowFilter(newShowFilter),FilterFactory.showFilter?($("#searchContentPane").css("overflow","visible"),angular.element(document.querySelector("html")).css("overflow","hidden"),angular.element(document.querySelector("html")).css("position","fixed")):($("#searchContentPane").css("overflow","auto"),angular.element(document.querySelector("html")).css("overflow","auto"),angular.element(document.querySelector("html")).css("position","static"))},$scope.toggleFilterItem=function(filterId,name,value){if("checked"==document.getElementById(filterId).getAttribute("checked")?(document.getElementById(filterId).removeAttribute("checked"),document.getElementById("label_"+filterId).classList.remove("active")):(document.getElementById(filterId).setAttribute("checked","checked"),document.getElementById("label_"+filterId).classList.add("active")),angular.isDefined($scope.$parent.$ctrl)&&"searchWidget"==$scope.$parent.$ctrl.id){$scope.$parent.$ctrl.toggleFilterParam(filterId,name,value);var newShowFilter=!FilterFactory.showFilter;FilterFactory.setShowFilter(newShowFilter),angular.element(document.querySelector("#searchContentPane")).css("overflow","auto")}else{document.getElementById("catalog_form").submit();var activeFilter=!!location.searchParameter($scope.url,"filter");FilterFactory.setActiveFilter(activeFilter),0==activeFilter&&(activeFilter=!!location.searchParameter($scope.url,"c"),FilterFactory.setActiveFilter(activeFilter))}},$scope.resetFilter=function(){var elements=document.getElementsByClassName("search-filter-item");angular.forEach(elements,function(value){value.removeAttribute("checked");var id=value.getAttribute("id");document.getElementById("label_"+id).classList.remove("active")}),document.getElementById("catalog_form").submit();var activeFilter=!!location.searchParameter($scope.url,"filter");FilterFactory.setActiveFilter(activeFilter),0==activeFilter&&(activeFilter=!!location.searchParameter($scope.url,"c"),FilterFactory.setActiveFilter(activeFilter))},$scope.isActiveFilterItem=function(isActiveItem){var isActive=!1;return 1==isActiveItem&&(isActive=!0),isActive},$scope.$watch(function(){return FilterFactory.showFilter},function(newVal){$scope.showFilter=newVal,$scope.showFilter&&$scope.setContentHeight()},!0)}]),piguApp.controller("ChristmasFilterController",["$scope","$window","location","FilterFactory","EncryptionFactory",function($scope,$window,location,FilterFactory,$encryptionFactory){$scope.init=function(params){$scope.sliderObject=null,$scope.sliderModel=params,$scope.minPriceInput=angular.element("#min-slider-price"),$scope.maxPriceInput=angular.element("#max-slider-price"),$scope.sliderValueInput=angular.element("#ion-slider-value"),$scope.minPriceInput=null==params.sliderValues?"":params.sliderValues[0],$scope.maxPriceInput=null==params.sliderValues?"":params.sliderValues[1],$scope.sliderLoaded=!1,$scope.allowAddingUrlParam=!0,$scope.showFilter=FilterFactory.showFilter,$scope.style="",$scope.url=window.location.href.toString(),$scope.setFilterHeight(),angular.element($window).bind("resize",function(){$scope.setFilterHeight(),$scope.$apply()}),angular.element(document.querySelector("body")).addClass("isFilterBody");var activeFilter=!(!location.searchParameter($scope.url,"c")&&!location.searchParameter($scope.url,"price"));FilterFactory.setActiveFilter(activeFilter),$scope.activeCategory=location.searchParameter($scope.url,"c")},$scope.setFilterHeight=function(){var style=$window.innerHeight-50;$scope.style="height: "+style+"px;"},$scope.toggleFilter=function(){var newShowFilter=!FilterFactory.showFilter;FilterFactory.setShowFilter(newShowFilter),FilterFactory.showFilter?(angular.element(document.querySelector("html")).css("position","fixed"),angular.element(document.querySelector("body")).css("overflow","hidden")):(angular.element(document.querySelector("html")).css("overflow","auto"),angular.element(document.querySelector("html")).css("position","static"))},$scope.$watch(function(){return FilterFactory.showFilter},function(newVal){$scope.showFilter=newVal},!0),$scope.resetFilter=function(){$scope.url=location.removeParamFromUrlString($scope.url,"c"),$scope.url=location.removeParamFromUrlString($scope.url,"price"),$window.location=$scope.url,FilterFactory.setActiveFilter(!1),$scope.activeCategory=0},$scope.changeCategory=function(id){$scope.url=location.removeParamFromUrlString($scope.url,"c"),$scope.url=location.addParamToUrlString($scope.url,"c",id),$scope.activeCategory=id},$scope.submit=function(){$window.location=$scope.url},$scope.prepareSliderData=function(){if($scope.sliderLoaded){var minPrice=""==$scope.minPriceInput?$scope.sliderModel.min:$scope.minPriceInput,maxPrice=""==$scope.maxPriceInput?$scope.sliderModel.max:$scope.maxPriceInput,pricesArray=[minPrice,maxPrice,"slider-price"];$scope.sliderValueInput=$encryptionFactory.base64Encode(JSON.stringify(pricesArray)).split("").reverse().join(""),$scope.allowAddingUrlParam?($scope.url=location.removeParamFromUrlString($scope.url,"price"),$scope.url=location.addParamToUrlString($scope.url,"price",$scope.sliderValueInput)):$scope.allowAddingUrlParam=!0}},$scope.$watch("minPriceInput",function(newValue,oldValue){isNaN(newValue)&&!angular.isNumber(newValue)?$scope.minPriceInput=null:""!=newValue&&(""!=$scope.maxPriceInput&&newValue>parseInt($scope.maxPriceInput)||""==$scope.maxPriceInput&&newValue>$scope.sliderModel.max)?$scope.minPriceInput=""==$scope.maxPriceInput?parseInt($scope.sliderModel.max)-1:parseInt($scope.maxPriceInput)-1:""!=newValue&&newValue<$scope.sliderModel.min&&($scope.minPriceInput=$scope.sliderModel.min),$scope.updateSliderValues(),$scope.prepareSliderData()}),$scope.$watch("maxPriceInput",function(newValue,oldValue){isNaN(newValue)&&!angular.isNumber(newValue)?$scope.maxPriceInput=$scope.sliderModel.max:""!=newValue&&(""!=$scope.minPriceInput&&newValue<parseInt($scope.minPriceInput)||""==$scope.minPriceInput&&newValue<$scope.sliderModel.min)?$scope.maxPriceInput=""==$scope.minPriceInput?parseInt($scope.sliderModel.min)+1:parseInt($scope.minPriceInput)+1:""!=newValue&&newValue>$scope.sliderModel.max&&($scope.maxPriceInput=$scope.sliderModel.max),$scope.updateSliderValues(),$scope.prepareSliderData()}),$scope.onSliderLoad=function(){$scope.sliderLoaded=!0,$scope.updateSliderValues()},$scope.onSliderChange=function(resultObject){$scope.sliderModel=resultObject,$scope.minPriceInput!=resultObject.from&&($scope.minPriceInput=resultObject.from),$scope.maxPriceInput!=resultObject.to&&($scope.maxPriceInput=resultObject.to)},$scope.onSliderFinish=function(resultObject){$scope.$apply(function(){$scope.minPriceInput=resultObject.from,$scope.maxPriceInput=resultObject.to})},$scope.updateSliderValues=function(){null!==$scope.sliderObject&&$scope.sliderObject.update({from:$scope.minPriceInput,to:""==$scope.maxPriceInput?$scope.sliderModel.max:$scope.maxPriceInput})}}]),piguApp.controller("PriceSliderController",["$scope","EncryptionFactory",function($scope,$encryptionFactory){$scope.init=function(params){$scope.sliderObject=null,$scope.sliderModel=params,$scope.minPriceInput=angular.element("#min-slider-price"),$scope.maxPriceInput=angular.element("#max-slider-price"),$scope.sliderValueInput=angular.element("#ion-slider-value"),$scope.minPriceInput=null==params.sliderValues?"":params.sliderValues[0],$scope.maxPriceInput=null==params.sliderValues?"":params.sliderValues[1],$scope.sliderLoaded=!1,$scope.allowAddingUrlParam=!0},$scope.resetPriceInput=function(type){"min"==type?$scope.minPriceInput="":"max"==type&&($scope.maxPriceInput=""),""!=$scope.minPriceInput&&$scope.minPriceInput!=$scope.sliderModel.min||""!=$scope.maxPriceInput&&$scope.maxPriceInput!=$scope.sliderModel.max||($scope.removeItem("price-range","s","price-range"),$scope.allowAddingUrlParam=!1)},$scope.updateSliderValues=function(){null!==$scope.sliderObject&&$scope.sliderObject.update({from:$scope.minPriceInput,to:""==$scope.maxPriceInput?$scope.sliderModel.max:$scope.maxPriceInput})},$scope.prepareSliderData=function(){if($scope.sliderLoaded){var minPrice=""==$scope.minPriceInput?$scope.sliderModel.min:$scope.minPriceInput,maxPrice=""==$scope.maxPriceInput?$scope.sliderModel.max:$scope.maxPriceInput,pricesArray=[minPrice,maxPrice,"slider-price"];$scope.sliderValueInput=$encryptionFactory.base64Encode(JSON.stringify(pricesArray)).split("").reverse().join(""),$scope.allowAddingUrlParam?$scope.addItem("price-range","s",$scope.sliderValueInput,"price-range"):$scope.allowAddingUrlParam=!0}},$scope.$watch("minPriceInput",function(newValue,oldValue){isNaN(newValue)&&!angular.isNumber(newValue)?$scope.minPriceInput=null:""!=newValue&&(""!=$scope.maxPriceInput&&newValue>parseInt($scope.maxPriceInput)||""==$scope.maxPriceInput&&newValue>$scope.sliderModel.max)?$scope.minPriceInput=""==$scope.maxPriceInput?parseInt($scope.sliderModel.max)-1:parseInt($scope.maxPriceInput)-1:""!=newValue&&newValue<$scope.sliderModel.min&&($scope.minPriceInput=$scope.sliderModel.min),$scope.updateSliderValues(),$scope.prepareSliderData()}),$scope.$watch("maxPriceInput",function(newValue,oldValue){isNaN(newValue)&&!angular.isNumber(newValue)?$scope.maxPriceInput=$scope.sliderModel.max:""!=newValue&&(""!=$scope.minPriceInput&&newValue<parseInt($scope.minPriceInput)||""==$scope.minPriceInput&&newValue<$scope.sliderModel.min)?$scope.maxPriceInput=""==$scope.minPriceInput?parseInt($scope.sliderModel.min)+1:parseInt($scope.minPriceInput)+1:""!=newValue&&newValue>$scope.sliderModel.max&&($scope.maxPriceInput=$scope.sliderModel.max),$scope.updateSliderValues(),$scope.prepareSliderData()}),$scope.onSliderLoad=function(){$scope.sliderLoaded=!0,$scope.updateSliderValues()},$scope.onSliderChange=function(resultObject){$scope.sliderModel=resultObject,$scope.minPriceInput!=resultObject.from&&($scope.minPriceInput=resultObject.from),$scope.maxPriceInput!=resultObject.to&&($scope.maxPriceInput=resultObject.to)},$scope.onSliderFinish=function(resultObject){$scope.$apply(function(){$scope.minPriceInput=resultObject.from,$scope.maxPriceInput=resultObject.to})}}]),piguApp.controller("PzuController",["$scope",function($scope){$scope.init=function(pzuObject,pzuModificationInfo,pzuTranslates,pzuMoreLink){$scope.pzu=pzuObject,$scope.pzuModificationInfo=pzuModificationInfo,$scope.translates=pzuTranslates,$scope.insuranceText={set:$scope.translates.texts.pzuInsurance,get:$scope.translates.texts.getPzuInsurance,free:!!$scope.translates.free.freeInsurance&&$scope.translates.free.freeInsurance,more:$scope.translates.texts.more},$scope.warrantyText={set:$scope.translates.texts.pzuWarranty,get:$scope.translates.texts.getPzuWarranty,free:!!$scope.translates.free.freeWarranty&&$scope.translates.free.freeWarranty,more:$scope.translates.texts.more},$scope.addWarranty=!1,$scope.addInsurance=!1,$scope.addWarrantyHash="",$scope.addInsuranceHash="",$scope.pzuImage=$scope.pzu.defaultImage,$scope.pzuMoreLink=pzuMoreLink,$scope.$watch("currentModification",function(){var currentModId=$scope.currentModification.id;$scope.currentModification.insurance=0,$scope.currentModification.warranty=0,$scope.currentModification.insuranceHash="",$scope.currentModification.warrantyHash="";var pzuItemsInsurance=[],pzuItemsWarranty=[],i=0;$scope.pzu.isAvailableInsuranceService&&angular.forEach($scope.pzu.getInsuranceMods,function(value,key){pzuItemsInsurance[i]=[],pzuItemsInsurance[i].modId=key,pzuItemsInsurance[i].value=value,pzuItemsInsurance[i].month=$scope.translates.months[value.hash],pzuItemsInsurance[i].price=currencyFormat($scope.pzuModificationInfo[currentModId].insurancePrices[value.hash],2,","),$scope.pzu.getDefaultInsuranceModIdHash==value.hash?($scope.addInsuranceHash=value.hash,pzuItemsInsurance[i].active=!0):pzuItemsInsurance[i].active=!1,i++},pzuItemsInsurance),$scope.pzuItemsInsurance=pzuItemsInsurance,i=0,$scope.pzu.isAvailableWarrantyService&&angular.forEach($scope.pzu.getWarrantyMods,function(value,key){pzuItemsWarranty[i]=[],pzuItemsWarranty[i].modId=key,pzuItemsWarranty[i].value=value,pzuItemsWarranty[i].month=$scope.translates.months[value.hash],pzuItemsWarranty[i].price=currencyFormat($scope.pzuModificationInfo[currentModId].warrantyPrices[value.hash],2,","),$scope.pzu.getDefaultWarrantyModIdHash==value.hash?($scope.addWarrantyHash=value.hash,pzuItemsWarranty[i].active=!0):pzuItemsWarranty[i].active=!1,i++},pzuItemsWarranty),$scope.pzuItemsWarranty=pzuItemsWarranty})},$scope.addPzuWarranty=function(addPzu){$scope.addWarranty=addPzu,$scope.addWarranty?$scope.currentModification.warrantyHash=$scope.addWarrantyHash:$scope.currentModification.warrantyHash="",$scope.currentModification.warranty=$scope.addWarranty},$scope.changeActiveWarranty=function(insuranceId){var pzuItemsWarranty=$scope.pzuItemsWarranty;angular.forEach($scope.pzuItemsWarranty,function(value,key){pzuItemsWarranty[key].modId==insuranceId?(pzuItemsWarranty[key].active=!0,$scope.addWarranty&&($scope.currentModification.warrantyHash=pzuItemsWarranty[key].value.hash),$scope.addWarrantyHash=pzuItemsWarranty[key].value.hash):pzuItemsWarranty[key].active=!1},pzuItemsWarranty),$scope.pzuItemsWarranty=pzuItemsWarranty},$scope.addPzuInsurance=function(addPzu){$scope.addInsurance=addPzu,$scope.addInsurance?$scope.currentModification.insuranceHash=$scope.addInsuranceHash:$scope.currentModification.insuranceHash="",$scope.currentModification.insurance=$scope.addInsurance},$scope.changeActiveInsurance=function(insuranceId){var pzuItemsInsurance=$scope.pzuItemsInsurance;angular.forEach($scope.pzuItemsInsurance,function(value,key){pzuItemsInsurance[key].modId==insuranceId?(pzuItemsInsurance[key].active=!0,$scope.addInsurance&&($scope.currentModification.insuranceHash=pzuItemsInsurance[key].value.hash),$scope.addInsuranceHash=pzuItemsInsurance[key].value.hash):pzuItemsInsurance[key].active=!1},pzuItemsInsurance),$scope.pzuItemsInsurance=pzuItemsInsurance}}]),piguApp.controller("AutoBundle",["$scope","AjaxFactory","appConfig",function($scope,AjaxFactory,appConfig){$scope.initProductAutoBundle=function(productId,categoryId,modification){$scope.productId=productId,$scope.categoryId=categoryId,$scope.modification=modification,$scope.modifications="",$scope.modificationsHash="",$scope.autoBundle=!1,$scope.products=[],$scope.showProducts=!0,$scope.showDecoFull=!0,$scope.showDeco=[],$scope.sellPrice=0,$scope.savePrice=0,$scope.showSavePrice=!1,angular.element(document).ready(function(){var request=AjaxFactory.get(appConfig.baseUrl+"products/catalog/getAutoBundle/"+$scope.productId+"/"+$scope.categoryId+"/"+$scope.modification.id);request.then(function(data){if(data.success){if($scope.products=data.products,$scope.autoBundle=!0,"undefined"!=typeof dataLayer)for(var autoBundles=$scope.products,bundleOriginal="",bundleBuy="",i=1;i<autoBundles.length;i++)bundleOriginal='{"bundle-'+i+'-original" : "n-'+autoBundles[i].title+"_id-"+autoBundles[i].id+"_mid-"+autoBundles[i].modification_id+"_p-"+autoBundles[i].sell_price+'"}',bundleBuy='{"bundle-'+i+'-buy": "true"}',dataLayer.push(eval("("+bundleOriginal+")")),dataLayer.push(eval("("+bundleBuy+")"))}else $scope.autoBundle=!1})})},$scope.postBundleToCart=function(tokenName,tokenValue,vendorId){var subscribeForm=void 0!==angular.element(document.querySelector("#subscribeForm")).val()&&angular.element(document.querySelector("#subscribeForm")).val(),postData={a:1,h:$scope.modificationsHash,m:$scope.modifications,mm:$scope.mainModificationId,s:subscribeForm,t:"autoBundle",v:vendorId};postData[tokenName]=tokenValue,AjaxFactory.post(appConfig.baseUrl+"cart/push",postData).then(function(data){if(data.success){if($scope.initCartCount(data.cartCount),data.additionalPromoRules&&($scope.additionalPromoText=data.additionalPromoRulesTemplate),appConfig.isNative&&void 0!==data.batchInfo){0==appConfig.loggedIn&&setNativeBacthUserParam("setIdentifier","uc_"+data.batchInfo.uc_id),setNativeBacthUserAttribute("setAttributeInteger","items_in_cart",parseInt(data.batchInfo.uc_count)),setNativeBacthUserAttribute("setAttributeFloat","items_in_cart_value",parseFloat(data.batchInfo.uc_price));var createKey="cart_create_date",updateKey="cart_updated";if(appConfig.isIOS){var m=moment(data.batchInfo.uc_created),formattedCreatedDate=m.format("YYYY-MM-DDTHH:mm:ss"),createdAt=new Date(formattedCreatedDate),m=moment(data.batchInfo.uc_updated),formattedUpdatedDate=m.format("YYYY-MM-DDTHH:mm:ss"),updatedAt=new Date(formattedUpdatedDate);createKey="ios_"+createKey,updateKey="ios_"+updateKey}else var createdAt=new Date(data.batchInfo.uc_created),updatedAt=new Date(data.batchInfo.uc_updated);nativeBatchUser.setAttributeDate(createKey,createdAt.toString()),"0000-00-00 00:00:00"!=data.batchInfo.uc_updated&&null!=data.batchInfo.uc_updated&&nativeBatchUser.setAttributeDate(updateKey,updatedAt.toString())}}else angular.isUndefined(data.error)||($scope.showErrorDialog=!0)})},$scope.$watch("products",function(newValue){if(newValue){var modIds="",modHash="",hideProducts=0,sellPrice=0,savePrice=0,mainModificationId=0;angular.forEach($scope.products,function(product,key){product.show?(0==mainModificationId&&(mainModificationId=product.modification_id),modIds+=product.modification_id+",",modHash+=product.hash+",",sellPrice+=parseFloat(product.sell_price),savePrice+=parseFloat(product.savePrice),key>0&&"undefined"!=typeof dataLayer&&dataLayer.push(eval('({"bundle-'+key+'-buy": "true"})'))):(key>0&&"undefined"!=typeof dataLayer&&dataLayer.push(eval('({"bundle-'+key+'-buy": "false"})')),hideProducts++),product!=$scope.products[$scope.products.length-1]&&($scope.showDeco[key]=!0)}),savePrice>0?($scope.showSavePrice=!0,$scope.savePrice=currencyFormat(savePrice,2,","," ")):$scope.showSavePrice=!1,$scope.sellPrice=currencyFormat(sellPrice,2,","," "),$scope.modifications=modIds.substring(0,modIds.length-1),$scope.modificationsHash=modHash.substring(0,modHash.length-1),$scope.mainModificationId=mainModificationId,$scope.showProducts=!(hideProducts==$scope.products.length),$scope.showDecoFull=!($scope.products.length-hideProducts<=1),angular.forEach($scope.products,function(product,key){product.show?product==$scope.products[$scope.products.length-1]?$scope.showDeco[key-1]=!0:product==$scope.products[0]?$scope.showDeco[key]=!0:$scope.products[0].show&&$scope.products[$scope.products.length-1].show?angular.forEach($scope.showDeco,function(keyshow,showDeco){$scope.showDeco[keyshow]=!0}):$scope.products[0].show?$scope.showDeco[key-1]=!0:$scope.products[$scope.products.length-1].show&&($scope.showDeco[key]=!0):product==$scope.products[$scope.products.length-1]?$scope.showDeco[$scope.showDeco.length-1]=!1:$scope.showDeco[0]=!1})}},!0)}]),piguApp.controller("UsersController",["$scope","$window",function($scope,$window){$scope.init=function(errors,emailErrors,passErrors,message){$scope.loginShow=!0,$scope.errors={},$scope.listErrors={},angular.forEach(errors,function(value,key){$scope.errors[value.key]=value.value,$scope.listErrors[key]=value.value}),$scope.emailErrors=emailErrors,$scope.passErrors=passErrors,$scope.showMessage=message},$scope.openRegister=function(loginTitle,registerTitle){$scope.loginShow=!$scope.loginShow;var newTitle=loginTitle;$scope.loginShow||(newTitle=registerTitle),$scope.changeTitle(newTitle),$window.scrollTo(0,0)},$scope.initLogin=function(errors,loginShow){$scope.loginShow=loginShow,loginShow?$scope.loginErrors=errors:$scope.registerErrors=errors},$scope.initOther=function(errors){$scope.errors=errors}}]),piguApp.controller("AddressController",["$scope","$http","AjaxFactory",function($scope,$http,AjaxFactory){$scope.init=function(addresses,defaultAddress,errors,customerType){$scope.formAction="",$scope.addresses=addresses,$scope.addresses_length=Object.keys($scope.addresses).length,$scope.defaultAddress=defaultAddress,"company"!=customerType&&"company"!=$scope.defaultAddress.status||($scope.customerType="company"),$scope.userType="customer",$scope.receiverAddresses=[],$scope.showAddressForm=!0,$scope.errors_customer={},$scope.listErrors={},angular.forEach(errors,function(value,key){$scope.errors_customer[value.key]=value.value,$scope.listErrors[key]=value.value}),0!=$scope.errors_customer.length&&0!=Object.keys($scope.errors_customer).length||"empty"==$scope.defaultAddress.status||($scope.showAddressForm=!1)},$scope.toggleUserTypeChange=function(type){AjaxFactory.get($scope.appConfig.baseUrl+"orders/history/getAddressList/"+type).then(function(data){data.success&&("customer"==data.type?$scope.addresses=data.addresses:$scope.receiverAddresses=data.addresses,$scope.userType=data.type)})},$scope.changeFormAction=function(action,confirmText,goTop,refresh){angular.isUndefined(refresh)&&(refresh=!1),angular.isDefined(confirmText)&&null!=confirmText?window.confirm(confirmText)&&$scope.doAction(action,goTop,refresh):$scope.doAction(action,goTop,refresh)},$scope.doAction=function(action,goTop,refresh){AjaxFactory.get(action).then(function(data){data.success&&("customer"==$scope.userType?($scope.addresses=data.addresses,$scope.addresses_length=Object.keys($scope.addresses).length,$scope.defaultAddress=data.defaultAddress):$scope.receiverAddresses=data.addresses,refresh&&location.reload(),angular.isDefined(goTop)&&1==goTop&&$scope.gotoAnchor("top"))})},$scope.openAddressForm=function(){$scope.showAddressForm=!$scope.showAddressForm}}]),piguApp.controller("PiguEurosController",["$scope","$http",function($scope,$http){$scope.init=function(piguEurosList){$scope.piguEurosList=piguEurosList},$scope.loadMoreHistory=function(historyLenght){historyLenght!==$scope.piguEurosList.length&&($http.get($scope.appConfig.baseUrl+"/users/pigulitai/ajaxLoadPiguEuros/"+$scope.piguEurosList.length).success(function(data,status,headers,config){for(var i=0;i<data.list.length;i++)$scope.piguEurosList.push(data.list[i])}).error(function(data,status,headers,config){$scope.status=status}),$scope.historyLenght=$scope.piguEurosList.length)}}]),piguApp.controller("WishlistController",["$scope","AjaxFactory","location","appConfig",function($scope,AjaxFactory,location,appConfig){$scope.currentWishesCount=0,$scope.nowWorking=!1,$scope.wishlistBtn="wishlistBtn",$scope.buttonVisible=!1,$scope.modsInWishlist=[],$scope.currentAction="",$scope.defaultWishlistId=0,$scope.viewWishlistInit=function($flashMessages,$wishlists){$scope.wishlists=$wishlists,$scope.flashMessages=$flashMessages},$scope.productInit=function(){$scope.modsInWishlist=appConfig.modsInWishlist,$scope.defaultWishlistId=appConfig.defaultWishlistId,$scope.toggleWishlistButtonImage(),$scope.$watch(function(){return $scope.currentModification.id},function(newValue,oldValue){$scope.buttonVisible&&$scope.toggleWishlistButtonImage()})},$scope.createInit=function($errors){$scope.createErrors=$errors},$scope.wishlistAction=function(){if(!$scope.nowWorking){$scope.nowWorking=!0;var data={modificationId:$scope.currentModification.id,productId:$scope.product.id,action:$scope.currentAction,wishlistId:$scope.defaultWishlistId,n18:$scope.product.n18};AjaxFactory.post(appConfig.baseUrl+"users/wishlist/wishlistAction",data).then(function(response){response.success?$scope.getImportantInfo(response.modificationId,response.productId):response.needToLogin?$scope.redirect(appConfig.baseUrl+"u/login"):($scope.showErrorDialog(),$scope.nowWorking=!1)})}},$scope.toggleWishlistButtonImage=function(){$scope.setCurrentAction();var button=angular.element(document.querySelector("#wish-heart"));"remove"==$scope.currentAction?button.addClass("active"):button.removeClass("active"),$scope.showWishlistButton()},$scope.showWishlistButton=function(){if(!$scope.buttonVisible){angular.element(document.querySelector("#"+$scope.wishlistBtn)).removeClass("hide"),$scope.buttonVisible=!0}},$scope.getImportantInfo=function($productId){var productId=0;productId=$productId||$scope.product.id;var data={productId:productId};AjaxFactory.post(appConfig.baseUrl+"users/wishlist/getImportantInfo",data).then(function(response){response.success?($scope.currentWishesCount=response.wishesCount,setWishlistCount($scope.currentWishesCount),setNativeWishlistCount($scope.currentWishesCount),$scope.modsInWishlist=response.modsInWishlist,$scope.defaultWishlistId=response.defaultWishlistId,$scope.toggleWishlistButtonImage(),$scope.nowWorking=!1):$scope.nowWorking=!1})},$scope.showErrorDialog=function(){$scope.wishlistDialogTitle=$scope.translates.error,$scope.wishlistDialogContent="add"==$scope.currentAction?$scope.translates.errorAdd:$scope.translates.errorRemove,$scope.showPopup=!0},$scope.setCurrentAction=function(){$scope.currentAction=$scope.modsInWishlist.indexOf($scope.currentModification.id)>=0?"remove":"add"},$scope.redirect=function($url){window.location.href=$url},$scope.wrapOnChange=function(id){var url=location.addParamToUrlString(window.location.href.toString(),"w",id);url=location.removeParamFromUrlString(url,"page"),window.location=url}}]),piguApp.controller("CreditCardController",["$scope","AjaxFactory",function($scope,AjaxFactory){$scope.init=function(cards){$scope.cards=cards},$scope.redirect=function(url){window.location.href=url}}]),piguApp.controller("Bitrec",["$scope","$http",function($scope,$http){$scope.initProductRecommended=function(productId,customerId,walletId,cartId){var bitrecResponse=$http.get("/widgets/bitrec/bought/"+productId+"/"+customerId+"/"+walletId+"/"+cartId+"?json=1");$scope.recommenderTitle=!1,$scope.recommenderLoader=!0,bitrecResponse.success(function(data){data=angular.fromJson(data),angular.isArray(data)&&data.length>0?($scope.recommenderTitle=!0,$scope.recommenderLoader=!1,$scope.products=data):($scope.recommenderTitle=!1,$scope.recommenderLoader=!1)})},$scope.initCategoryRecommended=function(categoryLevel,categoryId,customerId,walletId,cartId){var bitrecResponse=$http.get("/widgets/bitrec/category/"+categoryLevel+"/"+categoryId+"/"+customerId+"/"+walletId+"/"+cartId+"?json=1");$scope.recommenderTitle=!1,$scope.recommenderLoader=!0,bitrecResponse.success(function(data){data=angular.fromJson(data),angular.isArray(data)&&data.length>0?($scope.recommenderTitle=!0,$scope.recommenderLoader=!1,$scope.products=data):($scope.recommenderTitle=!1,$scope.recommenderLoader=!1)})},$scope.initHomeRecommended=function(customerId,visitorId,cartId){var url="/widgets/bitrec/home/"+customerId+"/"+visitorId+"/"+cartId+"?json=1",bitrecResponse=$http.get(url);$scope.recommenderTitle=!1,$scope.recommenderLoader=!0,bitrecResponse.success(function(data){data=angular.fromJson(data),angular.isArray(data)&&data.length>0?($scope.recommenderTitle=!0,$scope.recommenderLoader=!1,$scope.products=data):($scope.recommenderTitle=!1,$scope.recommenderLoader=!1)})},$scope.initThankyouRecommended=function(customerId,visitorId,cartId){var url="/widgets/bitrec/thankyou/"+customerId+"/"+visitorId+"/"+cartId+"?json=1",bitrecResponse=$http.get(url);$scope.recommenderTitle=!1,$scope.recommenderLoader=!0,bitrecResponse.success(function(data){data=angular.fromJson(data),angular.isArray(data)&&data.length>0?($scope.recommenderTitle=!0,$scope.recommenderLoader=!1,$scope.products=data):($scope.recommenderTitle=!1,$scope.recommenderLoader=!1)})}}]),piguApp.factory("AjaxFactory",function($http,$q){return{post:function(reqUrl,formData){var deferred=$q.defer();return $http({method:"post",url:reqUrl,data:formData}).success(function(data){data.error?data.message:data.success?data.message:data.validation,deferred.resolve(data)}).error(function(data){}),deferred.promise},get:function(regUrl){var deferred=$q.defer();return $http.get(regUrl).success(function(data,status,headers,config){deferred.resolve(data)}).error(function(data,status,headers,config){}),deferred.promise}}}),piguApp.factory("ProductFactory",function(appConfig){var productGalleryImages=[],productGalleryVideos=[],productInfo=[];return{initGallery:function(galleryImages,galleryVideos){productGalleryImages=galleryImages,productGalleryVideos=galleryVideos,angular.element(document).ready(function(){angular.element("#lightGallery").lightGallery()})},openGallery:function(){var images=new Array;angular.forEach(productGalleryImages,function(value){this.push({src:value.photo_url+"_xbig.jpg",thumb:value.photo_url+"_medium.jpg","sub-html":"#dynamicHtml"})},images),productGalleryVideos.length>0&&angular.forEach(productGalleryVideos,function(value){this.push({src:"http://www.youtube.com/watch?v="+value,thumb:"http://i.ytimg.com/vi/"+value+"/default.jpg","sub-html":"#dynamicHtml"})},images),angular.element("#dynamic").lightGallery({dynamic:!0,dynamicEl:images,download:!1})},sortModifications:function(modifications){var sortable=[];for(var key in modifications)sortable.push(key);return sortable.sort(function(a,b){return a[0]-b[0]}),sortable},changeModificationIdinUrl:function(currentModificationId){var regex=new RegExp("[\\?&]mid=([^&#]*)"),match=document.URL.match(regex);if(match)var url=document.URL.replace(match[0],"&mid="+currentModificationId);else var url=document.URL+"&mid="+currentModificationId;window.history&&history.pushState?history.replaceState({},"",url):window.location.href=url},initPrice:function(modification){productInfo.sellPrice=modification.curencyFormat.sellPrice,productInfo.holdingPrice=modification.curencyFormat.holdingPrice,productInfo.priceExplain=modification.discounts.priceExplain,productInfo.leftString=modification.leftString,productInfo.showOldPriceInfo=!1,productInfo.normalPrice="",modification.normal_price!=modification.sell_price&&(productInfo.showOldPriceInfo=!0,productInfo.normalPrice=modification.curencyFormat.normalPrice+" *")},getProduct:function(){return productInfo},createDropdownArray:function(array,dropdownValue){var dropdownArray={};return angular.forEach(array,function(value,key){dropdownArray[key]=value[dropdownValue]}),dropdownArray}}}),piguApp.factory("ProductsInfiniteLoader",function($http,appConfig,AjaxFactory,location){var ProductsInfiniteLoader=function(){this.url=appConfig.baseUrl+"products/catalog/infinite"};return ProductsInfiniteLoader.prototype.loadPages=function(pages,pageSize){var _this=this;AjaxFactory.get(this.url+"&load_pages="+pages.join("_")).then(function(data){for(var productsInPages=[],pageKey=0;data.list.length>0;){var products=data.list.splice(0,pageSize);productsInPages[pages[pageKey]]=products,pageKey++}_this.onPagesLoad(productsInPages)})},ProductsInfiniteLoader.prototype.setUrl=function(url){this.url=location.addParamToUrlString(url,"force_json",1)},ProductsInfiniteLoader.prototype.onMultiplePagesLoad=function(data){},ProductsInfiniteLoader.prototype.onPageLoad=function(data){},ProductsInfiniteLoader}),piguApp.factory("FilterFactory",function(){var factory={showFilter:!1,activeFilter:!1,setShowFilter:function(newShowFilter){factory.showFilter=newShowFilter},setActiveFilter:function(newActiveFilter){factory.activeFilter=newActiveFilter}};return factory});var piguApp=angular.module("piguLocation",[]);piguApp.factory("location",function(){return{addParamToUrlString:function(url,parameterName,parameterValue,atStart){var replaceDuplicates=!0;if(url.indexOf("#")>0)var cl=url.indexOf("#"),urlhash=url.substring(url.indexOf("#"),url.length);else var urlhash="",cl=url.length;var sourceUrl=url.substring(0,cl),urlParts=sourceUrl.split("?"),newQueryString="";if(urlParts.length>1)for(var parameters=urlParts[1].split("&"),i=0;i<parameters.length;i++){var parameterParts=this.customSplit(parameters[i],"=");replaceDuplicates&&parameterParts[0]==parameterName||(""==newQueryString?newQueryString="?":newQueryString+="&",newQueryString+=parameterParts[0]+"="+(parameterParts[1]?parameterParts[1]:""))}return""==newQueryString&&(newQueryString="?"),atStart?newQueryString="?"+parameterName+"="+parameterValue+(newQueryString.length>1?"&"+newQueryString.substring(1):""):(""!==newQueryString&&"?"!=newQueryString&&(newQueryString+="&"),newQueryString+=parameterName+"="+(parameterValue||"")),urlParts[0]+newQueryString+urlhash},customSplit:function(string,separator){for(var i=0;i<string.length;i++){var parts=["",""];parts[0]=string.substr(0,string.indexOf(separator)),parts[1]=string.substr(string.indexOf(separator)+1),parts=angular.isUndefined(parts[0])?[parts[1]]:parts}return 0==string.length&&(parts=[string]),parts},removeParamFromUrlString:function(sourceURL,key){var rtn=sourceURL.split("?")[0],params_arr=[],queryString=-1!==sourceURL.indexOf("?")?sourceURL.split("?")[1]:"";if(""!==queryString){params_arr=queryString.split("&");for(var i=params_arr.length-1;i>=0;i-=1)params_arr[i].split("=")[0]===key&&params_arr.splice(i,1);rtn=rtn+(params_arr.length>0?"?":"")+params_arr.join("&")}return rtn},getParameterByName:function(name){name=name.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var regex=new RegExp("[\\?&]"+name+"=([^&#]*)"),results=regex.exec(location.search);return null===results?"":decodeURIComponent(results[1].replace(/\+/g," "))},searchParameter:function(sourceURL,name){sourceURL=sourceURL.replace("%5B","[").replace("%5D","]");var queryString=-1!==sourceURL.indexOf("?")?sourceURL.split("?")[1]:"";if(""!==queryString)for(var params_arr=queryString.split("&"),i=params_arr.length-1;i>=0;i-=1){if(param=this.customSplit(params_arr[i],"=")[0],param===name)return this.customSplit(params_arr[i],"=")[1];if(param=param.split("[")[0],param===name)return this.customSplit(params_arr[i],"=")[1]}return!1},URLToArray:function(url){for(var request={},pairs=url.substring(url.indexOf("?")+1).split("&"),i=0;i<pairs.length;i++)if(pairs[i]){var pair=pairs[i].split("=");request[i]={key:decodeURIComponent(pair[0]),value:decodeURIComponent(pair[1])}}return request}}});var piguApp=angular.module("pigu-directives",configData.directives);piguApp.directive("focusMe",function($timeout){return{scope:{trigger:"@focusMe"},link:function(scope,element){scope.$watch("trigger",function(value){angular.element(element).click(function(){element[0].focus()}),"true"===value&&$timeout(function(){angular.element(element).click()})})}}}),piguApp.directive("printf",function($compile){return{scope:{vars:"@"},restrict:"EA",replace:!0,link:function(scope,element,attr){var string=element.html(),stringHtml=string;angular.isDefined(string.context)&&(stringHtml=string.context.innerHTML);var parts=stringHtml.split("%s"),returnString="",vars=scope.vars;vars=angular.fromJson(vars);for(index in parts)returnString+=parts[index],void 0!==vars[index]&&(returnString+=vars[index]);element.html(returnString),$compile(element.contents())(scope)}}}),piguApp.directive("t",function(){return{restrict:"E"}}),piguApp.directive("errorMessage",function(appConfig){return{restrict:"E",scope:{jsonErrors:"=errors"},templateUrl:appConfig.templatesUrl+"errorMessage.html?r="+appConfig.r,link:function(scope,element,attr){scope.$watch("jsonErrors",function(){scope.errors=scope.jsonErrors,angular.isDefined(scope.errors)&&0!=scope.errors.length&&0!=Object.keys(scope.errors).length||(scope.errors=!1)})}}}),piguApp.directive("messageBox",function(appConfig){return{restrict:"E",scope:{messageTitle:"@",messageDescription:"@"},templateUrl:appConfig.templatesUrl+"messageBox.html?r="+appConfig.r,link:function(scope){scope.appConfig=appConfig}}}),piguApp.directive("toggle",function(appConfig){return{restrict:"E",scope:{titleInfo:"@",show:"=showToggle"},templateUrl:function(element,attrs){return attrs.templateName?appConfig.templatesUrl+attrs.templateName+".html?r="+appConfig.r:appConfig.templatesUrl+"toggle.html?r="+appConfig.r},transclude:!0,link:function(scope,element,attr){scope.runToggle=function(){scope.show=!scope.show}}}}),piguApp.directive("confirmationNeeded",function(){return{priority:1,terminal:!0,link:function(scope,element,attr){var msg=attr.confirmationNeeded||"Ar tikrai?",clickAction=attr.ngClick;element.bind("click",function(){window.confirm(msg)&&scope.$eval(clickAction)})}}}),piguApp.directive("menu",function(appConfig,$rootScope){return{restrict:"AE",scope:{cat:"@"},templateUrl:appConfig.templatesUrl+"menu.html?r="+appConfig.r,link:function(scope,element,attr,subMenuCtrl){scope.categories=angular.fromJson(scope.cat),scope.showSub=!1,scope.appConfig=appConfig,scope.showSubMenu=function(id){scope.setCurrentCategory(id),angular.element(document.querySelector(".md-sidenav-backdrop")).bind("click",function(){scope.showSub=!1}),scope.showSub=!0},scope.setCurrentCategory=function(id){scope.currentCategory=scope.categories[id],scope.subCategories=scope.categories[id].subcategories}}}}),piguApp.directive("repeatEnd",function($timeout,$window){return{restrict:"A",link:{post:function(scope,element,attrs){if(scope.$last){angular.element($window).bind("load",function(){scope.$eval(attrs.repeatEnd)});angular.element(element).find("img").length>0?angular.forEach(angular.element(element).find("img"),function(image){angular.element(image).load(function(){scope.$eval(attrs.repeatEnd)}),angular.element(image).error(function(){scope.$eval(attrs.repeatEnd)})}):scope.$eval(attrs.repeatEnd),angular.element($window).bind("resize",function(){scope.$eval(attrs.repeatEnd)})}}}}}),piguApp.directive("repeatStart",function($timeout,$window){return{restrict:"A",link:{pre:function(scope,element,attrs){scope.$eval(attrs.repeatStart)}}}}),piguApp.directive("popup",["appConfig","$window","$timeout","$document","AjaxFactory",function(appConfig,$window,$timeout,$document,AjaxFactory){return{restrict:"E",scope:{buttonTitle:"@",buttonId:"@",popupTitle:"@",type:"@",buttonClass:"@",dialogClass:"@",promotionParam:"=",promotionText:"=",promoCallback:"&",params:"=",runCallback:"&",forceShow:"=",closeCallback:"&",show:"=",useButton:"=",popupHref:"@",thisResponsive:"@responsive"},templateUrl:appConfig.templatesUrl+"popup.html?r="+appConfig.r,transclude:!0,link:function(scope,element,attrs,ctrl,transclude){if(scope.addContent=!1,angular.isUndefined(scope.thisResponsive)?scope.responsive=!1:scope.responsive="true"===scope.thisResponsive,angular.isUndefined(scope.useButton)?scope.button=!0:scope.button=scope.useButton,angular.isUndefined(scope.show)&&(scope.show=!1),angular.isDefined(attrs.content)&&attrs.$observe("content",function(value){value&&(scope.content=attrs.content)}),angular.isDefined(scope.popupHref)){AjaxFactory.get(scope.popupHref).then(function(data){scope.content=data})}scope.$watch("forceShow",function(newValue){angular.isUndefined(newValue)?scope.showPopup=!1:(scope.show=!0,scope.showMe(),scope.forceShow=null)}),scope.showMe=function(){scope.showPopup=scope.show;var elementResult=angular.element(element[0].getElementsByClassName("transclude"));!scope.addContent&&angular.isUndefined(scope.content)?(transclude(scope,function(clone){elementResult.append(clone)}),scope.addContent=!0):angular.isDefined(scope.content)&&elementResult.html('<div class="modal-body">'+scope.content+"</div>"),angular.element(element[0].getElementsByClassName("fade")).css("display","block"),scope.runCallback()},scope.hideMe=function(){scope.showPopup=!1,angular.element(element[0].getElementsByClassName("fade")).css("display","none"),scope.closeCallback(),scope.promoCallback()},scope.$watch("show",function(newValue){newValue?scope.showMe():scope.hideMe()}),scope.runPopup=function(){scope.show=!0},scope.buy=function(){appConfig.isNative&&scope.hideMe(),window.location.href="/cart"},scope.closeDialog=function(param){scope.show=!1,scope.closeCallback(param),scope.promoCallback()}}}}]),piguApp.directive("labelFocus",function(appConfig){return{restrict:"A",scope:{labelFocus:"@"},link:function(scope,element){angular.element(element).bind("click",function(){angular.element(document.querySelector("#"+scope.labelFocus)).trigger("click")})}}}),piguApp.directive("isPopup",function(appConfig,$compile){return{restrict:"A",scope:{popupHref:"@href",popupTitle:"@title",popupResponsive:"@responsive"},link:function(scope,element){scope.showPopup=!1,angular.isUndefined(scope.popupResponsive)?scope.thisResponsive=!0:scope.thisResponsive=scope.popupResponsive,element.on("click",function(e){scope.showPopup=!0,scope.$apply(),e.preventDefault()});var el=$compile('<popup popup-href="{{popupHref}}" use-button="false" responsive="{{thisResponsive}}" show="showPopup" popup-title="{{popupTitle}}" close-callback="showPopup = false"></popup>')(scope);angular.element(document.querySelector("body")).append(el)}}}),piguApp.directive("piguCheckbox",function(appConfig,$compile){return{restrict:"E",templateUrl:appConfig.templatesUrl+"checkbox.html?r="+appConfig.r,replace:!0,require:"?ngModel",scope:{name:"@",label:"@",checked:"=",disabled:"=",trueValue:"@",falseValue:"@"},link:function(scope,element,attrs,model){angular.isUndefined(scope.checked)||(scope.isChecked=scope.checked,null!==model&&model.$setViewValue(scope.isChecked)),angular.isUndefined(scope.disabled)||(scope.isDisabled=scope.disabled),angular.isUndefined(scope.trueValue)&&(scope.trueValue=!0),angular.isUndefined(scope.falseValue)&&(scope.falseValue=!1),null!==model&&model.$formatters.unshift(function(value){return scope.isChecked=value==scope.trueValue,value}),scope.toggle=function(){scope.isDisabled||(scope.isChecked=!scope.isChecked)},angular.isUndefined(scope.isChecked)&&(scope.isChecked=!1),angular.isUndefined(scope.isDisabled)&&(scope.isDisabled=!1),scope.$watch("isChecked",function(newValue,oldValue){scope.value=newValue?scope.trueValue:scope.falseValue,null!==model&&model.$setViewValue(scope.value)})}}}),piguApp.directive("cookieBox",function(appConfig){return{restrict:"E",templateUrl:appConfig.templatesUrl+"cookieBox.html?r="+appConfig.r,scope:{cookie:"@",buttonClass:"@",buttonTitle:"@"},controller:function($scope){$scope.cookieParams=JSON.parse($scope.cookie),$scope.showPopup=!1,$scope.showButton=$scope.cookieParams.showButton,$scope.checkCookie=function(){navigator.cookieEnabled||$scope.cookieParams.platform||$scope.cookieParams.show||($scope.popupContent=$scope.cookieParams.content,$scope.popupTitle=$scope.cookieParams.title,$scope.cookieParams.showButton||($scope.showPopup=!0))}}}}),piguApp.directive("unveil",function(){return{restrict:"A",scope:{unveilSource:"@unveilSource",unveilSourceRetina:"@unveilSourceRetina"},link:function(scope,element,attrs){isRetina||(void 0!==scope.unveilSource&&(scope.unveilSource=scope.unveilSource.replace("_large","_medium"),scope.unveilSource=scope.unveilSource.replace("_big","_medium")),void 0!==scope.unveilSourceRetina&&(scope.unveilSourceRetina=scope.unveilSourceRetina.replace("_large","_medium"),scope.unveilSourceRetina=scope.unveilSourceRetina.replace("_big","_medium"))),attrs.$set("dataSrc",scope.unveilSource),attrs.$set("dataSrcRetina",scope.unveilSourceRetina),$(element).unveil(0,function(){$(this).load(function(){("data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"==this.src||this.src.match(/pigult_preloader_32x42/g))&&(this.src=$(this).attr("data-src"))})})}}}),piguApp.component("imageTextLabel",{bindings:{imagePath:"@",hasSubMenu:"@",title:"@"},template:"<div><span ng-if='$ctrl.imagePath' class='image-cell'><span></span><img ng-src='{{$ctrl.imagePath}}'></span><span>{{$ctrl.title}}</span></div>",controller:function(){this.$onInit=function(){}}}),piguApp.component("imageLinkLabel",{bindings:{imagePath:"@",href:"@",title:"@",hasSubMenu:"@"},template:"<div><a href='{{$ctrl.href}}'><span ng-if='$ctrl.imagePath' class='image-cell'><span></span><img ng-if='$ctrl.imagePath' ng-src='{{$ctrl.imagePath}}'></span><span>{{$ctrl.title}}</span></a></div>",controller:function(){}}),piguApp.component("menuRow",{transclude:!0,template:"<div ng-transclude></div>"}),piguApp.component("menuGroup",{transclude:!0,template:"<div ng-transclude></div>"}),piguApp.component("appMenu",{bindings:{list:"="},controllerAs:"menuCtrl",transclude:!0,template:"<div ng-transclude></div>",controller:function(){this.$onInit=function(){}}}),piguApp.component("navigation",{transclude:!0,controllerAs:"navigationCtrl",template:"<div ng-transclude></div>",controller:function($scope,$element,$attrs,appConfig){this.showViewLayer=function(){this.subMenu.show()},this.setContent=function(){},this.$onInit=function(){}}}),piguApp.component("recentSearches",{bindings:{searches:"@",delegate:"="},templateUrl:function(appConfig){return appConfig.templatesUrl+"recentSearches.html?r="+appConfig.r},controller:function($scope,$element,$compile,appConfig,AjaxFactory){this.$onInit=function(){var searches=JSON.parse(this.searches);this.createItems(searches)},this.createItems=function(items){var container=$("<div></div>"),group=$("<menu-group></menu-group>");for(var i in items){var item=items[i];$("<menu-row ng-click=\"$ctrl.doSearch('"+item+'\')"><span class="icon-arrow-right pull-right"></span><image-text-label title="'+item+'"></image-text-label></menu-row>').appendTo(group)}group.appendTo(container),$compile(container)($scope).appendTo($element.find("#recentSearchItems"))},this.doSearch=function(value){this.delegate.searchValue=value,this.delegate.doBlur()},this.cleanRecent=function(){var _this=this;AjaxFactory.get(appConfig.baseUrl+"search/cleanRecent",{}).then(function(data){"success"==data.status&&_this.delegate.addEmptyView()})}}}),piguApp.component("searchWidget",{bindings:{onClose:"&",onSearchExist:"&",searchValue:"@",delegate:"=",id:"@",forceIframe:"@",onSearchEnd:"&"},templateUrl:function(appConfig){return appConfig.templatesUrl+"search.html?r="+appConfig.r},controller:function($rootScope,$scope,$element,$window,$location,$compile,$timeout,AjaxFactory,appConfig,location){this.contentPane=!1,this.groupsTabsContainer=!1,this.history=[],this.currentHistoryStep=0,this.input=!1,this.isLoading=!1,this.iframe=!1,this.filterParams=[],this.forceLoad=!1,this.currentUrl="",this.startWindowHistory=[],this.translates=appConfig.translates,this.$onInit=function(){this.startWindowHistory=window.history,this.contentPane=$element.find("#searchContentPane"),this.groupsTabsContainer=$element.find("#groupsTabsContainer"),this.input=$element.find("#searchLayerInput"),this.groupsTabsContainer.hide(),this.setContentHeight(),this.constructFilterParams(),angular.isDefined(this.searchValue)&&""!=this.searchValue?(this.onSearchExist(),this.onShow(),this.doSearch()):this.addEmptyView(),this.bindFuncToElements(),this.delegate[this.id]=this},this.onShow=function(){var url=location.addParamToUrlString(window.location.href,"search_type","layer");History.pushState(null,null,url),this.currentUrl=window.location.href;for(var i in this.filterParams){var param=this.filterParams[i];this.currentUrl=this.currentUrl.replace("&search_"+param.key+"="+param.value,"").replace("search_"+param.key+"="+param.value,"")}},this.changeOrderBy=function(ob){this.currentUrl=location.addParamToUrlString(this.currentUrl,"search_ob",ob),this.currentUrl=location.removeParamFromUrlString(this.currentUrl,"search_page"),History.replaceState(null,null,this.currentUrl),this.forceLoad=!0,this.doSearch()},this.resetOrderBy=function(){this.currentUrl=location.removeParamFromUrlString(this.currentUrl,"search_ob")},this.constructFilterParams=function(){var urlArray=location.URLToArray(window.location.href);for(var i in urlArray){var param=urlArray[i];"search_c[]"==param.key&&(this.filterParams["c_"+param.value]={key:"c[]",value:param.value}),"search_filter[sell_price][]"==param.key?this.filterParams["sell_price_"+param.value]={key:"filter[sell_price][]",value:param.value}:param.key.indexOf("search_filter[attr")>-1&&(this.filterParams["attr_"+param.value]={key:param.key,value:param.value})}},this.bindFuncToElements=function(){},this.addEmptyView=function(){var container=$('<div style="height: 100%;" ng-controller="SubCategoriesController as SubCtrl"></div>'),group=$("<menu-group></menu-group>");$('<menu-row ng-click="$ctrl.delegate.navigationCtrl.showSubCategoriesMenu(0)"><span class="icon-arrow-right pull-right"></span><image-text-label title="'+appConfig.translates.all_categories+'" image-path="'+appConfig.staticDesignUrl+'icons_png/menu_categories.png"></image-text-label></menu-row>').appendTo(group),group.appendTo(container);var emptyContainer=$('<div class="emptySearchContainer"><span class="fakeSpan"></span></div>'),span=$("<span></span>");$('<b style="opacity: 0.5;">'+appConfig.translates.search_products_empty+" "+appConfig.appName+"</b><br><br>").appendTo(span),$("<img>").attr("src",appConfig.staticDesignUrl+"search_empty_icon.png").appendTo(span),span.appendTo(emptyContainer),emptyContainer.appendTo(container),this.setContent($compile(container)($scope)),AjaxFactory.get(appConfig.baseUrl+"search/recent",{}).then(function(data){data.length>0&&(emptyContainer.remove(),$compile("<recent-searches searches='"+JSON.stringify(data)+"' delegate='$ctrl'></recent-searches>")($scope).appendTo(container))})},this.showProducts=function($event){if(angular.isDefined($event)){this.groupsTabsContainer.find("*").removeClass("active");$($event.target).addClass("active")}$element.find("#searchProductsContainer").css("display","block"),$element.find("#searchCategoriesContainer").css("display","none")},this.showCategories=function($event){if(angular.isDefined($event)){this.groupsTabsContainer.find("*").removeClass("active");$($event.target).addClass("active")}$element.find("#searchProductsContainer").css("display","none"),$element.find("#searchCategoriesContainer").css("display","block")},this.setContentHeight=function(){var form=$element.find("#searchWidgetForm"),windowHeight=$window.innerHeight,headerHeight=form.outerHeight(),tabsHeight=this.groupsTabsContainer.outerHeight(),height=windowHeight-headerHeight-tabsHeight;this.contentPane.css("height",height+"px");var _this=this;this.contentPane.scroll(function(){_this.contentPane.find("img").trigger("unveil")})},this.showTabsContainer=function(){this.groupsTabsContainer.show()},this.hideTabsContainer=function(){this.groupsTabsContainer.hide()},this.closeSearch=function(){this.resetSearch(),this.delegate.forceHideMenuBar(),this.onClose()},this.resetSearch=function(){this.resetOrderBy(),this.resetFilters();var url=this.currentUrl;url=location.removeParamFromUrlString(url,"page"),url=location.removeParamFromUrlString(url,"q"),url=location.removeParamFromUrlString(url,"search_type"),url=location.removeParamFromUrlString(url,"search_page"),History.replaceState(null,null,url),this.searchValue="",this.filterParams=[],this.hideTabsContainer(),this.setContent(),this.history=[],this.statusHistoryButton(),this.addEmptyView()},this.doSearch=function(onEnter){if(0==this.isLoading&&(void 0===this.history[this.currentHistoryStep]||void 0!==this.history[this.currentHistoryStep]&&this.history[this.currentHistoryStep].query!=this.searchValue||void 0!==this.history[this.currentHistoryStep]&&this.history[this.currentHistoryStep].query==this.searchValue&&this.forceLoad)&&angular.isDefined(this.searchValue)&&""!=this.searchValue)if(this.groupsTabsContainer.hide(),this.addLoader(),angular.isDefined(this.forceIframe)){var url=appConfig.baseUrl+"search?q="+this.searchValue+"&forceIframe=1";angular.isDefined(this.searchValue)&&""!=this.searchValue&&(this.iframe=$('<iframe src="'+url+'" iframe-onload="$ctrl.iframeLoaded()"></iframe>'),this.iframe.appendTo(this.contentPane))}else{var url="products/sphinx_search/index",_this=this;if(angular.isDefined(this.searchValue)&&""!=this.searchValue){angular.isDefined(onEnter)&&this.resetFilters();var currentUrl=location.addParamToUrlString(this.currentUrl,"q",this.searchValue),searchQuery="?q="+this.searchValue+"&empty=1";angular.isDefined(location.getParameterByName("search_page"))&&(searchQuery+="&page="+location.getParameterByName("search_page")),angular.isDefined(location.getParameterByName("search_ob"))&&(searchQuery+="&ob="+location.getParameterByName("search_ob"));for(var i in this.filterParams){var filterParam=this.filterParams[i];-1==currentUrl.indexOf("search_"+filterParam.key+"="+filterParam.value)&&(currentUrl+="&search_"+filterParam.key+"="+filterParam.value),-1==searchQuery.indexOf(filterParam.key+"="+filterParam.value)&&(searchQuery+="&"+filterParam.key+"="+filterParam.value)}History.replaceState(null,null,currentUrl),angular.isDefined($scope.$$childHead)&&null!=$scope.$$childHead&&angular.isDefined($scope.$$childHead.suggestionCtrl)&&$scope.$$childHead.suggestionCtrl.closeSuggestions();var request=AjaxFactory.get(appConfig.baseUrl+url+searchQuery,{});request.then(function(data){void 0!==data.status&&"forceRedirect"==data.status&&(window.location.href=data.url),_this.removeLoader(),_this.showTabsContainer(),_this.setContentHeight();var content=$(data.html),filtersParams=data.activeFilters;_this.filterParams=filtersParams;var compiledData=$compile(angular.copy(content))($scope);_this.forceLoad||_this.setHistory(_this.searchValue,angular.copy(content)),_this.forceLoad=!1,compiledData.appendTo(_this.contentPane),_this.onSearchEnd(),_this.showProducts(),$timeout(function(){$(".sugettion-drop-layer").addClass("ng-hide"),angular.isDefined($scope.$$childHead)&&null!=$scope.$$childHead&&angular.isDefined($scope.$$childHead.suggestionCtrl)&&$scope.$$childHead.suggestionCtrl.closeSuggestions()},300)})}}},this.onEnterSearch=function(){this.doSearch("onEnter")},this.resetFilters=function(){for(var i in this.filterParams){var param=this.filterParams[i];this.currentUrl=location.removeParamFromUrlString(this.currentUrl,"search_"+param.key)}this.filterParams=[]},this.iframeLoaded=function(){this.removeLoader(),this.iframe.attr("height","100%"),this.iframe.attr("width","100%")},this.toggleFilterParam=function(hash,key,value){this.currentUrl=location.removeParamFromUrlString(this.currentUrl,"search_page"),History.replaceState(null,null,this.currentUrl),angular.isDefined(this.filterParams[hash])?(this.currentUrl=this.currentUrl.replace("&search_"+this.filterParams[hash].key+"="+this.filterParams[hash].value,""),this.currentUrl=this.currentUrl.replace("search_"+this.filterParams[hash].key+"="+this.filterParams[hash].value,""),delete this.filterParams[hash]):this.filterParams[hash]={key:key,value:value},this.forceLoad=!0,this.doSearch()},this.doBlur=function(){appConfig.isIOS&&document.activeElement.blur(),this.input.blur()},this.setContent=function(content){this.contentPane.html(""),"undefined"!=typeof ga&&ga("send","pageview"),$(content).appendTo(this.contentPane)},this.setHistory=function(query,html){var key=this.history.length;this.history[key]={query:query,html:html},this.currentHistoryStep=key,this.statusHistoryButton()},this.statusHistoryButton=function(){this.history.length>0?$element.addClass("active-search-history"):$element.removeClass("active-search-history")},this.previousQuery=function(){if(this.addLoader(),this.currentHistoryStep-1>=0){if(!angular.isDefined(this.forceIframe)){this.history.splice(this.currentHistoryStep,1),this.currentHistoryStep=this.currentHistoryStep-1;var step=this.history[this.currentHistoryStep];this.searchValue=step.query,this.resetFilters();var currentUrl=location.addParamToUrlString(this.currentUrl,"q",this.searchValue);History.replaceState(null,null,currentUrl),this.removeLoader(),this.setContent($compile(angular.copy(step.html))($scope)),this.showProducts()}}else this.history.splice(this.currentHistoryStep,1),this.removeLoader(),this.resetSearch();this.statusHistoryButton()},this.addLoader=function(){this.isLoading=!0,this.contentPane.html(""),this.loaderContainer=$("<div></div>").css("height","100%").css("text-align","center"),$("<span></span>").css("display","inline-block").css("vertical-align","middle").css("height","100%").appendTo(this.loaderContainer),$("<img>").css("display","inline-block").css("vertical-align","middle").attr("src",appConfig.staticUrl+"design/pigult_preloader_32x42.gif").appendTo(this.loaderContainer),this.loaderContainer.appendTo(this.contentPane)},this.removeLoader=function(){this.isLoading=!1,angular.isDefined(this.loaderContainer)&&null!=this.loaderContainer&&(this.loaderContainer.remove(),this.loaderContainer=null)},this.setContent=function(content){this.contentPane.html(""),angular.isDefined(content)&&content.appendTo(this.contentPane)},this.loadContentIframe=function(){}}}),piguApp.component("viewLayer",{bindings:{href:"@",slideInFrom:"@",autoShow:"@",id:"@",delegate:"=",headerTitle:"@",onClose:"&",containerType:"@"},transclude:!0,template:function($element,$attrs){return angular.isDefined($attrs.containerType)?"<div id='emptyContainer' style='height: 100%;'><div ng-transclude></div></div>":"<div id='containerWithHeader' style='height: 100%;' ng-swipe-right='$ctrl.back();'><div ng-transclude></div><div class='sub-menu-header'>{{$ctrl.headerTitle}}<div ng-click='$ctrl.back();' style='background: none; padding-left: 2px; padding-bottom:5px; padding-top:3px;' class='top-menu-item pull-left'><span class='icon-arrow-left'></span></div></div><div id='viewLayerContent'></div></div>"},controller:function($scope,$element,$attrs,appConfig,$animateCss,$window){appConfig.zIndex+=1,this.postions={left:{top:"0px",left:"-100%"},right:{top:"0px",right:"-100%"},top:{top:"-100%",left:"0px"},bottom:{bottom:"-100%",left:"0px"}},this.setStyle=function(){if($element.css("position","fixed"),$element.css("z-index",appConfig.zIndex),$element.css("width","100%"),$element.css("height","100%"),$element.css("background-color","#eeeded"),$element.css("overflow","hidden"),$element.css("-webkit-overflow-scrolling","touch"),$element.css("-webkit-flex-direction","column"),$element.css("-ms-flex-direction","column"),$element.css("flex-direction","column"),angular.isDefined(this.postions[this.slideInFrom])){var styles=this.postions[this.slideInFrom];for(var name in styles)$element.css(name,styles[name])}if(!angular.isDefined(this.containerType)){this.setContentHeight();var _this=this;angular.element($window).bind("resize",function(){_this.setContentHeight()})}},this.setTitle=function(title){angular.isDefined(title)?this.headerTitle=title:this.headerTitle=this.defaultTitle},this.setContentHeight=function(){var submenu=$element.find(".sub-menu-header"),windowHeight=$window.innerHeight,headerHeight=submenu.outerHeight(),height=windowHeight-headerHeight;this.contentPane.css("height",height+"px")},this.incrementZindex=function(){appConfig.zIndex+=1,$element.css("z-index",appConfig.zIndex)},this.initAttributes=function(){this.defaultTitle=this.headerTitle,this.contentPane=$element.find("#viewLayerContent"),angular.isDefined(this.slideInFrom)||(this.slideInFrom="left")},this.show=function(slideFrom,callbackEnd,callbackStart){var animator=this.animatorShow();angular.isDefined(callbackStart)&&callbackStart();var animate=animator.start();angular.isDefined(callbackEnd)&&animate.done(function(){callbackEnd()})},this.hide=function(slideInFrom,callbackEnd,callbackStart){var animator=this.animatorHide(slideInFrom),animate=animator.start();angular.isDefined(callbackEnd)&&animate.done(function(){callbackEnd()}),this.contentPane.html("")},this.animatorHide=function(slideInFrom,params){var keys={},to={},from={};if(angular.isDefined(slideInFrom)&&(this.slideInFrom=slideInFrom),to[this.slideInFrom]="-100%",from[this.slideInFrom]="0px",keys.to=to,keys.from=from,keys.transitionStyle="0.2s ease-out all",angular.isDefined(params))for(var i in params){var param=params[i];keys[i]=param}return $animateCss($element,keys)},this.animatorShow=function(slideFrom){var keys={},to={},from={};return angular.isDefined(slideFrom)&&(this.slideInFrom=slideFrom),to[this.slideInFrom]="0px",from[this.slideInFrom]="-100%",keys.to=to,keys.from=from,keys.transitionStyle="0.2s ease-in all",$animateCss($element,keys)},this.forceHide=function(){$element.css("right","-100%")},this.back=function(){this.onClose()},this.addLoader=function(){this.contentPane.html(""),this.loaderContainer=$("<div></div>").css("height","100%").css("text-align","center"),$("<span></span>").css("display","inline-block").css("vertical-align","middle").css("height","100%").appendTo(this.loaderContainer),$("<img>").css("display","inline-block").css("vertical-align","middle").attr("src",appConfig.staticUrl+"design/pigult_preloader_32x42.gif").appendTo(this.loaderContainer),this.loaderContainer.appendTo(this.contentPane)},this.removeLoader=function(){angular.isDefined(this.loaderContainer)&&null!=this.loaderContainer&&(this.loaderContainer.remove(),this.loaderContainer=null)},this.loadAjaxContent=function(href){this.addLoader(),AjaxFactory.get(href).then(function(content){angular.isDefined(content)&&(_this.removeLoader(),_this.setContent(content))})},this.setContent=function(content){this.contentPane.html(""),$(content).appendTo(this.contentPane)},this.$onInit=function(){this.initAttributes(),this.setStyle(),angular.isDefined(this.autoShow)&&this.autoShow&&this.show(),angular.isDefined(this.href)&&this.loadAjaxContent(this.href),this.delegate[this.id]=this}}}),piguApp.component("menuDropDown",{bindings:{options:"=",onChange:"&",selectedOption:"=?",selectedOptionKey:"=",title:"@"},transclude:!0,template:"<div class='menu-drop-down'><div class='selected-option-container' ng-class='{active: $ctrl.visibility}' ng-click='$ctrl.showHide()'><div class='drop-down-title'>{{$ctrl.title}}</div><div class='drop-down-value'>{{$ctrl.selectedOption}}</div></div><div ng-show='$ctrl.visibility'><div class='drop-down-option' ng-click='$ctrl.setSelected(key);' ng-class='{active: key==$ctrl.selectedOptionKey}' ng-repeat='(key, option) in $ctrl.options'>{{option}}</div></div></div>",controller:function($scope,$element,$attrs,appConfig,$animateCss){this.currentOption={},this.visibility=!1,this.setSelected=function(selected){this.selectedOptionKey!=selected&&(this.selectedOption=this.options[selected],this.selectedOptionKey=selected,this.changed())},this.changed=function(){var _this=this;this.onChange({lang:_this.selectedOptionKey})},this.$onInit=function(){this.selectedOption=this.options[this.selectedOptionKey]},this.showHide=function(){this.visibility=!this.visibility}}}),piguApp.directive("rangeSlider",function(appConfig){return{restrict:"EA",scope:{sliderObject:"=",min:"=",max:"=",from:"=",to:"=",type:"@",prefix:"@",maxPostfix:"@",prettify:"@",grid:"@",gridMargin:"@",postfix:"@",step:"@",hideMinMax:"@",hideFromTo:"@",disable:"@",finishCallback:"&",startCallback:"&",changeCallback:"&",updateCallback:"&",loadCallback:"&"},template:appConfig.templatesUrl+"rangeSlider.html?r="+appConfig.r,link:function(scope,element){function callFinishHandler(resultObject){scope.finishCallback({resultObject:resultObject})}function callStartHandler(resultObject){scope.startCallback({resultObject:resultObject})}function callChangeHandler(resultObject){scope.changeCallback({resultObject:resultObject})}function callUpdateHandler(resultObject){scope.updateCallback({resultObject:resultObject})}!function(){$(element).ionRangeSlider({min:scope.min,max:scope.max,from:scope.from,to:scope.to,type:scope.type,prefix:scope.prefix,max_postfix:scope.maxPostfix,prettify:scope.prettify,grid:scope.grid,grid_margin:scope.gridMargin,postfix:scope.postfix,step:scope.step,hide_min_max:scope.hideMinMax,hide_from_to:scope.hideFromTo,disable:scope.disable,onFinish:callFinishHandler,onStart:callStartHandler,onChange:callChangeHandler,onUpdate:callUpdateHandler}),scope.sliderObject=$(element).data("ionRangeSlider"),scope.$watch("sliderObject",function(object){null!=object&&scope.loadCallback()})}()},controller:function($scope){$scope.min=angular.isUndefined($scope.min)?0:$scope.min,$scope.max=angular.isUndefined($scope.max)?0:$scope.max,$scope.type=angular.isUndefined($scope.type)?"single":$scope.type,$scope.prefix=angular.isUndefined($scope.prefix)?"":$scope.prefix,$scope.maxPostfix=angular.isUndefined($scope.maxPostfix)?"":$scope.maxPostfix,$scope.prettify=angular.isUndefined($scope.prettify)?null:$scope.prettify,$scope.grid=!angular.isUndefined($scope.grid)&&$scope.grid,$scope.gridMargin=!angular.isUndefined($scope.gridMargin)&&$scope.gridMargin,$scope.postfix=angular.isUndefined($scope.postfix)?"":$scope.postfix,$scope.hideMinMax=!angular.isUndefined($scope.hideMinMax)&&$scope.hideMinMax,$scope.hideFromTo=!angular.isUndefined($scope.hideFromTo)&&$scope.hideFromTo,$scope.from=angular.isUndefined($scope.from)?"min":$scope.from,$scope.to=angular.isUndefined($scope.to)?"max":$scope.to,$scope.disable=!angular.isUndefined($scope.disable)&&$scope.disable,$scope.changeCallback=angular.isUndefined($scope.changeCallback)?null:$scope.changeCallback,$scope.finishCallback=angular.isUndefined($scope.finishCallback)?null:$scope.finishCallback,$scope.startCallback=angular.isUndefined($scope.startCallback)?null:$scope.startCallback,$scope.updateCallback=angular.isUndefined($scope.updateCallback)?null:$scope.updateCallback}}}),piguApp.directive("selectOnClick",["$window",function($window){return{restrict:"A",link:function(scope,element,attrs){element.on("click",function(){$window.getSelection().toString()||this.setSelectionRange(0,this.value.length)})}}}]),piguApp.directive("onEnter",function(){return function(scope,element,attrs){element.bind("keydown keypress",function(event){13===event.which&&(scope.$apply(function(){scope.$eval(attrs.onEnter)}),event.preventDefault())})}}),piguApp.directive("oneclick",function(){return function(scope,element,attrs){element.bind("touchstart click",function(event){event.preventDefault(),event.stopPropagation(),scope.$apply(attrs.oneclick)})}}),piguApp.directive("iframeOnload",function(){return{scope:{callBack:"&iframeOnload"},link:function(scope,element,attrs){element.on("load",function(){return scope.callBack()})}}}),piguApp.directive("stickyUp",function(){return{restrict:"A",scope:{scrollContainer:"@"},link:function(scope,element,attrs){var container=$(window),toTopContainer=$("body, html");angular.isDefined(scope.scrollContainer)&&(container=$(scope.scrollContainer),toTopContainer=container),container.scroll(function(event){container.scrollTop()>1e3?element.show():element.hide()}),element.click(function(){toTopContainer.animate({scrollTop:0},"medium")})}}}),piguApp.directive("common",function(appConfig){return{restrict:"E",templateUrl:appConfig.templatesUrl+"common.html?r="+appConfig.r,link:function($scope,element,attr){appConfig.hiddenMenu||($scope.menuBar=!$scope.menuBar,$scope.menuBar?(angular.element(document.querySelector("#menuOverlay")).addClass("active"),angular.element(document.querySelector("app-menu")).addClass("active"),$scope.disableScroll()):(angular.element(document.querySelector("#menuOverlay")).removeClass("active"),angular.element(document.querySelector("app-menu")).removeClass("active"),$scope.subMenuBar=!1,$scope.enableScroll()))}}}),piguApp.directive("searchLayer",function(appConfig){return{restrict:"E",templateUrl:appConfig.templatesUrl+"searchLayer.html?r="+appConfig.r,link:function($scope,element,attr){$scope.showSearchLayer()}}}),piguApp.directive("stickyOrder",function(){return{restrict:"A",scope:{scrollContainer:"@"},link:function(scope,element,attrs){scope.lastScrollTop=0;var container=$(window),toTopContainer=$("body, html");angular.isDefined(scope.scrollContainer)&&(container=$(scope.scrollContainer),toTopContainer=container),scope.showHideOrderButton=function(scrollTop,scrollFromTop){scrollTop>=scrollFromTop?(element.show(),$("#actualProductInfo .row.mform.mbot").css("display","none")):(element.hide(),$("#actualProductInfo .row.mform.mbot").css("display","block"))},$(window).load(function(){var productInfo=$("#actualProductInfo"),offsetTop=productInfo.offset().top,height=productInfo.height(),scrollFromTop=height+offsetTop-$(window).height();scope.showHideOrderButton(container.scrollTop(),scrollFromTop),container.scroll(function(event){scope.showHideOrderButton(container.scrollTop(),scrollFromTop)})}),element.click(function(){toTopContainer.animate({scrollTop:0},"medium")})}}});var piguApp=angular.module("pigu-products",["ngSanitize"]);piguApp.directive("product",function(appConfig){return{restrict:"AE",link:function(scope,element){scope.$last&&void 0!==scope.onLastLoaded&&scope.onLastLoaded(),scope.app_name=appConfig.app_name},templateUrl:appConfig.templatesUrl+"product.html?r="+appConfig.r}}),piguApp.directive("flipClock",function(appConfig){return{restrict:"A",scope:{futureDate:"@",currentDate:"@",clockFace:"@",showSeconds:"="},link:function(scope,element){var futureDate=new Date(scope.futureDate),currentDate=new Date(scope.currentDate),clockFaceVal=void 0!==scope.clockFace?scope.clockFace:"HourlyCounter",showSecondsVal=void 0===scope.showSeconds||scope.showSeconds,diff=futureDate.getTime()/1e3-currentDate.getTime()/1e3;diff>1&&element.FlipClock(diff,{countdown:!0,clockFace:clockFaceVal,showSeconds:showSecondsVal})}}}),piguApp.directive("dropdown",function(appConfig,$rootScope){return{restrict:"E",templateUrl:appConfig.templatesUrl+"dropdown.html?r="+appConfig.r,scope:{list:"=",selected:"=",changecallback:"&",name:"@",label:"@",showFull:"@",secondDrop:"="},link:function(scope){void 0===scope.showFull&&(scope.showFull=!0),scope.secondDropClass=!0===scope.secondDrop?"secondDrop":"",scope.selectedString="",scope.showDropdownList=!1,scope.setSelectedOption=function(selected){scope.selected!=selected&&(scope.changecallback({id:selected}),scope.selected=selected),scope.selectedString=scope.list[selected],scope.showDropdownList=!1},scope.toggleDropdownList=function(){scope.showDropdownList=!scope.showDropdownList},$rootScope.$on("documentClicked",function(inner,target){"undefined"!=typeof jQuery&&!angular.element(target[0]).is("#"+scope.name+"_dropdown .dropdown-toggle.clicked, #"+scope.name+"_dropdown .dropdown-menu, #"+scope.name+"_button.dropdown-toggle")&&!angular.element(target[0]).parents("#"+scope.name+"_dropdown .dropdown-toggle.clicked, #"+scope.name+"_dropdown .dropdown-menu").length>0&&scope.$apply(function(){scope.showDropdownList=!1})}),scope.$watch("selected",function(value){scope.setSelectedOption(scope.selected)}),scope.setSelectedOption(scope.selected)}}}),piguApp.directive("pagination",function(appConfig){return{restrict:"E",templateUrl:appConfig.templatesUrl+"pagination.html?r="+appConfig.r,scope:{currentPage:"@",allPages:"@"},controller:function($location,$scope){$scope.currentPage=parseInt($scope.currentPage),$scope.allPages=parseInt($scope.allPages),$scope.showNext=$scope.currentPage<$scope.allPages,$scope.addParamToUrlString=function(key,value){key=encodeURI(key),value=encodeURI(value);for(var x,kvp=document.location.search.substr(1).split("&"),i=kvp.length;i--;)if(x=kvp[i].split("="),x[0]==key){x[1]=value,kvp[i]=x.join("=");break}return i<0&&(kvp[kvp.length]=[key,value].join("=")),"?"+kvp.join("&")};var protocol=$location.protocol(),host=$location.host(),path=window.location.pathname;if($scope.url=protocol+"://"+host+path,1==$scope.currentPage)var paramsPrev=$scope.addParamToUrlString("page",$scope.currentPage);else var paramsPrev=$scope.addParamToUrlString("page",parseInt($scope.currentPage)-1);if($scope.currentPage==$scope.allPages)var paramsNext=$scope.addParamToUrlString("page",$scope.currentPage);else var paramsNext=$scope.addParamToUrlString("page",parseInt($scope.currentPage)+1);$scope.prevUrl=$scope.url+paramsPrev,$scope.nextUrl=$scope.url+paramsNext}}}),piguApp.directive("pzuWidget",function(appConfig){return{restrict:"E",templateUrl:appConfig.templatesUrl+"pzuWidget.html?r="+appConfig.r,scope:{pzuItems:"=",pzuTexts:"=",changepzucallback:"&",addpzucallback:"&",displayDropDown:"=showDrop",pzuImage:"=",pzuMoreLink:"="},controller:function($scope){$scope.currentActiveModText=$scope.pzuItems[0].month+" "+$scope.pzuItems[0].price,$scope.addPzu=!1},link:function(scope,element,attr){scope.onClick=function(){scope.displayDropDown=!scope.displayDropDown},scope.addSelectedOption=function(addPzu){scope.addpzucallback({addPzu:addPzu})},scope.setSelectedOption=function(selectedId,month,price){scope.currentActiveModText=month+" "+price,scope.changepzucallback({id:selectedId})}}}}),piguApp.directive("autoBundle",function(appConfig){return{restrict:"E",templateUrl:appConfig.templatesUrl+"autoBundle.html?r="+appConfig.r,scope:{products:"=",productId:"=",pushToCart:"&",showProducts:"=",showDeco:"=",showDecoFull:"=",savePrice:"=",sellPrice:"=",showSavePrice:"="},link:function(scope){scope.productsLength=Object.keys(scope.products).length}}}),piguApp.directive("bindHtmlCompiled",function($compile){return{restrict:"A",replace:!0,link:function(scope,element,attrs){scope.$watch(attrs.bindHtmlCompiled,function(html){element[0].innerHTML=html,$compile(element.contents())(scope)})}}}),piguApp.directive("christmasDropdown",function(appConfig,$rootScope){return{restrict:"E",templateUrl:appConfig.templatesUrl+"christmasDropdown.html?r="+appConfig.r,scope:{list:"=",selected:"@",changecallback:"&",name:"@",label:"@",showFull:"@",secondDrop:"="},link:function(scope){void 0===scope.showFull&&(scope.showFull=!0),scope.secondDropClass=!0===scope.secondDrop?"secondDrop":"",scope.selectedString="",scope.showDropdownList=!1,scope.setSelectedOption=function(selected){scope.selected!=selected&&(scope.changecallback({id:selected}),scope.selected=selected),scope.selectedString=scope.list[selected],scope.showDropdownList=!1},scope.toggleDropdownList=function(){scope.showDropdownList=!scope.showDropdownList},$rootScope.$on("documentClicked",function(inner,target){"undefined"!=typeof jQuery&&!angular.element(target[0]).is("#"+scope.name+"_dropdown .dropdown-toggle.clicked, #"+scope.name+"_dropdown .dropdown-menu, #"+scope.name+"_button.dropdown-toggle")&&!angular.element(target[0]).parents("#"+scope.name+"_dropdown .dropdown-toggle.clicked, #"+scope.name+"_dropdown .dropdown-menu").length>0&&scope.$apply(function(){scope.showDropdownList=!1})}),scope.$watch("selected",function(value){scope.setSelectedOption(scope.selected)}),scope.setSelectedOption(scope.selected)}}});